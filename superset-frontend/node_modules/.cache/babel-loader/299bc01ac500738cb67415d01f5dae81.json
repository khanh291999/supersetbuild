{"ast":null,"code":"import _extends from \"@babel/runtime-corejs3/helpers/extends\";function _EMOTION_STRINGIFIED_CSS_ERROR__() {return \"You have tried to stringify object returned from `css` function. It isn't supposed to be used directly (e.g. as value of the `className` prop), but rather handed to emotion so it can handle it (e.g. as value of `css` prop).\";} /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { List } from 'src/common/components';\nimport shortid from 'shortid';\nimport { t, withTheme } from '@superset-ui/core';\nimport {\nSortableContainer,\nSortableHandle,\nSortableElement,\narrayMove } from\n'react-sortable-hoc';\nimport Icons from 'src/components/Icons';\nimport {\nHeaderContainer,\nAddIconButton } from\n'src/explore/components/controls/OptionControls';\nimport { InfoTooltipWithTrigger } from '@superset-ui/chart-controls';\nimport ControlHeader from 'src/explore/components/ControlHeader';\nimport CustomListItem from 'src/explore/components/controls/CustomListItem';\nimport controlMap from '..';import { jsx as ___EmotionJSX } from \"@emotion/react\";\n\nconst propTypes = {\n  name: PropTypes.string.isRequired,\n  label: PropTypes.string,\n  description: PropTypes.string,\n  placeholder: PropTypes.string,\n  addTooltip: PropTypes.string,\n  itemGenerator: PropTypes.func,\n  keyAccessor: PropTypes.func,\n  onChange: PropTypes.func,\n  value: PropTypes.oneOfType([PropTypes.array]),\n  isFloat: PropTypes.bool,\n  isInt: PropTypes.bool,\n  controlName: PropTypes.string.isRequired };\n\n\nconst defaultProps = {\n  label: null,\n  description: null,\n  onChange: () => {},\n  placeholder: t('Empty collection'),\n  itemGenerator: () => ({ key: shortid.generate() }),\n  keyAccessor: (o) => o.key,\n  value: [],\n  addTooltip: t('Add an item') };\n\nconst SortableListItem = SortableElement(CustomListItem);\nconst SortableList = SortableContainer(List);\nconst SortableDragger = SortableHandle(() =>\n___EmotionJSX(\"i\", {\n  role: \"img\",\n  \"aria-label\": \"drag\",\n  className: \"fa fa-bars text-primary\",\n  style: { cursor: 'ns-resize' } }));var _ref = process.env.NODE_ENV === \"production\" ? { name: \"11g6mpt\", styles: \"justify-content:flex-start\" } : { name: \"13cksz1-CollectionControl\", styles: \"justify-content:flex-start;label:CollectionControl;\", map: \"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9zdXBlcnNldC1mcm9udGVuZC9zcmMvZXhwbG9yZS9jb21wb25lbnRzL2NvbnRyb2xzL0NvbGxlY3Rpb25Db250cm9sL2luZGV4LmpzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUF3SGMiLCJmaWxlIjoiL3N1cGVyc2V0LWZyb250ZW5kL3NyYy9leHBsb3JlL2NvbXBvbmVudHMvY29udHJvbHMvQ29sbGVjdGlvbkNvbnRyb2wvaW5kZXguanN4Iiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBMaWNlbnNlZCB0byB0aGUgQXBhY2hlIFNvZnR3YXJlIEZvdW5kYXRpb24gKEFTRikgdW5kZXIgb25lXG4gKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGVcbiAqIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9ybWF0aW9uXG4gKiByZWdhcmRpbmcgY29weXJpZ2h0IG93bmVyc2hpcC4gIFRoZSBBU0YgbGljZW5zZXMgdGhpcyBmaWxlXG4gKiB0byB5b3UgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlXG4gKiBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2VcbiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZyxcbiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuXG4gKiBcIkFTIElTXCIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWVxuICogS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlXG4gKiBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kIGxpbWl0YXRpb25zXG4gKiB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSAncHJvcC10eXBlcyc7XG5pbXBvcnQgeyBMaXN0IH0gZnJvbSAnc3JjL2NvbW1vbi9jb21wb25lbnRzJztcbmltcG9ydCBzaG9ydGlkIGZyb20gJ3Nob3J0aWQnO1xuaW1wb3J0IHsgdCwgd2l0aFRoZW1lIH0gZnJvbSAnQHN1cGVyc2V0LXVpL2NvcmUnO1xuaW1wb3J0IHtcbiAgU29ydGFibGVDb250YWluZXIsXG4gIFNvcnRhYmxlSGFuZGxlLFxuICBTb3J0YWJsZUVsZW1lbnQsXG4gIGFycmF5TW92ZSxcbn0gZnJvbSAncmVhY3Qtc29ydGFibGUtaG9jJztcbmltcG9ydCBJY29ucyBmcm9tICdzcmMvY29tcG9uZW50cy9JY29ucyc7XG5pbXBvcnQge1xuICBIZWFkZXJDb250YWluZXIsXG4gIEFkZEljb25CdXR0b24sXG59IGZyb20gJ3NyYy9leHBsb3JlL2NvbXBvbmVudHMvY29udHJvbHMvT3B0aW9uQ29udHJvbHMnO1xuaW1wb3J0IHsgSW5mb1Rvb2x0aXBXaXRoVHJpZ2dlciB9IGZyb20gJ0BzdXBlcnNldC11aS9jaGFydC1jb250cm9scyc7XG5pbXBvcnQgQ29udHJvbEhlYWRlciBmcm9tICdzcmMvZXhwbG9yZS9jb21wb25lbnRzL0NvbnRyb2xIZWFkZXInO1xuaW1wb3J0IEN1c3RvbUxpc3RJdGVtIGZyb20gJ3NyYy9leHBsb3JlL2NvbXBvbmVudHMvY29udHJvbHMvQ3VzdG9tTGlzdEl0ZW0nO1xuaW1wb3J0IGNvbnRyb2xNYXAgZnJvbSAnLi4nO1xuXG5jb25zdCBwcm9wVHlwZXMgPSB7XG4gIG5hbWU6IFByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCxcbiAgbGFiZWw6IFByb3BUeXBlcy5zdHJpbmcsXG4gIGRlc2NyaXB0aW9uOiBQcm9wVHlwZXMuc3RyaW5nLFxuICBwbGFjZWhvbGRlcjogUHJvcFR5cGVzLnN0cmluZyxcbiAgYWRkVG9vbHRpcDogUHJvcFR5cGVzLnN0cmluZyxcbiAgaXRlbUdlbmVyYXRvcjogUHJvcFR5cGVzLmZ1bmMsXG4gIGtleUFjY2Vzc29yOiBQcm9wVHlwZXMuZnVuYyxcbiAgb25DaGFuZ2U6IFByb3BUeXBlcy5mdW5jLFxuICB2YWx1ZTogUHJvcFR5cGVzLm9uZU9mVHlwZShbUHJvcFR5cGVzLmFycmF5XSksXG4gIGlzRmxvYXQ6IFByb3BUeXBlcy5ib29sLFxuICBpc0ludDogUHJvcFR5cGVzLmJvb2wsXG4gIGNvbnRyb2xOYW1lOiBQcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXG59O1xuXG5jb25zdCBkZWZhdWx0UHJvcHMgPSB7XG4gIGxhYmVsOiBudWxsLFxuICBkZXNjcmlwdGlvbjogbnVsbCxcbiAgb25DaGFuZ2U6ICgpID0+IHt9LFxuICBwbGFjZWhvbGRlcjogdCgnRW1wdHkgY29sbGVjdGlvbicpLFxuICBpdGVtR2VuZXJhdG9yOiAoKSA9PiAoeyBrZXk6IHNob3J0aWQuZ2VuZXJhdGUoKSB9KSxcbiAga2V5QWNjZXNzb3I6IG8gPT4gby5rZXksXG4gIHZhbHVlOiBbXSxcbiAgYWRkVG9vbHRpcDogdCgnQWRkIGFuIGl0ZW0nKSxcbn07XG5jb25zdCBTb3J0YWJsZUxpc3RJdGVtID0gU29ydGFibGVFbGVtZW50KEN1c3RvbUxpc3RJdGVtKTtcbmNvbnN0IFNvcnRhYmxlTGlzdCA9IFNvcnRhYmxlQ29udGFpbmVyKExpc3QpO1xuY29uc3QgU29ydGFibGVEcmFnZ2VyID0gU29ydGFibGVIYW5kbGUoKCkgPT4gKFxuICA8aVxuICAgIHJvbGU9XCJpbWdcIlxuICAgIGFyaWEtbGFiZWw9XCJkcmFnXCJcbiAgICBjbGFzc05hbWU9XCJmYSBmYS1iYXJzIHRleHQtcHJpbWFyeVwiXG4gICAgc3R5bGU9e3sgY3Vyc29yOiAnbnMtcmVzaXplJyB9fVxuICAvPlxuKSk7XG5cbmNsYXNzIENvbGxlY3Rpb25Db250cm9sIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcbiAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gICAgdGhpcy5vbkFkZCA9IHRoaXMub25BZGQuYmluZCh0aGlzKTtcbiAgfVxuXG4gIG9uQ2hhbmdlKGksIHZhbHVlKSB7XG4gICAgY29uc3QgbmV3VmFsdWUgPSBbLi4udGhpcy5wcm9wcy52YWx1ZV07XG4gICAgbmV3VmFsdWVbaV0gPSB7IC4uLnRoaXMucHJvcHMudmFsdWVbaV0sIC4uLnZhbHVlIH07XG4gICAgdGhpcy5wcm9wcy5vbkNoYW5nZShuZXdWYWx1ZSk7XG4gIH1cblxuICBvbkFkZCgpIHtcbiAgICB0aGlzLnByb3BzLm9uQ2hhbmdlKHRoaXMucHJvcHMudmFsdWUuY29uY2F0KFt0aGlzLnByb3BzLml0ZW1HZW5lcmF0b3IoKV0pKTtcbiAgfVxuXG4gIG9uU29ydEVuZCh7IG9sZEluZGV4LCBuZXdJbmRleCB9KSB7XG4gICAgdGhpcy5wcm9wcy5vbkNoYW5nZShhcnJheU1vdmUodGhpcy5wcm9wcy52YWx1ZSwgb2xkSW5kZXgsIG5ld0luZGV4KSk7XG4gIH1cblxuICByZW1vdmVJdGVtKGkpIHtcbiAgICB0aGlzLnByb3BzLm9uQ2hhbmdlKHRoaXMucHJvcHMudmFsdWUuZmlsdGVyKChvLCBpeCkgPT4gaSAhPT0gaXgpKTtcbiAgfVxuXG4gIHJlbmRlckxpc3QoKSB7XG4gICAgaWYgKHRoaXMucHJvcHMudmFsdWUubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gPGRpdiBjbGFzc05hbWU9XCJ0ZXh0LW11dGVkXCI+e3RoaXMucHJvcHMucGxhY2Vob2xkZXJ9PC9kaXY+O1xuICAgIH1cbiAgICBjb25zdCBDb250cm9sID0gY29udHJvbE1hcFt0aGlzLnByb3BzLmNvbnRyb2xOYW1lXTtcbiAgICByZXR1cm4gKFxuICAgICAgPFNvcnRhYmxlTGlzdFxuICAgICAgICB1c2VEcmFnSGFuZGxlXG4gICAgICAgIGxvY2tBeGlzPVwieVwiXG4gICAgICAgIG9uU29ydEVuZD17dGhpcy5vblNvcnRFbmQuYmluZCh0aGlzKX1cbiAgICAgICAgYm9yZGVyZWRcbiAgICAgICAgY3NzPXt0aGVtZSA9PiAoe1xuICAgICAgICAgIGJvcmRlclJhZGl1czogdGhlbWUuZ3JpZFVuaXQsXG4gICAgICAgIH0pfVxuICAgICAgPlxuICAgICAgICB7dGhpcy5wcm9wcy52YWx1ZS5tYXAoKG8sIGkpID0+IHtcbiAgICAgICAgICAvLyBsYWJlbCByZWxldmFudCBvbmx5IGZvciBoZWFkZXIsIG5vdCBoZXJlXG4gICAgICAgICAgY29uc3QgeyBsYWJlbCwgLi4uY29tbW9uUHJvcHMgfSA9IHRoaXMucHJvcHM7XG4gICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxTb3J0YWJsZUxpc3RJdGVtXG4gICAgICAgICAgICAgIGNsYXNzTmFtZT1cImNsZWFyZml4XCJcbiAgICAgICAgICAgICAgY3NzPXt7IGp1c3RpZnlDb250ZW50OiAnZmxleC1zdGFydCcgfX1cbiAgICAgICAgICAgICAga2V5PXt0aGlzLnByb3BzLmtleUFjY2Vzc29yKG8pfVxuICAgICAgICAgICAgICBpbmRleD17aX1cbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgPFNvcnRhYmxlRHJhZ2dlciAvPlxuICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgY3NzPXt0aGVtZSA9PiAoe1xuICAgICAgICAgICAgICAgICAgZmxleDogMSxcbiAgICAgICAgICAgICAgICAgIG1hcmdpbkxlZnQ6IHRoZW1lLmdyaWRVbml0ICogMixcbiAgICAgICAgICAgICAgICAgIG1hcmdpblJpZ2h0OiB0aGVtZS5ncmlkVW5pdCAqIDIsXG4gICAgICAgICAgICAgICAgfSl9XG4gICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICA8Q29udHJvbFxuICAgICAgICAgICAgICAgICAgey4uLmNvbW1vblByb3BzfVxuICAgICAgICAgICAgICAgICAgey4uLm99XG4gICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5vbkNoYW5nZS5iaW5kKHRoaXMsIGkpfVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8SW5mb1Rvb2x0aXBXaXRoVHJpZ2dlclxuICAgICAgICAgICAgICAgIGljb249XCJ0aW1lc1wiXG4gICAgICAgICAgICAgICAgbGFiZWw9XCJyZW1vdmUtaXRlbVwiXG4gICAgICAgICAgICAgICAgdG9vbHRpcD17dCgnUmVtb3ZlIGl0ZW0nKX1cbiAgICAgICAgICAgICAgICBic1N0eWxlPVwicHJpbWFyeVwiXG4gICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5yZW1vdmVJdGVtLmJpbmQodGhpcywgaSl9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICA8L1NvcnRhYmxlTGlzdEl0ZW0+XG4gICAgICAgICAgKTtcbiAgICAgICAgfSl9XG4gICAgICA8L1NvcnRhYmxlTGlzdD5cbiAgICApO1xuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHsgdGhlbWUgfSA9IHRoaXMucHJvcHM7XG4gICAgcmV0dXJuIChcbiAgICAgIDxkaXYgZGF0YS10ZXN0PVwiQ29sbGVjdGlvbkNvbnRyb2xcIiBjbGFzc05hbWU9XCJDb2xsZWN0aW9uQ29udHJvbFwiPlxuICAgICAgICA8SGVhZGVyQ29udGFpbmVyPlxuICAgICAgICAgIDxDb250cm9sSGVhZGVyIHsuLi50aGlzLnByb3BzfSAvPlxuICAgICAgICAgIDxBZGRJY29uQnV0dG9uIG9uQ2xpY2s9e3RoaXMub25BZGR9PlxuICAgICAgICAgICAgPEljb25zLlBsdXNMYXJnZVxuICAgICAgICAgICAgICBpY29uU2l6ZT1cInNcIlxuICAgICAgICAgICAgICBpY29uQ29sb3I9e3RoZW1lLmNvbG9ycy5ncmF5c2NhbGUubGlnaHQ1fVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICA8L0FkZEljb25CdXR0b24+XG4gICAgICAgIDwvSGVhZGVyQ29udGFpbmVyPlxuICAgICAgICB7dGhpcy5yZW5kZXJMaXN0KCl9XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9XG59XG5cbkNvbGxlY3Rpb25Db250cm9sLnByb3BUeXBlcyA9IHByb3BUeXBlcztcbkNvbGxlY3Rpb25Db250cm9sLmRlZmF1bHRQcm9wcyA9IGRlZmF1bHRQcm9wcztcblxuZXhwb3J0IGRlZmF1bHQgd2l0aFRoZW1lKENvbGxlY3Rpb25Db250cm9sKTtcbiJdfQ== */\", toString: _EMOTION_STRINGIFIED_CSS_ERROR__ };\n\n\n\nclass CollectionControl extends React.Component {\n  constructor(props) {\n    super(props);\n    this.onAdd = this.onAdd.bind(this);\n  }\n\n  onChange(i, value) {\n    const newValue = [...this.props.value];\n    newValue[i] = { ...this.props.value[i], ...value };\n    this.props.onChange(newValue);\n  }\n\n  onAdd() {\n    this.props.onChange(this.props.value.concat([this.props.itemGenerator()]));\n  }\n\n  onSortEnd({ oldIndex, newIndex }) {\n    this.props.onChange(arrayMove(this.props.value, oldIndex, newIndex));\n  }\n\n  removeItem(i) {\n    this.props.onChange(this.props.value.filter((o, ix) => i !== ix));\n  }\n\n  renderList() {\n    if (this.props.value.length === 0) {\n      return ___EmotionJSX(\"div\", { className: \"text-muted\" }, this.props.placeholder);\n    }\n    const Control = controlMap[this.props.controlName];\n    return (\n      ___EmotionJSX(SortableList, {\n        useDragHandle: true,\n        lockAxis: \"y\",\n        onSortEnd: this.onSortEnd.bind(this),\n        bordered: true,\n        css: (theme) => ({\n          borderRadius: theme.gridUnit }) },\n\n\n      this.props.value.map((o, i) => {\n        // label relevant only for header, not here\n        const { label, ...commonProps } = this.props;\n        return (\n          ___EmotionJSX(SortableListItem, {\n            className: \"clearfix\",\n            css: _ref,\n            key: this.props.keyAccessor(o),\n            index: i },\n\n          ___EmotionJSX(SortableDragger, null),\n          ___EmotionJSX(\"div\", {\n            css: (theme) => ({\n              flex: 1,\n              marginLeft: theme.gridUnit * 2,\n              marginRight: theme.gridUnit * 2 }) },\n\n\n          ___EmotionJSX(Control, _extends({},\n          commonProps,\n          o, {\n            onChange: this.onChange.bind(this, i) }))),\n\n\n          ___EmotionJSX(InfoTooltipWithTrigger, {\n            icon: \"times\",\n            label: \"remove-item\",\n            tooltip: t('Remove item'),\n            bsStyle: \"primary\",\n            onClick: this.removeItem.bind(this, i) })));\n\n\n\n      })));\n\n\n  }\n\n  render() {\n    const { theme } = this.props;\n    return (\n      ___EmotionJSX(\"div\", { className: \"CollectionControl\" },\n      ___EmotionJSX(HeaderContainer, null,\n      ___EmotionJSX(ControlHeader, this.props),\n      ___EmotionJSX(AddIconButton, { onClick: this.onAdd },\n      ___EmotionJSX(Icons.PlusLarge, {\n        iconSize: \"s\",\n        iconColor: theme.colors.grayscale.light5 }))),\n\n\n\n      this.renderList()));\n\n\n  }}\n\n\nCollectionControl.propTypes = propTypes;\nCollectionControl.defaultProps = defaultProps;\n\nexport default withTheme(CollectionControl);","map":null,"metadata":{},"sourceType":"module"}