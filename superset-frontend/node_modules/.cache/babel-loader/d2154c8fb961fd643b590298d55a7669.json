{"ast":null,"code":"/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { styled, t } from '@superset-ui/core';\nimport moment from 'moment';\nimport React, { useEffect, useMemo } from 'react';\nimport { Link, useParams } from 'react-router-dom';\nimport ListView from 'src/components/ListView';\nimport SubMenu from 'src/components/Menu/SubMenu';\nimport withToasts from 'src/components/MessageToasts/withToasts';\nimport { fDuration } from 'src/modules/dates';\nimport AlertStatusIcon from 'src/views/CRUD/alert/components/AlertStatusIcon';\nimport { useListViewResource, useSingleViewResource } from 'src/views/CRUD/hooks';import { jsx as ___EmotionJSX } from \"@emotion/react\";\nconst PAGE_SIZE = 25;\nconst StyledHeader = styled.div`\n  display: flex;\n  flex-direction: row;\n\n  a,\n  Link {\n    margin-left: 16px;\n    font-size: 12px;\n    font-weight: normal;\n    text-decoration: underline;\n  }\n`;\nfunction ExecutionLog({ addDangerToast, isReportEnabled }) {\n  const { alertId } = useParams();\n  const { state: { loading, resourceCount: logCount, resourceCollection: logs }, fetchData } = useListViewResource(`report/${alertId}/log`, t('log'), addDangerToast, false);\n  const { state: { loading: alertLoading, resource: alertResource }, fetchResource } = useSingleViewResource('report', t('reports'), addDangerToast);\n  useEffect(() => {\n    if (alertId !== null && !alertLoading) {\n      fetchResource(alertId);\n    }\n  }, [alertId]);\n  const initialSort = [{ id: 'start_dttm', desc: true }];\n  const columns = useMemo(() => [\n  {\n    Cell: ({ row: { original: { state } } }) => ___EmotionJSX(AlertStatusIcon, { state: state, isReportEnabled: isReportEnabled }),\n    accessor: 'state',\n    Header: t('State'),\n    size: 'xs',\n    disableSortBy: true },\n\n  {\n    Cell: ({ row: { original: { uuid: executionId } } }) => executionId ? executionId.slice(0, 6) : 'none',\n    accessor: 'uuid',\n    Header: t('Execution ID'),\n    size: 'xs',\n    disableSortBy: true },\n\n  {\n    Cell: ({ row: { original: { scheduled_dttm: scheduledDttm } } }) => moment(new Date(scheduledDttm)).format('YYYY-MM-DD hh:mm:ss a'),\n    accessor: 'scheduled_dttm',\n    Header: t('Scheduled at (UTC)') },\n\n  {\n    Cell: ({ row: { original: { start_dttm: startDttm } } }) => moment(new Date(startDttm)).format('YYYY-MM-DD hh:mm:ss a'),\n    Header: t('Start at (UTC)'),\n    accessor: 'start_dttm' },\n\n  {\n    Cell: ({ row: { original: { start_dttm: startDttm, end_dttm: endDttm } } }) => fDuration(new Date(startDttm).getTime(), new Date(endDttm).getTime()),\n    Header: t('Duration'),\n    disableSortBy: true },\n\n  {\n    accessor: 'value',\n    Header: t('Value') },\n\n  {\n    accessor: 'error_message',\n    Header: t('Error message') }],\n\n  [isReportEnabled]);\n  const path = `/${isReportEnabled ? 'report' : 'alert'}/list/`;\n  return ___EmotionJSX(React.Fragment, null,\n  ___EmotionJSX(SubMenu, { name: ___EmotionJSX(StyledHeader, null,\n    ___EmotionJSX(\"span\", null,\n    t(`${alertResource == null ? void 0 : alertResource.type}`), \" \", alertResource == null ? void 0 : alertResource.name),\n\n    ___EmotionJSX(\"span\", null,\n    ___EmotionJSX(Link, { to: path }, \"Back to all\"))) }),\n\n\n  ___EmotionJSX(ListView, { className: \"execution-log-list-view\", columns: columns, count: logCount, data: logs, fetchData: fetchData, initialSort: initialSort, loading: loading, pageSize: PAGE_SIZE }));\n\n}\nexport default withToasts(ExecutionLog);","map":null,"metadata":{},"sourceType":"module"}