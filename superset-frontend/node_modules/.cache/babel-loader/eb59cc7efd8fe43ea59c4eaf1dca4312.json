{"ast":null,"code":"import { css as _css } from \"@emotion/react\"; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useState, useEffect, useMemo, useCallback } from 'react';\nimport { styled, t, SupersetClient, css } from '@superset-ui/core';\nimport rison from 'rison';\nimport { useSingleViewResource } from 'src/views/CRUD/hooks';\nimport Icons from 'src/components/Icons';\nimport { Switch } from 'src/components/Switch';\nimport Modal from 'src/components/Modal';\nimport TimezoneSelector from 'src/components/TimezoneSelector';\nimport { Radio } from 'src/components/Radio';\nimport { Select } from 'src/components';\nimport { FeatureFlag, isFeatureEnabled } from 'src/featureFlags';\nimport withToasts from 'src/components/MessageToasts/withToasts';\nimport TextAreaControl from 'src/explore/components/controls/TextAreaControl';\nimport { useCommonConf } from 'src/views/CRUD/data/database/state';\nimport { AlertReportCronScheduler } from './components/AlertReportCronScheduler';\nimport { NotificationMethod } from './components/NotificationMethod';import { jsx as ___EmotionJSX } from \"@emotion/react\";\nconst TIMEOUT_MIN = 1;\nconst TEXT_BASED_VISUALIZATION_TYPES = [\n'pivot_table',\n'pivot_table_v2',\n'table',\n'paired_ttest'];\n\nconst DEFAULT_NOTIFICATION_METHODS = ['Email'];\nconst DEFAULT_NOTIFICATION_FORMAT = 'PNG';\nconst CONDITIONS = [\n{\n  label: t('< (Smaller than)'),\n  value: '<' },\n\n{\n  label: t('> (Larger than)'),\n  value: '>' },\n\n{\n  label: t('<= (Smaller or equal)'),\n  value: '<=' },\n\n{\n  label: t('>= (Larger or equal)'),\n  value: '>=' },\n\n{\n  label: t('== (Is equal)'),\n  value: '==' },\n\n{\n  label: t('!= (Is not equal)'),\n  value: '!=' },\n\n{\n  label: t('Not null'),\n  value: 'not null' }];\n\n\nconst RETENTION_OPTIONS = [\n{\n  label: t('None'),\n  value: 0 },\n\n{\n  label: t('30 days'),\n  value: 30 },\n\n{\n  label: t('60 days'),\n  value: 60 },\n\n{\n  label: t('90 days'),\n  value: 90 }];\n\n\nconst DEFAULT_RETENTION = 90;\nconst DEFAULT_WORKING_TIMEOUT = 3600;\nconst DEFAULT_CRON_VALUE = '0 * * * *'; // every hour\nconst DEFAULT_ALERT = {\n  active: true,\n  creation_method: 'alerts_reports',\n  crontab: DEFAULT_CRON_VALUE,\n  log_retention: DEFAULT_RETENTION,\n  working_timeout: DEFAULT_WORKING_TIMEOUT,\n  name: '',\n  owners: [],\n  recipients: [],\n  sql: '',\n  validator_config_json: {},\n  validator_type: '',\n  grace_period: undefined };\n\nconst StyledModal = styled(Modal)`\n  .ant-modal-body {\n    overflow: initial;\n  }\n`;\nconst StyledIcon = (theme) => css`\n  margin: auto ${theme.gridUnit * 2}px auto 0;\n  color: ${theme.colors.grayscale.base};\n`;\nconst StyledSectionContainer = styled.div`\n  display: flex;\n  min-width: 1000px;\n  flex-direction: column;\n\n  .header-section {\n    display: flex;\n    flex: 0 0 auto;\n    align-items: center;\n    width: 100%;\n    padding: ${({ theme }) => theme.gridUnit * 4}px;\n    border-bottom: 1px solid ${({ theme }) => theme.colors.grayscale.light2};\n  }\n\n  .column-section {\n    display: flex;\n    flex: 1 1 auto;\n\n    .column {\n      flex: 1 1 auto;\n      min-width: calc(33.33% - ${({ theme }) => theme.gridUnit * 8}px);\n      padding: ${({ theme }) => theme.gridUnit * 4}px;\n\n      .async-select {\n        margin: 10px 0 20px;\n      }\n\n      &.condition {\n        border-right: 1px solid ${({ theme }) => theme.colors.grayscale.light2};\n      }\n\n      &.message {\n        border-left: 1px solid ${({ theme }) => theme.colors.grayscale.light2};\n      }\n    }\n  }\n\n  .inline-container {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    &.wrap {\n      flex-wrap: wrap;\n    }\n\n    > div {\n      flex: 1 1 auto;\n    }\n\n    &.add-margin {\n      margin-bottom: 5px;\n    }\n\n    .styled-input {\n      margin: 0 0 0 10px;\n\n      input {\n        flex: 0 0 auto;\n      }\n    }\n  }\n`;\nconst StyledSectionTitle = styled.div`\n  display: flex;\n  align-items: center;\n  margin: ${({ theme }) => theme.gridUnit * 2}px auto\n    ${({ theme }) => theme.gridUnit * 4}px auto;\n\n  h4 {\n    margin: 0;\n  }\n\n  .required {\n    margin-left: ${({ theme }) => theme.gridUnit}px;\n    color: ${({ theme }) => theme.colors.error.base};\n  }\n`;\nconst StyledSwitchContainer = styled.div`\n  display: flex;\n  align-items: center;\n  margin-top: 10px;\n\n  .switch-label {\n    margin-left: 10px;\n  }\n`;\nexport const StyledInputContainer = styled.div`\n  flex: 1;\n  margin: ${({ theme }) => theme.gridUnit * 2}px;\n  margin-top: 0;\n\n  .helper {\n    display: block;\n    color: ${({ theme }) => theme.colors.grayscale.base};\n    font-size: ${({ theme }) => theme.typography.sizes.s - 1}px;\n    padding: ${({ theme }) => theme.gridUnit}px 0;\n    text-align: left;\n  }\n\n  .required {\n    margin-left: ${({ theme }) => theme.gridUnit / 2}px;\n    color: ${({ theme }) => theme.colors.error.base};\n  }\n\n  .input-container {\n    display: flex;\n    align-items: center;\n\n    > div {\n      width: 100%;\n    }\n\n    label {\n      display: flex;\n      margin-right: ${({ theme }) => theme.gridUnit * 2}px;\n    }\n\n    i {\n      margin: 0 ${({ theme }) => theme.gridUnit}px;\n    }\n  }\n\n  input,\n  textarea {\n    flex: 1 1 auto;\n  }\n\n  input[disabled] {\n    color: ${({ theme }) => theme.colors.grayscale.base};\n  }\n\n  textarea {\n    height: 300px;\n    resize: none;\n  }\n\n  input::placeholder,\n  textarea::placeholder {\n    color: ${({ theme }) => theme.colors.grayscale.light1};\n  }\n\n  textarea,\n  input[type='text'],\n  input[type='number'] {\n    padding: ${({ theme }) => theme.gridUnit}px\n      ${({ theme }) => theme.gridUnit * 2}px;\n    border-style: none;\n    border: 1px solid ${({ theme }) => theme.colors.grayscale.light2};\n    border-radius: ${({ theme }) => theme.gridUnit}px;\n\n    &[name='description'] {\n      flex: 1 1 auto;\n    }\n  }\n\n  .input-label {\n    margin-left: 10px;\n  }\n`;\nconst StyledRadio = styled(Radio)`\n  display: block;\n  line-height: ${({ theme }) => theme.gridUnit * 7}px;\n`;\nconst StyledRadioGroup = styled(Radio.Group)`\n  margin-left: ${({ theme }) => theme.gridUnit * 5.5}px;\n`;\n// Notification Method components\nconst StyledNotificationAddButton = styled.div`\n  color: ${({ theme }) => theme.colors.primary.dark1};\n  cursor: pointer;\n\n  i {\n    margin-right: ${({ theme }) => theme.gridUnit * 2}px;\n  }\n\n  &.disabled {\n    color: ${({ theme }) => theme.colors.grayscale.light1};\n    cursor: default;\n  }\n`;\nconst timezoneHeaderStyle = (theme) => css`\n  margin: ${theme.gridUnit * 3}px 0;\n`;\nconst NotificationMethodAdd = ({ status = 'active', onClick }) => {\n  if (status === 'hidden') {\n    return null;\n  }\n  const checkStatus = () => {\n    if (status !== 'disabled') {\n      onClick();\n    }\n  };\n  return ___EmotionJSX(StyledNotificationAddButton, { className: status, onClick: checkStatus },\n  ___EmotionJSX(\"i\", { className: \"fa fa-plus\" }), ' ',\n  status === 'active' ?\n  t('Add notification method') :\n  t('Add delivery method'));\n\n};\nconst AlertReportModal = ({ addDangerToast, onAdd, onHide, show, alert = null, isReport = false }) => {var _currentAlert$databas2, _currentAlert$databas3, _currentAlert$validat5, _currentAlert$chart2, _currentAlert$chart3, _currentAlert$dashboa2, _currentAlert$dashboa3;\n  const conf = useCommonConf();\n  const allowedNotificationMethods = (conf == null ? void 0 : conf.ALERT_REPORTS_NOTIFICATION_METHODS) || DEFAULT_NOTIFICATION_METHODS;\n  const [disableSave, setDisableSave] = useState(true);\n  const [currentAlert, setCurrentAlert] = useState();\n  const [isHidden, setIsHidden] = useState(true);\n  const [contentType, setContentType] = useState('dashboard');\n  const [reportFormat, setReportFormat] = useState(DEFAULT_NOTIFICATION_FORMAT);\n  // Dropdown options\n  const [conditionNotNull, setConditionNotNull] = useState(false);\n  const [sourceOptions, setSourceOptions] = useState([]);\n  const [dashboardOptions, setDashboardOptions] = useState([]);\n  const [chartOptions, setChartOptions] = useState([]);\n  // Chart metadata\n  const [chartVizType, setChartVizType] = useState('');\n  const isEditMode = alert !== null;\n  const formatOptionEnabled = contentType === 'chart' && (\n  isFeatureEnabled(FeatureFlag.ALERTS_ATTACH_REPORTS) || isReport);\n  const [notificationAddState, setNotificationAddState] = useState('active');\n  const [notificationSettings, setNotificationSettings] = useState([]);\n  const onNotificationAdd = () => {\n    const settings = notificationSettings.slice();\n    settings.push({\n      recipients: '',\n      options: allowedNotificationMethods });\n\n    setNotificationSettings(settings);\n    setNotificationAddState(settings.length === allowedNotificationMethods.length ?\n    'hidden' :\n    'disabled');\n  };\n  const updateNotificationSetting = (index, setting) => {\n    const settings = notificationSettings.slice();\n    settings[index] = setting;\n    setNotificationSettings(settings);\n    if (setting.method !== undefined && notificationAddState !== 'hidden') {\n      setNotificationAddState('active');\n    }\n  };\n  const removeNotificationSetting = (index) => {\n    const settings = notificationSettings.slice();\n    settings.splice(index, 1);\n    setNotificationSettings(settings);\n    setNotificationAddState('active');\n  };\n  // Alert fetch logic\n  const { state: { loading, resource, error: fetchError }, fetchResource, createResource, updateResource, clearError } = useSingleViewResource('report', t('report'), addDangerToast);\n  // Functions\n  const hide = () => {\n    clearError();\n    setIsHidden(true);\n    onHide();\n    setNotificationSettings([]);\n    setCurrentAlert({ ...DEFAULT_ALERT });\n    setNotificationAddState('active');\n  };\n  const onSave = () => {var _currentAlert$chart, _currentAlert$dashboa, _currentAlert$databas;\n    // Notification Settings\n    const recipients = [];\n    notificationSettings.forEach((setting) => {\n      if (setting.method && setting.recipients.length) {\n        recipients.push({\n          recipient_config_json: {\n            target: setting.recipients },\n\n          type: setting.method });\n\n      }\n    });\n    const data = {\n      ...currentAlert,\n      type: isReport ? 'Report' : 'Alert',\n      validator_type: conditionNotNull ? 'not null' : 'operator',\n      validator_config_json: conditionNotNull ?\n      {} :\n      currentAlert == null ? void 0 : currentAlert.validator_config_json,\n      chart: contentType === 'chart' ? currentAlert == null ? void 0 : (_currentAlert$chart = currentAlert.chart) == null ? void 0 : _currentAlert$chart.value : null,\n      dashboard: contentType === 'dashboard' ? currentAlert == null ? void 0 : (_currentAlert$dashboa = currentAlert.dashboard) == null ? void 0 : _currentAlert$dashboa.value : null,\n      database: currentAlert == null ? void 0 : (_currentAlert$databas = currentAlert.database) == null ? void 0 : _currentAlert$databas.value,\n      owners: ((currentAlert == null ? void 0 : currentAlert.owners) || []).map((owner) => owner.value),\n      recipients,\n      report_format: contentType === 'dashboard' ?\n      DEFAULT_NOTIFICATION_FORMAT :\n      reportFormat || DEFAULT_NOTIFICATION_FORMAT };\n\n    if (data.recipients && !data.recipients.length) {\n      delete data.recipients;\n    }\n    data.context_markdown = 'string';\n    if (isEditMode) {\n      // Edit\n      if (currentAlert && currentAlert.id) {\n        const update_id = currentAlert.id;\n        delete data.id;\n        delete data.created_by;\n        delete data.last_eval_dttm;\n        delete data.last_state;\n        delete data.last_value;\n        delete data.last_value_row_json;\n        updateResource(update_id, data).then((response) => {\n          if (!response) {\n            return;\n          }\n          if (onAdd) {\n            onAdd();\n          }\n          hide();\n        });\n      }\n    } else\n    if (currentAlert) {\n      // Create\n      createResource(data).then((response) => {\n        if (!response) {\n          return;\n        }\n        if (onAdd) {\n          onAdd(response);\n        }\n        hide();\n      });\n    }\n  };\n  // Fetch data to populate form dropdowns\n  const loadOwnerOptions = useMemo(() => (input = '', page, pageSize) => {\n    const query = rison.encode({ filter: input, page, page_size: pageSize });\n    return SupersetClient.get({\n      endpoint: `/api/v1/report/related/owners?q=${query}` }).\n    then((response) => ({\n      data: response.json.result.map((item) => ({\n        value: item.value,\n        label: item.text })),\n\n      totalCount: response.json.count }));\n\n  }, []);\n  const getSourceData = useCallback((db) => {\n    const database = db || (currentAlert == null ? void 0 : currentAlert.database);\n    if (!database || database.label) {\n      return null;\n    }\n    let result;\n    // Cycle through source options to find the selected option\n    sourceOptions.forEach((source) => {\n      if (source.value === database.value || source.value === database.id) {\n        result = source;\n      }\n    });\n    return result;\n  }, [currentAlert == null ? void 0 : currentAlert.database, sourceOptions]);\n  // Updating alert/report state\n  const updateAlertState = (name, value) => {\n    setCurrentAlert((currentAlertData) => ({\n      ...currentAlertData,\n      [name]: value }));\n\n  };\n  const loadSourceOptions = useMemo(() => (input = '', page, pageSize) => {\n    const query = rison.encode({ filter: input, page, page_size: pageSize });\n    return SupersetClient.get({\n      endpoint: `/api/v1/report/related/database?q=${query}` }).\n    then((response) => {\n      const list = response.json.result.map((item) => ({\n        value: item.value,\n        label: item.text }));\n\n      setSourceOptions(list);\n      return { data: list, totalCount: response.json.count };\n    });\n  }, []);\n  const databaseLabel = currentAlert && currentAlert.database && !currentAlert.database.label;\n  useEffect(() => {\n    // Find source if current alert has one set\n    if (databaseLabel) {\n      updateAlertState('database', getSourceData());\n    }\n  }, [databaseLabel, getSourceData]);\n  const loadDashboardOptions = useMemo(() => (input = '', page, pageSize) => {\n    const query = rison.encode({ filter: input, page, page_size: pageSize });\n    return SupersetClient.get({\n      endpoint: `/api/v1/report/related/dashboard?q=${query}` }).\n    then((response) => {\n      const list = response.json.result.map((item) => ({\n        value: item.value,\n        label: item.text }));\n\n      setDashboardOptions(list);\n      return { data: list, totalCount: response.json.count };\n    });\n  }, []);\n  const getDashboardData = (db) => {\n    const dashboard = db || (currentAlert == null ? void 0 : currentAlert.dashboard);\n    if (!dashboard || dashboard.label) {\n      return null;\n    }\n    let result;\n    // Cycle through dashboard options to find the selected option\n    dashboardOptions.forEach((dash) => {\n      if (dash.value === dashboard.value || dash.value === dashboard.id) {\n        result = dash;\n      }\n    });\n    return result;\n  };\n  const getChartData = useCallback((chartData) => {\n    const chart = chartData || (currentAlert == null ? void 0 : currentAlert.chart);\n    if (!chart || chart.label) {\n      return null;\n    }\n    let result;\n    // Cycle through chart options to find the selected option\n    chartOptions.forEach((slice) => {\n      if (slice.value === chart.value || slice.value === chart.id) {\n        result = slice;\n      }\n    });\n    return result;\n  }, [chartOptions, currentAlert == null ? void 0 : currentAlert.chart]);\n  const noChartLabel = currentAlert && currentAlert.chart && !currentAlert.chart.label;\n  useEffect(() => {\n    // Find source if current alert has one set\n    if (noChartLabel) {\n      updateAlertState('chart', getChartData());\n    }\n  }, [getChartData, noChartLabel]);\n  const loadChartOptions = useMemo(() => (input = '', page, pageSize) => {\n    const query = rison.encode({ filter: input, page, page_size: pageSize });\n    return SupersetClient.get({\n      endpoint: `/api/v1/report/related/chart?q=${query}` }).\n    then((response) => {\n      const list = response.json.result.map((item) => ({\n        value: item.value,\n        label: item.text }));\n\n      setChartOptions(list);\n      return { data: list, totalCount: response.json.count };\n    });\n  }, []);\n  const getChartVisualizationType = (chart) => SupersetClient.get({\n    endpoint: `/api/v1/chart/${chart.value}` }).\n  then((response) => setChartVizType(response.json.result.viz_type));\n  // Handle input/textarea updates\n  const onTextChange = (event) => {\n    const { target } = event;\n    updateAlertState(target.name, target.value);\n  };\n  const onTimeoutVerifyChange = (event) => {\n    const { target } = event;\n    const value = +target.value;\n    // Need to make sure grace period is not lower than TIMEOUT_MIN\n    if (value === 0) {\n      updateAlertState(target.name, null);\n    } else\n    {\n      updateAlertState(target.name, value ? Math.max(value, TIMEOUT_MIN) : value);\n    }\n  };\n  const onSQLChange = (value) => {\n    updateAlertState('sql', value || '');\n  };\n  const onOwnersChange = (value) => {\n    updateAlertState('owners', value || []);\n  };\n  const onSourceChange = (value) => {\n    updateAlertState('database', value || []);\n  };\n  const onDashboardChange = (dashboard) => {\n    updateAlertState('dashboard', dashboard || undefined);\n    updateAlertState('chart', null);\n  };\n  const onChartChange = (chart) => {\n    getChartVisualizationType(chart);\n    updateAlertState('chart', chart || undefined);\n    updateAlertState('dashboard', null);\n  };\n  const onActiveSwitch = (checked) => {\n    updateAlertState('active', checked);\n  };\n  const onConditionChange = (op) => {var _currentAlert$validat;\n    setConditionNotNull(op === 'not null');\n    const config = {\n      op,\n      threshold: currentAlert ? (_currentAlert$validat =\n      currentAlert.validator_config_json) == null ? void 0 : _currentAlert$validat.threshold :\n      undefined };\n\n    updateAlertState('validator_config_json', config);\n  };\n  const onThresholdChange = (event) => {var _currentAlert$validat2;\n    const { target } = event;\n    const config = {\n      op: currentAlert ? (_currentAlert$validat2 = currentAlert.validator_config_json) == null ? void 0 : _currentAlert$validat2.op : undefined,\n      threshold: target.value };\n\n    updateAlertState('validator_config_json', config);\n  };\n  const onLogRetentionChange = (retention) => {\n    updateAlertState('log_retention', retention);\n  };\n  const onTimezoneChange = (timezone) => {\n    updateAlertState('timezone', timezone);\n  };\n  const onContentTypeChange = (event) => {\n    const { target } = event;\n    // Gives time to close the select before changing the type\n    setTimeout(() => setContentType(target.value), 200);\n  };\n  const onFormatChange = (event) => {\n    const { target } = event;\n    setReportFormat(target.value);\n  };\n  // Make sure notification settings has the required info\n  const checkNotificationSettings = () => {\n    if (!notificationSettings.length) {\n      return false;\n    }\n    let hasInfo = false;\n    notificationSettings.forEach((setting) => {var _setting$recipients;\n      if (!!setting.method && (_setting$recipients = setting.recipients) != null && _setting$recipients.length) {\n        hasInfo = true;\n      }\n    });\n    return hasInfo;\n  };\n  const validate = () => {var _currentAlert$name, _currentAlert$owners, _currentAlert$crontab;\n    if (currentAlert && (_currentAlert$name =\n    currentAlert.name) != null && _currentAlert$name.length && (_currentAlert$owners =\n    currentAlert.owners) != null && _currentAlert$owners.length && (_currentAlert$crontab =\n    currentAlert.crontab) != null && _currentAlert$crontab.length &&\n    currentAlert.working_timeout !== undefined && (\n    contentType === 'dashboard' && !!currentAlert.dashboard ||\n    contentType === 'chart' && !!currentAlert.chart) &&\n    checkNotificationSettings()) {var _currentAlert$sql, _currentAlert$validat3, _currentAlert$validat4;\n      if (isReport) {\n        setDisableSave(false);\n      } else\n      if (!!currentAlert.database && (_currentAlert$sql =\n      currentAlert.sql) != null && _currentAlert$sql.length && (\n      conditionNotNull || !!((_currentAlert$validat3 = currentAlert.validator_config_json) != null && _currentAlert$validat3.op)) && (\n      conditionNotNull ||\n      ((_currentAlert$validat4 = currentAlert.validator_config_json) == null ? void 0 : _currentAlert$validat4.threshold) !== undefined)) {\n        setDisableSave(false);\n      } else\n      {\n        setDisableSave(true);\n      }\n    } else\n    {\n      setDisableSave(true);\n    }\n  };\n  // Initialize\n  useEffect(() => {\n    if (isEditMode && (\n    !(currentAlert != null && currentAlert.id) || (alert == null ? void 0 : alert.id) !== currentAlert.id || isHidden && show)) {\n      if (alert && alert.id !== null && !loading && !fetchError) {\n        const id = alert.id || 0;\n        fetchResource(id);\n      }\n    } else\n    if (!isEditMode && (\n    !currentAlert || currentAlert.id || isHidden && show)) {\n      setCurrentAlert({ ...DEFAULT_ALERT });\n      setNotificationSettings([]);\n      setNotificationAddState('active');\n    }\n  }, [alert]);\n  useEffect(() => {\n    if (resource) {\n      // Add notification settings\n      const settings = (resource.recipients || []).map((setting) => {\n        const config = typeof setting.recipient_config_json === 'string' ?\n        JSON.parse(setting.recipient_config_json) :\n        {};\n        return {\n          method: setting.type,\n          // @ts-ignore: Type not assignable\n          recipients: config.target || setting.recipient_config_json,\n          options: allowedNotificationMethods };\n\n      });\n      setNotificationSettings(settings);\n      setNotificationAddState(settings.length === allowedNotificationMethods.length ?\n      'hidden' :\n      'active');\n      setContentType(resource.chart ? 'chart' : 'dashboard');\n      setReportFormat(resource.chart ?\n      resource.report_format || DEFAULT_NOTIFICATION_FORMAT :\n      DEFAULT_NOTIFICATION_FORMAT);\n      const validatorConfig = typeof resource.validator_config_json === 'string' ?\n      JSON.parse(resource.validator_config_json) :\n      resource.validator_config_json;\n      setConditionNotNull(resource.validator_type === 'not null');\n      if (resource.chart) {\n        setChartVizType(resource.chart.viz_type);\n      }\n      setCurrentAlert({\n        ...resource,\n        chart: resource.chart ?\n        getChartData(resource.chart) || {\n          value: resource.chart.id,\n          label: resource.chart.slice_name } :\n\n        undefined,\n        dashboard: resource.dashboard ?\n        getDashboardData(resource.dashboard) || {\n          value: resource.dashboard.id,\n          label: resource.dashboard.dashboard_title } :\n\n        undefined,\n        database: resource.database ?\n        getSourceData(resource.database) || {\n          value: resource.database.id,\n          label: resource.database.database_name } :\n\n        undefined,\n        owners: (resource.owners || []).map((owner) => ({\n          value: owner.id,\n          label: `${owner.first_name} ${owner.last_name}` })),\n\n        // @ts-ignore: Type not assignable\n        validator_config_json: resource.validator_type === 'not null' ?\n        {\n          op: 'not null' } :\n\n        validatorConfig });\n\n    }\n  }, [resource]);\n  // Validation\n  const currentAlertSafe = currentAlert || {};\n  useEffect(() => {\n    validate();\n  }, [\n  currentAlertSafe.name,\n  currentAlertSafe.owners,\n  currentAlertSafe.database,\n  currentAlertSafe.sql,\n  currentAlertSafe.validator_config_json,\n  currentAlertSafe.crontab,\n  currentAlertSafe.working_timeout,\n  currentAlertSafe.dashboard,\n  currentAlertSafe.chart,\n  contentType,\n  notificationSettings,\n  conditionNotNull]);\n\n  // Show/hide\n  if (isHidden && show) {\n    setIsHidden(false);\n  }\n  return ___EmotionJSX(StyledModal, { className: \"no-content-padding\", responsive: true, disablePrimaryButton: disableSave, onHandledPrimaryAction: onSave, onHide: hide, primaryButtonName: isEditMode ? t('Save') : t('Add'), show: show, width: \"100%\", maxWidth: \"1450px\", title: ___EmotionJSX(\"h4\", null,\n    isEditMode ? ___EmotionJSX(Icons.EditAlt, { css: StyledIcon }) : ___EmotionJSX(Icons.PlusLarge, { css: StyledIcon }),\n    isEditMode ?\n    t(`Edit ${isReport ? 'Report' : 'Alert'}`) :\n    t(`Add ${isReport ? 'Report' : 'Alert'}`)) },\n\n  ___EmotionJSX(StyledSectionContainer, null,\n  ___EmotionJSX(\"div\", { className: \"header-section\" },\n  ___EmotionJSX(StyledInputContainer, null,\n  ___EmotionJSX(\"div\", { className: \"control-label\" },\n  isReport ? t('Report name') : t('Alert name'),\n  ___EmotionJSX(\"span\", { className: \"required\" }, \"*\")),\n\n  ___EmotionJSX(\"div\", { className: \"input-container\" },\n  ___EmotionJSX(\"input\", { type: \"text\", name: \"name\", value: currentAlert ? currentAlert.name : '', placeholder: isReport ? t('Report name') : t('Alert name'), onChange: onTextChange }))),\n\n\n  ___EmotionJSX(StyledInputContainer, null,\n  ___EmotionJSX(\"div\", { className: \"control-label\" },\n  t('Owners'),\n  ___EmotionJSX(\"span\", { className: \"required\" }, \"*\")),\n\n  ___EmotionJSX(\"div\", { className: \"input-container\" },\n  ___EmotionJSX(Select, { ariaLabel: t('Owners'), allowClear: true, name: \"owners\", mode: \"multiple\", value: (currentAlert == null ? void 0 : currentAlert.owners) || [], options: loadOwnerOptions, onChange: onOwnersChange }))),\n\n\n  ___EmotionJSX(StyledInputContainer, null,\n  ___EmotionJSX(\"div\", { className: \"control-label\" }, t('Description')),\n  ___EmotionJSX(\"div\", { className: \"input-container\" },\n  ___EmotionJSX(\"input\", { type: \"text\", name: \"description\", value: currentAlert ? currentAlert.description || '' : '', placeholder: t('Description'), onChange: onTextChange }))),\n\n\n  ___EmotionJSX(StyledSwitchContainer, null,\n  ___EmotionJSX(Switch, { onChange: onActiveSwitch, checked: currentAlert ? currentAlert.active : true }),\n  ___EmotionJSX(\"div\", { className: \"switch-label\" }, \"Active\"))),\n\n\n  ___EmotionJSX(\"div\", { className: \"column-section\" },\n  !isReport && ___EmotionJSX(\"div\", { className: \"column condition\" },\n  ___EmotionJSX(StyledSectionTitle, null,\n  ___EmotionJSX(\"h4\", null, t('Alert condition'))),\n\n  ___EmotionJSX(StyledInputContainer, null,\n  ___EmotionJSX(\"div\", { className: \"control-label\" },\n  t('Database'),\n  ___EmotionJSX(\"span\", { className: \"required\" }, \"*\")),\n\n  ___EmotionJSX(\"div\", { className: \"input-container\" },\n  ___EmotionJSX(Select, { ariaLabel: t('Database'), name: \"source\", value: currentAlert != null && (_currentAlert$databas2 = currentAlert.database) != null && _currentAlert$databas2.label &&\n    currentAlert != null && (_currentAlert$databas3 = currentAlert.database) != null && _currentAlert$databas3.value ?\n    {\n      value: currentAlert.database.value,\n      label: currentAlert.database.label } :\n\n    undefined, options: loadSourceOptions, onChange: onSourceChange }))),\n\n\n  ___EmotionJSX(StyledInputContainer, null,\n  ___EmotionJSX(\"div\", { className: \"control-label\" },\n  t('SQL Query'),\n  ___EmotionJSX(\"span\", { className: \"required\" }, \"*\")),\n\n  ___EmotionJSX(TextAreaControl, { name: \"sql\", language: \"sql\", offerEditInModal: false, minLines: 15, maxLines: 15, onChange: onSQLChange, readOnly: false, initialValue: resource == null ? void 0 : resource.sql, key: currentAlert == null ? void 0 : currentAlert.id })),\n\n  ___EmotionJSX(\"div\", { className: \"inline-container wrap\" },\n  ___EmotionJSX(StyledInputContainer, null,\n  ___EmotionJSX(\"div\", { className: \"control-label\" },\n  t('Trigger Alert If...'),\n  ___EmotionJSX(\"span\", { className: \"required\" }, \"*\")),\n\n  ___EmotionJSX(\"div\", { className: \"input-container\" },\n  ___EmotionJSX(Select, { ariaLabel: t('Condition'), onChange: onConditionChange, placeholder: \"Condition\", value: (currentAlert == null ? void 0 : (_currentAlert$validat5 = currentAlert.validator_config_json) == null ? void 0 : _currentAlert$validat5.op) || undefined, options: CONDITIONS }))),\n\n\n  ___EmotionJSX(StyledInputContainer, null,\n  ___EmotionJSX(\"div\", { className: \"control-label\" },\n  t('Value'),\n  ___EmotionJSX(\"span\", { className: \"required\" }, \"*\")),\n\n  ___EmotionJSX(\"div\", { className: \"input-container\" },\n  ___EmotionJSX(\"input\", { type: \"number\", name: \"threshold\", disabled: conditionNotNull, value: currentAlert &&\n    currentAlert.validator_config_json &&\n    currentAlert.validator_config_json.threshold !==\n    undefined ?\n    currentAlert.validator_config_json.threshold :\n    '', placeholder: t('Value'), onChange: onThresholdChange }))))),\n\n\n\n\n  ___EmotionJSX(\"div\", { className: \"column schedule\" },\n  ___EmotionJSX(StyledSectionTitle, null,\n  ___EmotionJSX(\"h4\", null,\n  isReport ?\n  t('Report schedule') :\n  t('Alert condition schedule')),\n\n  ___EmotionJSX(\"span\", { className: \"required\" }, \"*\")),\n\n  ___EmotionJSX(AlertReportCronScheduler, { value: (currentAlert == null ? void 0 : currentAlert.crontab) || DEFAULT_CRON_VALUE, onChange: (newVal) => updateAlertState('crontab', newVal) }),\n  ___EmotionJSX(\"div\", { className: \"control-label\" }, t('Timezone')),\n  ___EmotionJSX(\"div\", { className: \"input-container\", css: (theme) => timezoneHeaderStyle(theme) },\n  ___EmotionJSX(TimezoneSelector, { onTimezoneChange: onTimezoneChange, timezone: currentAlert == null ? void 0 : currentAlert.timezone })),\n\n  ___EmotionJSX(StyledSectionTitle, null,\n  ___EmotionJSX(\"h4\", null, t('Schedule settings'))),\n\n  ___EmotionJSX(StyledInputContainer, null,\n  ___EmotionJSX(\"div\", { className: \"control-label\" },\n  t('Log retention'),\n  ___EmotionJSX(\"span\", { className: \"required\" }, \"*\")),\n\n  ___EmotionJSX(\"div\", { className: \"input-container\" },\n  ___EmotionJSX(Select, { ariaLabel: t('Log retention'), placeholder: t('Log retention'), onChange: onLogRetentionChange, value: (currentAlert == null ? void 0 : currentAlert.log_retention) || DEFAULT_RETENTION, options: RETENTION_OPTIONS }))),\n\n\n  ___EmotionJSX(StyledInputContainer, null,\n  ___EmotionJSX(\"div\", { className: \"control-label\" },\n  t('Working timeout'),\n  ___EmotionJSX(\"span\", { className: \"required\" }, \"*\")),\n\n  ___EmotionJSX(\"div\", { className: \"input-container\" },\n  ___EmotionJSX(\"input\", { type: \"number\", min: \"1\", name: \"working_timeout\", value: (currentAlert == null ? void 0 : currentAlert.working_timeout) || '', placeholder: t('Time in seconds'), onChange: onTimeoutVerifyChange }),\n  ___EmotionJSX(\"span\", { className: \"input-label\" }, \"seconds\"))),\n\n\n  !isReport && ___EmotionJSX(StyledInputContainer, null,\n  ___EmotionJSX(\"div\", { className: \"control-label\" }, t('Grace period')),\n  ___EmotionJSX(\"div\", { className: \"input-container\" },\n  ___EmotionJSX(\"input\", { type: \"number\", min: \"1\", name: \"grace_period\", value: (currentAlert == null ? void 0 : currentAlert.grace_period) || '', placeholder: t('Time in seconds'), onChange: onTimeoutVerifyChange }),\n  ___EmotionJSX(\"span\", { className: \"input-label\" }, \"seconds\")))),\n\n\n\n  ___EmotionJSX(\"div\", { className: \"column message\" },\n  ___EmotionJSX(StyledSectionTitle, null,\n  ___EmotionJSX(\"h4\", null, t('Message content')),\n  ___EmotionJSX(\"span\", { className: \"required\" }, \"*\")),\n\n  ___EmotionJSX(Radio.Group, { onChange: onContentTypeChange, value: contentType },\n  ___EmotionJSX(StyledRadio, { value: \"dashboard\" }, t('Dashboard')),\n  ___EmotionJSX(StyledRadio, { value: \"chart\" }, t('Chart'))),\n\n  ___EmotionJSX(Select, { ariaLabel: t('Chart'), css: /*#__PURE__*/_css({\n      display: contentType === 'chart' ? 'inline' : 'none' }, process.env.NODE_ENV === \"production\" ? \"\" : \";label:AlertReportModal;\", process.env.NODE_ENV === \"production\" ? \"\" : \"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9zdXBlcnNldC1mcm9udGVuZC9zcmMvdmlld3MvQ1JVRC9hbGVydC9BbGVydFJlcG9ydE1vZGFsLnRzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUE4NEIyQyIsImZpbGUiOiIvc3VwZXJzZXQtZnJvbnRlbmQvc3JjL3ZpZXdzL0NSVUQvYWxlcnQvQWxlcnRSZXBvcnRNb2RhbC50c3giLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRhdGlvbiAoQVNGKSB1bmRlciBvbmVcbiAqIG9yIG1vcmUgY29udHJpYnV0b3IgbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZVxuICogZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3JtYXRpb25cbiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGVcbiAqIHRvIHlvdSB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGVcbiAqIFwiTGljZW5zZVwiKTsgeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZVxuICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLFxuICogc29mdHdhcmUgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW5cbiAqIFwiQVMgSVNcIiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZXG4gKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZvciB0aGVcbiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnNcbiAqIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5pbXBvcnQgUmVhY3QsIHsgdXNlU3RhdGUsIHVzZUVmZmVjdCwgdXNlTWVtbywgdXNlQ2FsbGJhY2ssIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgc3R5bGVkLCB0LCBTdXBlcnNldENsaWVudCwgY3NzLCB9IGZyb20gJ0BzdXBlcnNldC11aS9jb3JlJztcbmltcG9ydCByaXNvbiBmcm9tICdyaXNvbic7XG5pbXBvcnQgeyB1c2VTaW5nbGVWaWV3UmVzb3VyY2UgfSBmcm9tICdzcmMvdmlld3MvQ1JVRC9ob29rcyc7XG5pbXBvcnQgSWNvbnMgZnJvbSAnc3JjL2NvbXBvbmVudHMvSWNvbnMnO1xuaW1wb3J0IHsgU3dpdGNoIH0gZnJvbSAnc3JjL2NvbXBvbmVudHMvU3dpdGNoJztcbmltcG9ydCBNb2RhbCBmcm9tICdzcmMvY29tcG9uZW50cy9Nb2RhbCc7XG5pbXBvcnQgVGltZXpvbmVTZWxlY3RvciBmcm9tICdzcmMvY29tcG9uZW50cy9UaW1lem9uZVNlbGVjdG9yJztcbmltcG9ydCB7IFJhZGlvIH0gZnJvbSAnc3JjL2NvbXBvbmVudHMvUmFkaW8nO1xuaW1wb3J0IHsgU2VsZWN0IH0gZnJvbSAnc3JjL2NvbXBvbmVudHMnO1xuaW1wb3J0IHsgRmVhdHVyZUZsYWcsIGlzRmVhdHVyZUVuYWJsZWQgfSBmcm9tICdzcmMvZmVhdHVyZUZsYWdzJztcbmltcG9ydCB3aXRoVG9hc3RzIGZyb20gJ3NyYy9jb21wb25lbnRzL01lc3NhZ2VUb2FzdHMvd2l0aFRvYXN0cyc7XG5pbXBvcnQgVGV4dEFyZWFDb250cm9sIGZyb20gJ3NyYy9leHBsb3JlL2NvbXBvbmVudHMvY29udHJvbHMvVGV4dEFyZWFDb250cm9sJztcbmltcG9ydCB7IHVzZUNvbW1vbkNvbmYgfSBmcm9tICdzcmMvdmlld3MvQ1JVRC9kYXRhL2RhdGFiYXNlL3N0YXRlJztcbmltcG9ydCB7IEFsZXJ0UmVwb3J0Q3JvblNjaGVkdWxlciB9IGZyb20gJy4vY29tcG9uZW50cy9BbGVydFJlcG9ydENyb25TY2hlZHVsZXInO1xuaW1wb3J0IHsgTm90aWZpY2F0aW9uTWV0aG9kIH0gZnJvbSAnLi9jb21wb25lbnRzL05vdGlmaWNhdGlvbk1ldGhvZCc7XG5jb25zdCBUSU1FT1VUX01JTiA9IDE7XG5jb25zdCBURVhUX0JBU0VEX1ZJU1VBTElaQVRJT05fVFlQRVMgPSBbXG4gICAgJ3Bpdm90X3RhYmxlJyxcbiAgICAncGl2b3RfdGFibGVfdjInLFxuICAgICd0YWJsZScsXG4gICAgJ3BhaXJlZF90dGVzdCcsXG5dO1xuY29uc3QgREVGQVVMVF9OT1RJRklDQVRJT05fTUVUSE9EUyA9IFsnRW1haWwnXTtcbmNvbnN0IERFRkFVTFRfTk9USUZJQ0FUSU9OX0ZPUk1BVCA9ICdQTkcnO1xuY29uc3QgQ09ORElUSU9OUyA9IFtcbiAgICB7XG4gICAgICAgIGxhYmVsOiB0KCc8IChTbWFsbGVyIHRoYW4pJyksXG4gICAgICAgIHZhbHVlOiAnPCcsXG4gICAgfSxcbiAgICB7XG4gICAgICAgIGxhYmVsOiB0KCc+IChMYXJnZXIgdGhhbiknKSxcbiAgICAgICAgdmFsdWU6ICc+JyxcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbGFiZWw6IHQoJzw9IChTbWFsbGVyIG9yIGVxdWFsKScpLFxuICAgICAgICB2YWx1ZTogJzw9JyxcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbGFiZWw6IHQoJz49IChMYXJnZXIgb3IgZXF1YWwpJyksXG4gICAgICAgIHZhbHVlOiAnPj0nLFxuICAgIH0sXG4gICAge1xuICAgICAgICBsYWJlbDogdCgnPT0gKElzIGVxdWFsKScpLFxuICAgICAgICB2YWx1ZTogJz09JyxcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbGFiZWw6IHQoJyE9IChJcyBub3QgZXF1YWwpJyksXG4gICAgICAgIHZhbHVlOiAnIT0nLFxuICAgIH0sXG4gICAge1xuICAgICAgICBsYWJlbDogdCgnTm90IG51bGwnKSxcbiAgICAgICAgdmFsdWU6ICdub3QgbnVsbCcsXG4gICAgfSxcbl07XG5jb25zdCBSRVRFTlRJT05fT1BUSU9OUyA9IFtcbiAgICB7XG4gICAgICAgIGxhYmVsOiB0KCdOb25lJyksXG4gICAgICAgIHZhbHVlOiAwLFxuICAgIH0sXG4gICAge1xuICAgICAgICBsYWJlbDogdCgnMzAgZGF5cycpLFxuICAgICAgICB2YWx1ZTogMzAsXG4gICAgfSxcbiAgICB7XG4gICAgICAgIGxhYmVsOiB0KCc2MCBkYXlzJyksXG4gICAgICAgIHZhbHVlOiA2MCxcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbGFiZWw6IHQoJzkwIGRheXMnKSxcbiAgICAgICAgdmFsdWU6IDkwLFxuICAgIH0sXG5dO1xuY29uc3QgREVGQVVMVF9SRVRFTlRJT04gPSA5MDtcbmNvbnN0IERFRkFVTFRfV09SS0lOR19USU1FT1VUID0gMzYwMDtcbmNvbnN0IERFRkFVTFRfQ1JPTl9WQUxVRSA9ICcwICogKiAqIConOyAvLyBldmVyeSBob3VyXG5jb25zdCBERUZBVUxUX0FMRVJUID0ge1xuICAgIGFjdGl2ZTogdHJ1ZSxcbiAgICBjcmVhdGlvbl9tZXRob2Q6ICdhbGVydHNfcmVwb3J0cycsXG4gICAgY3JvbnRhYjogREVGQVVMVF9DUk9OX1ZBTFVFLFxuICAgIGxvZ19yZXRlbnRpb246IERFRkFVTFRfUkVURU5USU9OLFxuICAgIHdvcmtpbmdfdGltZW91dDogREVGQVVMVF9XT1JLSU5HX1RJTUVPVVQsXG4gICAgbmFtZTogJycsXG4gICAgb3duZXJzOiBbXSxcbiAgICByZWNpcGllbnRzOiBbXSxcbiAgICBzcWw6ICcnLFxuICAgIHZhbGlkYXRvcl9jb25maWdfanNvbjoge30sXG4gICAgdmFsaWRhdG9yX3R5cGU6ICcnLFxuICAgIGdyYWNlX3BlcmlvZDogdW5kZWZpbmVkLFxufTtcbmNvbnN0IFN0eWxlZE1vZGFsID0gc3R5bGVkKE1vZGFsKSBgXG4gIC5hbnQtbW9kYWwtYm9keSB7XG4gICAgb3ZlcmZsb3c6IGluaXRpYWw7XG4gIH1cbmA7XG5jb25zdCBTdHlsZWRJY29uID0gKHRoZW1lKSA9PiBjc3MgYFxuICBtYXJnaW46IGF1dG8gJHt0aGVtZS5ncmlkVW5pdCAqIDJ9cHggYXV0byAwO1xuICBjb2xvcjogJHt0aGVtZS5jb2xvcnMuZ3JheXNjYWxlLmJhc2V9O1xuYDtcbmNvbnN0IFN0eWxlZFNlY3Rpb25Db250YWluZXIgPSBzdHlsZWQuZGl2IGBcbiAgZGlzcGxheTogZmxleDtcbiAgbWluLXdpZHRoOiAxMDAwcHg7XG4gIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG5cbiAgLmhlYWRlci1zZWN0aW9uIHtcbiAgICBkaXNwbGF5OiBmbGV4O1xuICAgIGZsZXg6IDAgMCBhdXRvO1xuICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgd2lkdGg6IDEwMCU7XG4gICAgcGFkZGluZzogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5ncmlkVW5pdCAqIDR9cHg7XG4gICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuY29sb3JzLmdyYXlzY2FsZS5saWdodDJ9O1xuICB9XG5cbiAgLmNvbHVtbi1zZWN0aW9uIHtcbiAgICBkaXNwbGF5OiBmbGV4O1xuICAgIGZsZXg6IDEgMSBhdXRvO1xuXG4gICAgLmNvbHVtbiB7XG4gICAgICBmbGV4OiAxIDEgYXV0bztcbiAgICAgIG1pbi13aWR0aDogY2FsYygzMy4zMyUgLSAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0ICogOH1weCk7XG4gICAgICBwYWRkaW5nOiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0ICogNH1weDtcblxuICAgICAgLmFzeW5jLXNlbGVjdCB7XG4gICAgICAgIG1hcmdpbjogMTBweCAwIDIwcHg7XG4gICAgICB9XG5cbiAgICAgICYuY29uZGl0aW9uIHtcbiAgICAgICAgYm9yZGVyLXJpZ2h0OiAxcHggc29saWQgJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5jb2xvcnMuZ3JheXNjYWxlLmxpZ2h0Mn07XG4gICAgICB9XG5cbiAgICAgICYubWVzc2FnZSB7XG4gICAgICAgIGJvcmRlci1sZWZ0OiAxcHggc29saWQgJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5jb2xvcnMuZ3JheXNjYWxlLmxpZ2h0Mn07XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLmlubGluZS1jb250YWluZXIge1xuICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgZmxleC1kaXJlY3Rpb246IHJvdztcbiAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgICYud3JhcCB7XG4gICAgICBmbGV4LXdyYXA6IHdyYXA7XG4gICAgfVxuXG4gICAgPiBkaXYge1xuICAgICAgZmxleDogMSAxIGF1dG87XG4gICAgfVxuXG4gICAgJi5hZGQtbWFyZ2luIHtcbiAgICAgIG1hcmdpbi1ib3R0b206IDVweDtcbiAgICB9XG5cbiAgICAuc3R5bGVkLWlucHV0IHtcbiAgICAgIG1hcmdpbjogMCAwIDAgMTBweDtcblxuICAgICAgaW5wdXQge1xuICAgICAgICBmbGV4OiAwIDAgYXV0bztcbiAgICAgIH1cbiAgICB9XG4gIH1cbmA7XG5jb25zdCBTdHlsZWRTZWN0aW9uVGl0bGUgPSBzdHlsZWQuZGl2IGBcbiAgZGlzcGxheTogZmxleDtcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgbWFyZ2luOiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0ICogMn1weCBhdXRvXG4gICAgJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5ncmlkVW5pdCAqIDR9cHggYXV0bztcblxuICBoNCB7XG4gICAgbWFyZ2luOiAwO1xuICB9XG5cbiAgLnJlcXVpcmVkIHtcbiAgICBtYXJnaW4tbGVmdDogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5ncmlkVW5pdH1weDtcbiAgICBjb2xvcjogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5jb2xvcnMuZXJyb3IuYmFzZX07XG4gIH1cbmA7XG5jb25zdCBTdHlsZWRTd2l0Y2hDb250YWluZXIgPSBzdHlsZWQuZGl2IGBcbiAgZGlzcGxheTogZmxleDtcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgbWFyZ2luLXRvcDogMTBweDtcblxuICAuc3dpdGNoLWxhYmVsIHtcbiAgICBtYXJnaW4tbGVmdDogMTBweDtcbiAgfVxuYDtcbmV4cG9ydCBjb25zdCBTdHlsZWRJbnB1dENvbnRhaW5lciA9IHN0eWxlZC5kaXYgYFxuICBmbGV4OiAxO1xuICBtYXJnaW46ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuZ3JpZFVuaXQgKiAyfXB4O1xuICBtYXJnaW4tdG9wOiAwO1xuXG4gIC5oZWxwZXIge1xuICAgIGRpc3BsYXk6IGJsb2NrO1xuICAgIGNvbG9yOiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmNvbG9ycy5ncmF5c2NhbGUuYmFzZX07XG4gICAgZm9udC1zaXplOiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLnR5cG9ncmFwaHkuc2l6ZXMucyAtIDF9cHg7XG4gICAgcGFkZGluZzogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5ncmlkVW5pdH1weCAwO1xuICAgIHRleHQtYWxpZ246IGxlZnQ7XG4gIH1cblxuICAucmVxdWlyZWQge1xuICAgIG1hcmdpbi1sZWZ0OiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0IC8gMn1weDtcbiAgICBjb2xvcjogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5jb2xvcnMuZXJyb3IuYmFzZX07XG4gIH1cblxuICAuaW5wdXQtY29udGFpbmVyIHtcbiAgICBkaXNwbGF5OiBmbGV4O1xuICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cbiAgICA+IGRpdiB7XG4gICAgICB3aWR0aDogMTAwJTtcbiAgICB9XG5cbiAgICBsYWJlbCB7XG4gICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgbWFyZ2luLXJpZ2h0OiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0ICogMn1weDtcbiAgICB9XG5cbiAgICBpIHtcbiAgICAgIG1hcmdpbjogMCAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0fXB4O1xuICAgIH1cbiAgfVxuXG4gIGlucHV0LFxuICB0ZXh0YXJlYSB7XG4gICAgZmxleDogMSAxIGF1dG87XG4gIH1cblxuICBpbnB1dFtkaXNhYmxlZF0ge1xuICAgIGNvbG9yOiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmNvbG9ycy5ncmF5c2NhbGUuYmFzZX07XG4gIH1cblxuICB0ZXh0YXJlYSB7XG4gICAgaGVpZ2h0OiAzMDBweDtcbiAgICByZXNpemU6IG5vbmU7XG4gIH1cblxuICBpbnB1dDo6cGxhY2Vob2xkZXIsXG4gIHRleHRhcmVhOjpwbGFjZWhvbGRlciB7XG4gICAgY29sb3I6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuY29sb3JzLmdyYXlzY2FsZS5saWdodDF9O1xuICB9XG5cbiAgdGV4dGFyZWEsXG4gIGlucHV0W3R5cGU9J3RleHQnXSxcbiAgaW5wdXRbdHlwZT0nbnVtYmVyJ10ge1xuICAgIHBhZGRpbmc6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuZ3JpZFVuaXR9cHhcbiAgICAgICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuZ3JpZFVuaXQgKiAyfXB4O1xuICAgIGJvcmRlci1zdHlsZTogbm9uZTtcbiAgICBib3JkZXI6IDFweCBzb2xpZCAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmNvbG9ycy5ncmF5c2NhbGUubGlnaHQyfTtcbiAgICBib3JkZXItcmFkaXVzOiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0fXB4O1xuXG4gICAgJltuYW1lPSdkZXNjcmlwdGlvbiddIHtcbiAgICAgIGZsZXg6IDEgMSBhdXRvO1xuICAgIH1cbiAgfVxuXG4gIC5pbnB1dC1sYWJlbCB7XG4gICAgbWFyZ2luLWxlZnQ6IDEwcHg7XG4gIH1cbmA7XG5jb25zdCBTdHlsZWRSYWRpbyA9IHN0eWxlZChSYWRpbykgYFxuICBkaXNwbGF5OiBibG9jaztcbiAgbGluZS1oZWlnaHQ6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuZ3JpZFVuaXQgKiA3fXB4O1xuYDtcbmNvbnN0IFN0eWxlZFJhZGlvR3JvdXAgPSBzdHlsZWQoUmFkaW8uR3JvdXApIGBcbiAgbWFyZ2luLWxlZnQ6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuZ3JpZFVuaXQgKiA1LjV9cHg7XG5gO1xuLy8gTm90aWZpY2F0aW9uIE1ldGhvZCBjb21wb25lbnRzXG5jb25zdCBTdHlsZWROb3RpZmljYXRpb25BZGRCdXR0b24gPSBzdHlsZWQuZGl2IGBcbiAgY29sb3I6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuY29sb3JzLnByaW1hcnkuZGFyazF9O1xuICBjdXJzb3I6IHBvaW50ZXI7XG5cbiAgaSB7XG4gICAgbWFyZ2luLXJpZ2h0OiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0ICogMn1weDtcbiAgfVxuXG4gICYuZGlzYWJsZWQge1xuICAgIGNvbG9yOiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmNvbG9ycy5ncmF5c2NhbGUubGlnaHQxfTtcbiAgICBjdXJzb3I6IGRlZmF1bHQ7XG4gIH1cbmA7XG5jb25zdCB0aW1lem9uZUhlYWRlclN0eWxlID0gKHRoZW1lKSA9PiBjc3MgYFxuICBtYXJnaW46ICR7dGhlbWUuZ3JpZFVuaXQgKiAzfXB4IDA7XG5gO1xuY29uc3QgTm90aWZpY2F0aW9uTWV0aG9kQWRkID0gKHsgc3RhdHVzID0gJ2FjdGl2ZScsIG9uQ2xpY2ssIH0pID0+IHtcbiAgICBpZiAoc3RhdHVzID09PSAnaGlkZGVuJykge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgY29uc3QgY2hlY2tTdGF0dXMgPSAoKSA9PiB7XG4gICAgICAgIGlmIChzdGF0dXMgIT09ICdkaXNhYmxlZCcpIHtcbiAgICAgICAgICAgIG9uQ2xpY2soKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuICg8U3R5bGVkTm90aWZpY2F0aW9uQWRkQnV0dG9uIGNsYXNzTmFtZT17c3RhdHVzfSBvbkNsaWNrPXtjaGVja1N0YXR1c30+XG4gICAgICA8aSBjbGFzc05hbWU9XCJmYSBmYS1wbHVzXCIvPnsnICd9XG4gICAgICB7c3RhdHVzID09PSAnYWN0aXZlJ1xuICAgICAgICAgICAgPyB0KCdBZGQgbm90aWZpY2F0aW9uIG1ldGhvZCcpXG4gICAgICAgICAgICA6IHQoJ0FkZCBkZWxpdmVyeSBtZXRob2QnKX1cbiAgICA8L1N0eWxlZE5vdGlmaWNhdGlvbkFkZEJ1dHRvbj4pO1xufTtcbmNvbnN0IEFsZXJ0UmVwb3J0TW9kYWwgPSAoeyBhZGREYW5nZXJUb2FzdCwgb25BZGQsIG9uSGlkZSwgc2hvdywgYWxlcnQgPSBudWxsLCBpc1JlcG9ydCA9IGZhbHNlLCB9KSA9PiB7XG4gICAgY29uc3QgY29uZiA9IHVzZUNvbW1vbkNvbmYoKTtcbiAgICBjb25zdCBhbGxvd2VkTm90aWZpY2F0aW9uTWV0aG9kcyA9IGNvbmY/LkFMRVJUX1JFUE9SVFNfTk9USUZJQ0FUSU9OX01FVEhPRFMgfHwgREVGQVVMVF9OT1RJRklDQVRJT05fTUVUSE9EUztcbiAgICBjb25zdCBbZGlzYWJsZVNhdmUsIHNldERpc2FibGVTYXZlXSA9IHVzZVN0YXRlKHRydWUpO1xuICAgIGNvbnN0IFtjdXJyZW50QWxlcnQsIHNldEN1cnJlbnRBbGVydCxdID0gdXNlU3RhdGUoKTtcbiAgICBjb25zdCBbaXNIaWRkZW4sIHNldElzSGlkZGVuXSA9IHVzZVN0YXRlKHRydWUpO1xuICAgIGNvbnN0IFtjb250ZW50VHlwZSwgc2V0Q29udGVudFR5cGVdID0gdXNlU3RhdGUoJ2Rhc2hib2FyZCcpO1xuICAgIGNvbnN0IFtyZXBvcnRGb3JtYXQsIHNldFJlcG9ydEZvcm1hdF0gPSB1c2VTdGF0ZShERUZBVUxUX05PVElGSUNBVElPTl9GT1JNQVQpO1xuICAgIC8vIERyb3Bkb3duIG9wdGlvbnNcbiAgICBjb25zdCBbY29uZGl0aW9uTm90TnVsbCwgc2V0Q29uZGl0aW9uTm90TnVsbF0gPSB1c2VTdGF0ZShmYWxzZSk7XG4gICAgY29uc3QgW3NvdXJjZU9wdGlvbnMsIHNldFNvdXJjZU9wdGlvbnNdID0gdXNlU3RhdGUoW10pO1xuICAgIGNvbnN0IFtkYXNoYm9hcmRPcHRpb25zLCBzZXREYXNoYm9hcmRPcHRpb25zXSA9IHVzZVN0YXRlKFtdKTtcbiAgICBjb25zdCBbY2hhcnRPcHRpb25zLCBzZXRDaGFydE9wdGlvbnNdID0gdXNlU3RhdGUoW10pO1xuICAgIC8vIENoYXJ0IG1ldGFkYXRhXG4gICAgY29uc3QgW2NoYXJ0Vml6VHlwZSwgc2V0Q2hhcnRWaXpUeXBlXSA9IHVzZVN0YXRlKCcnKTtcbiAgICBjb25zdCBpc0VkaXRNb2RlID0gYWxlcnQgIT09IG51bGw7XG4gICAgY29uc3QgZm9ybWF0T3B0aW9uRW5hYmxlZCA9IGNvbnRlbnRUeXBlID09PSAnY2hhcnQnICYmXG4gICAgICAgIChpc0ZlYXR1cmVFbmFibGVkKEZlYXR1cmVGbGFnLkFMRVJUU19BVFRBQ0hfUkVQT1JUUykgfHwgaXNSZXBvcnQpO1xuICAgIGNvbnN0IFtub3RpZmljYXRpb25BZGRTdGF0ZSwgc2V0Tm90aWZpY2F0aW9uQWRkU3RhdGUsXSA9IHVzZVN0YXRlKCdhY3RpdmUnKTtcbiAgICBjb25zdCBbbm90aWZpY2F0aW9uU2V0dGluZ3MsIHNldE5vdGlmaWNhdGlvblNldHRpbmdzXSA9IHVzZVN0YXRlKFtdKTtcbiAgICBjb25zdCBvbk5vdGlmaWNhdGlvbkFkZCA9ICgpID0+IHtcbiAgICAgICAgY29uc3Qgc2V0dGluZ3MgPSBub3RpZmljYXRpb25TZXR0aW5ncy5zbGljZSgpO1xuICAgICAgICBzZXR0aW5ncy5wdXNoKHtcbiAgICAgICAgICAgIHJlY2lwaWVudHM6ICcnLFxuICAgICAgICAgICAgb3B0aW9uczogYWxsb3dlZE5vdGlmaWNhdGlvbk1ldGhvZHMsXG4gICAgICAgIH0pO1xuICAgICAgICBzZXROb3RpZmljYXRpb25TZXR0aW5ncyhzZXR0aW5ncyk7XG4gICAgICAgIHNldE5vdGlmaWNhdGlvbkFkZFN0YXRlKHNldHRpbmdzLmxlbmd0aCA9PT0gYWxsb3dlZE5vdGlmaWNhdGlvbk1ldGhvZHMubGVuZ3RoXG4gICAgICAgICAgICA/ICdoaWRkZW4nXG4gICAgICAgICAgICA6ICdkaXNhYmxlZCcpO1xuICAgIH07XG4gICAgY29uc3QgdXBkYXRlTm90aWZpY2F0aW9uU2V0dGluZyA9IChpbmRleCwgc2V0dGluZykgPT4ge1xuICAgICAgICBjb25zdCBzZXR0aW5ncyA9IG5vdGlmaWNhdGlvblNldHRpbmdzLnNsaWNlKCk7XG4gICAgICAgIHNldHRpbmdzW2luZGV4XSA9IHNldHRpbmc7XG4gICAgICAgIHNldE5vdGlmaWNhdGlvblNldHRpbmdzKHNldHRpbmdzKTtcbiAgICAgICAgaWYgKHNldHRpbmcubWV0aG9kICE9PSB1bmRlZmluZWQgJiYgbm90aWZpY2F0aW9uQWRkU3RhdGUgIT09ICdoaWRkZW4nKSB7XG4gICAgICAgICAgICBzZXROb3RpZmljYXRpb25BZGRTdGF0ZSgnYWN0aXZlJyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNvbnN0IHJlbW92ZU5vdGlmaWNhdGlvblNldHRpbmcgPSAoaW5kZXgpID0+IHtcbiAgICAgICAgY29uc3Qgc2V0dGluZ3MgPSBub3RpZmljYXRpb25TZXR0aW5ncy5zbGljZSgpO1xuICAgICAgICBzZXR0aW5ncy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICBzZXROb3RpZmljYXRpb25TZXR0aW5ncyhzZXR0aW5ncyk7XG4gICAgICAgIHNldE5vdGlmaWNhdGlvbkFkZFN0YXRlKCdhY3RpdmUnKTtcbiAgICB9O1xuICAgIC8vIEFsZXJ0IGZldGNoIGxvZ2ljXG4gICAgY29uc3QgeyBzdGF0ZTogeyBsb2FkaW5nLCByZXNvdXJjZSwgZXJyb3I6IGZldGNoRXJyb3IgfSwgZmV0Y2hSZXNvdXJjZSwgY3JlYXRlUmVzb3VyY2UsIHVwZGF0ZVJlc291cmNlLCBjbGVhckVycm9yLCB9ID0gdXNlU2luZ2xlVmlld1Jlc291cmNlKCdyZXBvcnQnLCB0KCdyZXBvcnQnKSwgYWRkRGFuZ2VyVG9hc3QpO1xuICAgIC8vIEZ1bmN0aW9uc1xuICAgIGNvbnN0IGhpZGUgPSAoKSA9PiB7XG4gICAgICAgIGNsZWFyRXJyb3IoKTtcbiAgICAgICAgc2V0SXNIaWRkZW4odHJ1ZSk7XG4gICAgICAgIG9uSGlkZSgpO1xuICAgICAgICBzZXROb3RpZmljYXRpb25TZXR0aW5ncyhbXSk7XG4gICAgICAgIHNldEN1cnJlbnRBbGVydCh7IC4uLkRFRkFVTFRfQUxFUlQgfSk7XG4gICAgICAgIHNldE5vdGlmaWNhdGlvbkFkZFN0YXRlKCdhY3RpdmUnKTtcbiAgICB9O1xuICAgIGNvbnN0IG9uU2F2ZSA9ICgpID0+IHtcbiAgICAgICAgLy8gTm90aWZpY2F0aW9uIFNldHRpbmdzXG4gICAgICAgIGNvbnN0IHJlY2lwaWVudHMgPSBbXTtcbiAgICAgICAgbm90aWZpY2F0aW9uU2V0dGluZ3MuZm9yRWFjaChzZXR0aW5nID0+IHtcbiAgICAgICAgICAgIGlmIChzZXR0aW5nLm1ldGhvZCAmJiBzZXR0aW5nLnJlY2lwaWVudHMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcmVjaXBpZW50cy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50X2NvbmZpZ19qc29uOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6IHNldHRpbmcucmVjaXBpZW50cyxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogc2V0dGluZy5tZXRob2QsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBkYXRhID0ge1xuICAgICAgICAgICAgLi4uY3VycmVudEFsZXJ0LFxuICAgICAgICAgICAgdHlwZTogaXNSZXBvcnQgPyAnUmVwb3J0JyA6ICdBbGVydCcsXG4gICAgICAgICAgICB2YWxpZGF0b3JfdHlwZTogY29uZGl0aW9uTm90TnVsbCA/ICdub3QgbnVsbCcgOiAnb3BlcmF0b3InLFxuICAgICAgICAgICAgdmFsaWRhdG9yX2NvbmZpZ19qc29uOiBjb25kaXRpb25Ob3ROdWxsXG4gICAgICAgICAgICAgICAgPyB7fVxuICAgICAgICAgICAgICAgIDogY3VycmVudEFsZXJ0Py52YWxpZGF0b3JfY29uZmlnX2pzb24sXG4gICAgICAgICAgICBjaGFydDogY29udGVudFR5cGUgPT09ICdjaGFydCcgPyBjdXJyZW50QWxlcnQ/LmNoYXJ0Py52YWx1ZSA6IG51bGwsXG4gICAgICAgICAgICBkYXNoYm9hcmQ6IGNvbnRlbnRUeXBlID09PSAnZGFzaGJvYXJkJyA/IGN1cnJlbnRBbGVydD8uZGFzaGJvYXJkPy52YWx1ZSA6IG51bGwsXG4gICAgICAgICAgICBkYXRhYmFzZTogY3VycmVudEFsZXJ0Py5kYXRhYmFzZT8udmFsdWUsXG4gICAgICAgICAgICBvd25lcnM6IChjdXJyZW50QWxlcnQ/Lm93bmVycyB8fCBbXSkubWFwKG93bmVyID0+IG93bmVyLnZhbHVlKSxcbiAgICAgICAgICAgIHJlY2lwaWVudHMsXG4gICAgICAgICAgICByZXBvcnRfZm9ybWF0OiBjb250ZW50VHlwZSA9PT0gJ2Rhc2hib2FyZCdcbiAgICAgICAgICAgICAgICA/IERFRkFVTFRfTk9USUZJQ0FUSU9OX0ZPUk1BVFxuICAgICAgICAgICAgICAgIDogcmVwb3J0Rm9ybWF0IHx8IERFRkFVTFRfTk9USUZJQ0FUSU9OX0ZPUk1BVCxcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKGRhdGEucmVjaXBpZW50cyAmJiAhZGF0YS5yZWNpcGllbnRzLmxlbmd0aCkge1xuICAgICAgICAgICAgZGVsZXRlIGRhdGEucmVjaXBpZW50cztcbiAgICAgICAgfVxuICAgICAgICBkYXRhLmNvbnRleHRfbWFya2Rvd24gPSAnc3RyaW5nJztcbiAgICAgICAgaWYgKGlzRWRpdE1vZGUpIHtcbiAgICAgICAgICAgIC8vIEVkaXRcbiAgICAgICAgICAgIGlmIChjdXJyZW50QWxlcnQgJiYgY3VycmVudEFsZXJ0LmlkKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdXBkYXRlX2lkID0gY3VycmVudEFsZXJ0LmlkO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSBkYXRhLmlkO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSBkYXRhLmNyZWF0ZWRfYnk7XG4gICAgICAgICAgICAgICAgZGVsZXRlIGRhdGEubGFzdF9ldmFsX2R0dG07XG4gICAgICAgICAgICAgICAgZGVsZXRlIGRhdGEubGFzdF9zdGF0ZTtcbiAgICAgICAgICAgICAgICBkZWxldGUgZGF0YS5sYXN0X3ZhbHVlO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSBkYXRhLmxhc3RfdmFsdWVfcm93X2pzb247XG4gICAgICAgICAgICAgICAgdXBkYXRlUmVzb3VyY2UodXBkYXRlX2lkLCBkYXRhKS50aGVuKHJlc3BvbnNlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChvbkFkZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgb25BZGQoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBoaWRlKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoY3VycmVudEFsZXJ0KSB7XG4gICAgICAgICAgICAvLyBDcmVhdGVcbiAgICAgICAgICAgIGNyZWF0ZVJlc291cmNlKGRhdGEpLnRoZW4ocmVzcG9uc2UgPT4ge1xuICAgICAgICAgICAgICAgIGlmICghcmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAob25BZGQpIHtcbiAgICAgICAgICAgICAgICAgICAgb25BZGQocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBoaWRlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLy8gRmV0Y2ggZGF0YSB0byBwb3B1bGF0ZSBmb3JtIGRyb3Bkb3duc1xuICAgIGNvbnN0IGxvYWRPd25lck9wdGlvbnMgPSB1c2VNZW1vKCgpID0+IChpbnB1dCA9ICcnLCBwYWdlLCBwYWdlU2l6ZSkgPT4ge1xuICAgICAgICBjb25zdCBxdWVyeSA9IHJpc29uLmVuY29kZSh7IGZpbHRlcjogaW5wdXQsIHBhZ2UsIHBhZ2Vfc2l6ZTogcGFnZVNpemUgfSk7XG4gICAgICAgIHJldHVybiBTdXBlcnNldENsaWVudC5nZXQoe1xuICAgICAgICAgICAgZW5kcG9pbnQ6IGAvYXBpL3YxL3JlcG9ydC9yZWxhdGVkL293bmVycz9xPSR7cXVlcnl9YCxcbiAgICAgICAgfSkudGhlbihyZXNwb25zZSA9PiAoe1xuICAgICAgICAgICAgZGF0YTogcmVzcG9uc2UuanNvbi5yZXN1bHQubWFwKChpdGVtKSA9PiAoe1xuICAgICAgICAgICAgICAgIHZhbHVlOiBpdGVtLnZhbHVlLFxuICAgICAgICAgICAgICAgIGxhYmVsOiBpdGVtLnRleHQsXG4gICAgICAgICAgICB9KSksXG4gICAgICAgICAgICB0b3RhbENvdW50OiByZXNwb25zZS5qc29uLmNvdW50LFxuICAgICAgICB9KSk7XG4gICAgfSwgW10pO1xuICAgIGNvbnN0IGdldFNvdXJjZURhdGEgPSB1c2VDYWxsYmFjaygoZGIpID0+IHtcbiAgICAgICAgY29uc3QgZGF0YWJhc2UgPSBkYiB8fCBjdXJyZW50QWxlcnQ/LmRhdGFiYXNlO1xuICAgICAgICBpZiAoIWRhdGFiYXNlIHx8IGRhdGFiYXNlLmxhYmVsKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBsZXQgcmVzdWx0O1xuICAgICAgICAvLyBDeWNsZSB0aHJvdWdoIHNvdXJjZSBvcHRpb25zIHRvIGZpbmQgdGhlIHNlbGVjdGVkIG9wdGlvblxuICAgICAgICBzb3VyY2VPcHRpb25zLmZvckVhY2goc291cmNlID0+IHtcbiAgICAgICAgICAgIGlmIChzb3VyY2UudmFsdWUgPT09IGRhdGFiYXNlLnZhbHVlIHx8IHNvdXJjZS52YWx1ZSA9PT0gZGF0YWJhc2UuaWQpIHtcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBzb3VyY2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0sIFtjdXJyZW50QWxlcnQ/LmRhdGFiYXNlLCBzb3VyY2VPcHRpb25zXSk7XG4gICAgLy8gVXBkYXRpbmcgYWxlcnQvcmVwb3J0IHN0YXRlXG4gICAgY29uc3QgdXBkYXRlQWxlcnRTdGF0ZSA9IChuYW1lLCB2YWx1ZSkgPT4ge1xuICAgICAgICBzZXRDdXJyZW50QWxlcnQoY3VycmVudEFsZXJ0RGF0YSA9PiAoe1xuICAgICAgICAgICAgLi4uY3VycmVudEFsZXJ0RGF0YSxcbiAgICAgICAgICAgIFtuYW1lXTogdmFsdWUsXG4gICAgICAgIH0pKTtcbiAgICB9O1xuICAgIGNvbnN0IGxvYWRTb3VyY2VPcHRpb25zID0gdXNlTWVtbygoKSA9PiAoaW5wdXQgPSAnJywgcGFnZSwgcGFnZVNpemUpID0+IHtcbiAgICAgICAgY29uc3QgcXVlcnkgPSByaXNvbi5lbmNvZGUoeyBmaWx0ZXI6IGlucHV0LCBwYWdlLCBwYWdlX3NpemU6IHBhZ2VTaXplIH0pO1xuICAgICAgICByZXR1cm4gU3VwZXJzZXRDbGllbnQuZ2V0KHtcbiAgICAgICAgICAgIGVuZHBvaW50OiBgL2FwaS92MS9yZXBvcnQvcmVsYXRlZC9kYXRhYmFzZT9xPSR7cXVlcnl9YCxcbiAgICAgICAgfSkudGhlbihyZXNwb25zZSA9PiB7XG4gICAgICAgICAgICBjb25zdCBsaXN0ID0gcmVzcG9uc2UuanNvbi5yZXN1bHQubWFwKChpdGVtKSA9PiAoe1xuICAgICAgICAgICAgICAgIHZhbHVlOiBpdGVtLnZhbHVlLFxuICAgICAgICAgICAgICAgIGxhYmVsOiBpdGVtLnRleHQsXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICBzZXRTb3VyY2VPcHRpb25zKGxpc3QpO1xuICAgICAgICAgICAgcmV0dXJuIHsgZGF0YTogbGlzdCwgdG90YWxDb3VudDogcmVzcG9uc2UuanNvbi5jb3VudCB9O1xuICAgICAgICB9KTtcbiAgICB9LCBbXSk7XG4gICAgY29uc3QgZGF0YWJhc2VMYWJlbCA9IGN1cnJlbnRBbGVydCAmJiBjdXJyZW50QWxlcnQuZGF0YWJhc2UgJiYgIWN1cnJlbnRBbGVydC5kYXRhYmFzZS5sYWJlbDtcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICAvLyBGaW5kIHNvdXJjZSBpZiBjdXJyZW50IGFsZXJ0IGhhcyBvbmUgc2V0XG4gICAgICAgIGlmIChkYXRhYmFzZUxhYmVsKSB7XG4gICAgICAgICAgICB1cGRhdGVBbGVydFN0YXRlKCdkYXRhYmFzZScsIGdldFNvdXJjZURhdGEoKSk7XG4gICAgICAgIH1cbiAgICB9LCBbZGF0YWJhc2VMYWJlbCwgZ2V0U291cmNlRGF0YV0pO1xuICAgIGNvbnN0IGxvYWREYXNoYm9hcmRPcHRpb25zID0gdXNlTWVtbygoKSA9PiAoaW5wdXQgPSAnJywgcGFnZSwgcGFnZVNpemUpID0+IHtcbiAgICAgICAgY29uc3QgcXVlcnkgPSByaXNvbi5lbmNvZGUoeyBmaWx0ZXI6IGlucHV0LCBwYWdlLCBwYWdlX3NpemU6IHBhZ2VTaXplIH0pO1xuICAgICAgICByZXR1cm4gU3VwZXJzZXRDbGllbnQuZ2V0KHtcbiAgICAgICAgICAgIGVuZHBvaW50OiBgL2FwaS92MS9yZXBvcnQvcmVsYXRlZC9kYXNoYm9hcmQ/cT0ke3F1ZXJ5fWAsXG4gICAgICAgIH0pLnRoZW4ocmVzcG9uc2UgPT4ge1xuICAgICAgICAgICAgY29uc3QgbGlzdCA9IHJlc3BvbnNlLmpzb24ucmVzdWx0Lm1hcCgoaXRlbSkgPT4gKHtcbiAgICAgICAgICAgICAgICB2YWx1ZTogaXRlbS52YWx1ZSxcbiAgICAgICAgICAgICAgICBsYWJlbDogaXRlbS50ZXh0LFxuICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgc2V0RGFzaGJvYXJkT3B0aW9ucyhsaXN0KTtcbiAgICAgICAgICAgIHJldHVybiB7IGRhdGE6IGxpc3QsIHRvdGFsQ291bnQ6IHJlc3BvbnNlLmpzb24uY291bnQgfTtcbiAgICAgICAgfSk7XG4gICAgfSwgW10pO1xuICAgIGNvbnN0IGdldERhc2hib2FyZERhdGEgPSAoZGIpID0+IHtcbiAgICAgICAgY29uc3QgZGFzaGJvYXJkID0gZGIgfHwgY3VycmVudEFsZXJ0Py5kYXNoYm9hcmQ7XG4gICAgICAgIGlmICghZGFzaGJvYXJkIHx8IGRhc2hib2FyZC5sYWJlbCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IHJlc3VsdDtcbiAgICAgICAgLy8gQ3ljbGUgdGhyb3VnaCBkYXNoYm9hcmQgb3B0aW9ucyB0byBmaW5kIHRoZSBzZWxlY3RlZCBvcHRpb25cbiAgICAgICAgZGFzaGJvYXJkT3B0aW9ucy5mb3JFYWNoKGRhc2ggPT4ge1xuICAgICAgICAgICAgaWYgKGRhc2gudmFsdWUgPT09IGRhc2hib2FyZC52YWx1ZSB8fCBkYXNoLnZhbHVlID09PSBkYXNoYm9hcmQuaWQpIHtcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBkYXNoO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIGNvbnN0IGdldENoYXJ0RGF0YSA9IHVzZUNhbGxiYWNrKChjaGFydERhdGEpID0+IHtcbiAgICAgICAgY29uc3QgY2hhcnQgPSBjaGFydERhdGEgfHwgY3VycmVudEFsZXJ0Py5jaGFydDtcbiAgICAgICAgaWYgKCFjaGFydCB8fCBjaGFydC5sYWJlbCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IHJlc3VsdDtcbiAgICAgICAgLy8gQ3ljbGUgdGhyb3VnaCBjaGFydCBvcHRpb25zIHRvIGZpbmQgdGhlIHNlbGVjdGVkIG9wdGlvblxuICAgICAgICBjaGFydE9wdGlvbnMuZm9yRWFjaChzbGljZSA9PiB7XG4gICAgICAgICAgICBpZiAoc2xpY2UudmFsdWUgPT09IGNoYXJ0LnZhbHVlIHx8IHNsaWNlLnZhbHVlID09PSBjaGFydC5pZCkge1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHNsaWNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9LCBbY2hhcnRPcHRpb25zLCBjdXJyZW50QWxlcnQ/LmNoYXJ0XSk7XG4gICAgY29uc3Qgbm9DaGFydExhYmVsID0gY3VycmVudEFsZXJ0ICYmIGN1cnJlbnRBbGVydC5jaGFydCAmJiAhY3VycmVudEFsZXJ0LmNoYXJ0LmxhYmVsO1xuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIC8vIEZpbmQgc291cmNlIGlmIGN1cnJlbnQgYWxlcnQgaGFzIG9uZSBzZXRcbiAgICAgICAgaWYgKG5vQ2hhcnRMYWJlbCkge1xuICAgICAgICAgICAgdXBkYXRlQWxlcnRTdGF0ZSgnY2hhcnQnLCBnZXRDaGFydERhdGEoKSk7XG4gICAgICAgIH1cbiAgICB9LCBbZ2V0Q2hhcnREYXRhLCBub0NoYXJ0TGFiZWxdKTtcbiAgICBjb25zdCBsb2FkQ2hhcnRPcHRpb25zID0gdXNlTWVtbygoKSA9PiAoaW5wdXQgPSAnJywgcGFnZSwgcGFnZVNpemUpID0+IHtcbiAgICAgICAgY29uc3QgcXVlcnkgPSByaXNvbi5lbmNvZGUoeyBmaWx0ZXI6IGlucHV0LCBwYWdlLCBwYWdlX3NpemU6IHBhZ2VTaXplIH0pO1xuICAgICAgICByZXR1cm4gU3VwZXJzZXRDbGllbnQuZ2V0KHtcbiAgICAgICAgICAgIGVuZHBvaW50OiBgL2FwaS92MS9yZXBvcnQvcmVsYXRlZC9jaGFydD9xPSR7cXVlcnl9YCxcbiAgICAgICAgfSkudGhlbihyZXNwb25zZSA9PiB7XG4gICAgICAgICAgICBjb25zdCBsaXN0ID0gcmVzcG9uc2UuanNvbi5yZXN1bHQubWFwKChpdGVtKSA9PiAoe1xuICAgICAgICAgICAgICAgIHZhbHVlOiBpdGVtLnZhbHVlLFxuICAgICAgICAgICAgICAgIGxhYmVsOiBpdGVtLnRleHQsXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICBzZXRDaGFydE9wdGlvbnMobGlzdCk7XG4gICAgICAgICAgICByZXR1cm4geyBkYXRhOiBsaXN0LCB0b3RhbENvdW50OiByZXNwb25zZS5qc29uLmNvdW50IH07XG4gICAgICAgIH0pO1xuICAgIH0sIFtdKTtcbiAgICBjb25zdCBnZXRDaGFydFZpc3VhbGl6YXRpb25UeXBlID0gKGNoYXJ0KSA9PiBTdXBlcnNldENsaWVudC5nZXQoe1xuICAgICAgICBlbmRwb2ludDogYC9hcGkvdjEvY2hhcnQvJHtjaGFydC52YWx1ZX1gLFxuICAgIH0pLnRoZW4ocmVzcG9uc2UgPT4gc2V0Q2hhcnRWaXpUeXBlKHJlc3BvbnNlLmpzb24ucmVzdWx0LnZpel90eXBlKSk7XG4gICAgLy8gSGFuZGxlIGlucHV0L3RleHRhcmVhIHVwZGF0ZXNcbiAgICBjb25zdCBvblRleHRDaGFuZ2UgPSAoZXZlbnQpID0+IHtcbiAgICAgICAgY29uc3QgeyB0YXJnZXQgfSA9IGV2ZW50O1xuICAgICAgICB1cGRhdGVBbGVydFN0YXRlKHRhcmdldC5uYW1lLCB0YXJnZXQudmFsdWUpO1xuICAgIH07XG4gICAgY29uc3Qgb25UaW1lb3V0VmVyaWZ5Q2hhbmdlID0gKGV2ZW50KSA9PiB7XG4gICAgICAgIGNvbnN0IHsgdGFyZ2V0IH0gPSBldmVudDtcbiAgICAgICAgY29uc3QgdmFsdWUgPSArdGFyZ2V0LnZhbHVlO1xuICAgICAgICAvLyBOZWVkIHRvIG1ha2Ugc3VyZSBncmFjZSBwZXJpb2QgaXMgbm90IGxvd2VyIHRoYW4gVElNRU9VVF9NSU5cbiAgICAgICAgaWYgKHZhbHVlID09PSAwKSB7XG4gICAgICAgICAgICB1cGRhdGVBbGVydFN0YXRlKHRhcmdldC5uYW1lLCBudWxsKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHVwZGF0ZUFsZXJ0U3RhdGUodGFyZ2V0Lm5hbWUsIHZhbHVlID8gTWF0aC5tYXgodmFsdWUsIFRJTUVPVVRfTUlOKSA6IHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgY29uc3Qgb25TUUxDaGFuZ2UgPSAodmFsdWUpID0+IHtcbiAgICAgICAgdXBkYXRlQWxlcnRTdGF0ZSgnc3FsJywgdmFsdWUgfHwgJycpO1xuICAgIH07XG4gICAgY29uc3Qgb25Pd25lcnNDaGFuZ2UgPSAodmFsdWUpID0+IHtcbiAgICAgICAgdXBkYXRlQWxlcnRTdGF0ZSgnb3duZXJzJywgdmFsdWUgfHwgW10pO1xuICAgIH07XG4gICAgY29uc3Qgb25Tb3VyY2VDaGFuZ2UgPSAodmFsdWUpID0+IHtcbiAgICAgICAgdXBkYXRlQWxlcnRTdGF0ZSgnZGF0YWJhc2UnLCB2YWx1ZSB8fCBbXSk7XG4gICAgfTtcbiAgICBjb25zdCBvbkRhc2hib2FyZENoYW5nZSA9IChkYXNoYm9hcmQpID0+IHtcbiAgICAgICAgdXBkYXRlQWxlcnRTdGF0ZSgnZGFzaGJvYXJkJywgZGFzaGJvYXJkIHx8IHVuZGVmaW5lZCk7XG4gICAgICAgIHVwZGF0ZUFsZXJ0U3RhdGUoJ2NoYXJ0JywgbnVsbCk7XG4gICAgfTtcbiAgICBjb25zdCBvbkNoYXJ0Q2hhbmdlID0gKGNoYXJ0KSA9PiB7XG4gICAgICAgIGdldENoYXJ0VmlzdWFsaXphdGlvblR5cGUoY2hhcnQpO1xuICAgICAgICB1cGRhdGVBbGVydFN0YXRlKCdjaGFydCcsIGNoYXJ0IHx8IHVuZGVmaW5lZCk7XG4gICAgICAgIHVwZGF0ZUFsZXJ0U3RhdGUoJ2Rhc2hib2FyZCcsIG51bGwpO1xuICAgIH07XG4gICAgY29uc3Qgb25BY3RpdmVTd2l0Y2ggPSAoY2hlY2tlZCkgPT4ge1xuICAgICAgICB1cGRhdGVBbGVydFN0YXRlKCdhY3RpdmUnLCBjaGVja2VkKTtcbiAgICB9O1xuICAgIGNvbnN0IG9uQ29uZGl0aW9uQ2hhbmdlID0gKG9wKSA9PiB7XG4gICAgICAgIHNldENvbmRpdGlvbk5vdE51bGwob3AgPT09ICdub3QgbnVsbCcpO1xuICAgICAgICBjb25zdCBjb25maWcgPSB7XG4gICAgICAgICAgICBvcCxcbiAgICAgICAgICAgIHRocmVzaG9sZDogY3VycmVudEFsZXJ0XG4gICAgICAgICAgICAgICAgPyBjdXJyZW50QWxlcnQudmFsaWRhdG9yX2NvbmZpZ19qc29uPy50aHJlc2hvbGRcbiAgICAgICAgICAgICAgICA6IHVuZGVmaW5lZCxcbiAgICAgICAgfTtcbiAgICAgICAgdXBkYXRlQWxlcnRTdGF0ZSgndmFsaWRhdG9yX2NvbmZpZ19qc29uJywgY29uZmlnKTtcbiAgICB9O1xuICAgIGNvbnN0IG9uVGhyZXNob2xkQ2hhbmdlID0gKGV2ZW50KSA9PiB7XG4gICAgICAgIGNvbnN0IHsgdGFyZ2V0IH0gPSBldmVudDtcbiAgICAgICAgY29uc3QgY29uZmlnID0ge1xuICAgICAgICAgICAgb3A6IGN1cnJlbnRBbGVydCA/IGN1cnJlbnRBbGVydC52YWxpZGF0b3JfY29uZmlnX2pzb24/Lm9wIDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgdGhyZXNob2xkOiB0YXJnZXQudmFsdWUsXG4gICAgICAgIH07XG4gICAgICAgIHVwZGF0ZUFsZXJ0U3RhdGUoJ3ZhbGlkYXRvcl9jb25maWdfanNvbicsIGNvbmZpZyk7XG4gICAgfTtcbiAgICBjb25zdCBvbkxvZ1JldGVudGlvbkNoYW5nZSA9IChyZXRlbnRpb24pID0+IHtcbiAgICAgICAgdXBkYXRlQWxlcnRTdGF0ZSgnbG9nX3JldGVudGlvbicsIHJldGVudGlvbik7XG4gICAgfTtcbiAgICBjb25zdCBvblRpbWV6b25lQ2hhbmdlID0gKHRpbWV6b25lKSA9PiB7XG4gICAgICAgIHVwZGF0ZUFsZXJ0U3RhdGUoJ3RpbWV6b25lJywgdGltZXpvbmUpO1xuICAgIH07XG4gICAgY29uc3Qgb25Db250ZW50VHlwZUNoYW5nZSA9IChldmVudCkgPT4ge1xuICAgICAgICBjb25zdCB7IHRhcmdldCB9ID0gZXZlbnQ7XG4gICAgICAgIC8vIEdpdmVzIHRpbWUgdG8gY2xvc2UgdGhlIHNlbGVjdCBiZWZvcmUgY2hhbmdpbmcgdGhlIHR5cGVcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiBzZXRDb250ZW50VHlwZSh0YXJnZXQudmFsdWUpLCAyMDApO1xuICAgIH07XG4gICAgY29uc3Qgb25Gb3JtYXRDaGFuZ2UgPSAoZXZlbnQpID0+IHtcbiAgICAgICAgY29uc3QgeyB0YXJnZXQgfSA9IGV2ZW50O1xuICAgICAgICBzZXRSZXBvcnRGb3JtYXQodGFyZ2V0LnZhbHVlKTtcbiAgICB9O1xuICAgIC8vIE1ha2Ugc3VyZSBub3RpZmljYXRpb24gc2V0dGluZ3MgaGFzIHRoZSByZXF1aXJlZCBpbmZvXG4gICAgY29uc3QgY2hlY2tOb3RpZmljYXRpb25TZXR0aW5ncyA9ICgpID0+IHtcbiAgICAgICAgaWYgKCFub3RpZmljYXRpb25TZXR0aW5ncy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBsZXQgaGFzSW5mbyA9IGZhbHNlO1xuICAgICAgICBub3RpZmljYXRpb25TZXR0aW5ncy5mb3JFYWNoKHNldHRpbmcgPT4ge1xuICAgICAgICAgICAgaWYgKCEhc2V0dGluZy5tZXRob2QgJiYgc2V0dGluZy5yZWNpcGllbnRzPy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBoYXNJbmZvID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBoYXNJbmZvO1xuICAgIH07XG4gICAgY29uc3QgdmFsaWRhdGUgPSAoKSA9PiB7XG4gICAgICAgIGlmIChjdXJyZW50QWxlcnQgJiZcbiAgICAgICAgICAgIGN1cnJlbnRBbGVydC5uYW1lPy5sZW5ndGggJiZcbiAgICAgICAgICAgIGN1cnJlbnRBbGVydC5vd25lcnM/Lmxlbmd0aCAmJlxuICAgICAgICAgICAgY3VycmVudEFsZXJ0LmNyb250YWI/Lmxlbmd0aCAmJlxuICAgICAgICAgICAgY3VycmVudEFsZXJ0LndvcmtpbmdfdGltZW91dCAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICAoKGNvbnRlbnRUeXBlID09PSAnZGFzaGJvYXJkJyAmJiAhIWN1cnJlbnRBbGVydC5kYXNoYm9hcmQpIHx8XG4gICAgICAgICAgICAgICAgKGNvbnRlbnRUeXBlID09PSAnY2hhcnQnICYmICEhY3VycmVudEFsZXJ0LmNoYXJ0KSkgJiZcbiAgICAgICAgICAgIGNoZWNrTm90aWZpY2F0aW9uU2V0dGluZ3MoKSkge1xuICAgICAgICAgICAgaWYgKGlzUmVwb3J0KSB7XG4gICAgICAgICAgICAgICAgc2V0RGlzYWJsZVNhdmUoZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoISFjdXJyZW50QWxlcnQuZGF0YWJhc2UgJiZcbiAgICAgICAgICAgICAgICBjdXJyZW50QWxlcnQuc3FsPy5sZW5ndGggJiZcbiAgICAgICAgICAgICAgICAoY29uZGl0aW9uTm90TnVsbCB8fCAhIWN1cnJlbnRBbGVydC52YWxpZGF0b3JfY29uZmlnX2pzb24/Lm9wKSAmJlxuICAgICAgICAgICAgICAgIChjb25kaXRpb25Ob3ROdWxsIHx8XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRBbGVydC52YWxpZGF0b3JfY29uZmlnX2pzb24/LnRocmVzaG9sZCAhPT0gdW5kZWZpbmVkKSkge1xuICAgICAgICAgICAgICAgIHNldERpc2FibGVTYXZlKGZhbHNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHNldERpc2FibGVTYXZlKHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgc2V0RGlzYWJsZVNhdmUodHJ1ZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8vIEluaXRpYWxpemVcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBpZiAoaXNFZGl0TW9kZSAmJlxuICAgICAgICAgICAgKCFjdXJyZW50QWxlcnQ/LmlkIHx8IGFsZXJ0Py5pZCAhPT0gY3VycmVudEFsZXJ0LmlkIHx8IChpc0hpZGRlbiAmJiBzaG93KSkpIHtcbiAgICAgICAgICAgIGlmIChhbGVydCAmJiBhbGVydC5pZCAhPT0gbnVsbCAmJiAhbG9hZGluZyAmJiAhZmV0Y2hFcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnN0IGlkID0gYWxlcnQuaWQgfHwgMDtcbiAgICAgICAgICAgICAgICBmZXRjaFJlc291cmNlKGlkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICghaXNFZGl0TW9kZSAmJlxuICAgICAgICAgICAgKCFjdXJyZW50QWxlcnQgfHwgY3VycmVudEFsZXJ0LmlkIHx8IChpc0hpZGRlbiAmJiBzaG93KSkpIHtcbiAgICAgICAgICAgIHNldEN1cnJlbnRBbGVydCh7IC4uLkRFRkFVTFRfQUxFUlQgfSk7XG4gICAgICAgICAgICBzZXROb3RpZmljYXRpb25TZXR0aW5ncyhbXSk7XG4gICAgICAgICAgICBzZXROb3RpZmljYXRpb25BZGRTdGF0ZSgnYWN0aXZlJyk7XG4gICAgICAgIH1cbiAgICB9LCBbYWxlcnRdKTtcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBpZiAocmVzb3VyY2UpIHtcbiAgICAgICAgICAgIC8vIEFkZCBub3RpZmljYXRpb24gc2V0dGluZ3NcbiAgICAgICAgICAgIGNvbnN0IHNldHRpbmdzID0gKHJlc291cmNlLnJlY2lwaWVudHMgfHwgW10pLm1hcChzZXR0aW5nID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBjb25maWcgPSB0eXBlb2Ygc2V0dGluZy5yZWNpcGllbnRfY29uZmlnX2pzb24gPT09ICdzdHJpbmcnXG4gICAgICAgICAgICAgICAgICAgID8gSlNPTi5wYXJzZShzZXR0aW5nLnJlY2lwaWVudF9jb25maWdfanNvbilcbiAgICAgICAgICAgICAgICAgICAgOiB7fTtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6IHNldHRpbmcudHlwZSxcbiAgICAgICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZTogVHlwZSBub3QgYXNzaWduYWJsZVxuICAgICAgICAgICAgICAgICAgICByZWNpcGllbnRzOiBjb25maWcudGFyZ2V0IHx8IHNldHRpbmcucmVjaXBpZW50X2NvbmZpZ19qc29uLFxuICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiBhbGxvd2VkTm90aWZpY2F0aW9uTWV0aG9kcyxcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBzZXROb3RpZmljYXRpb25TZXR0aW5ncyhzZXR0aW5ncyk7XG4gICAgICAgICAgICBzZXROb3RpZmljYXRpb25BZGRTdGF0ZShzZXR0aW5ncy5sZW5ndGggPT09IGFsbG93ZWROb3RpZmljYXRpb25NZXRob2RzLmxlbmd0aFxuICAgICAgICAgICAgICAgID8gJ2hpZGRlbidcbiAgICAgICAgICAgICAgICA6ICdhY3RpdmUnKTtcbiAgICAgICAgICAgIHNldENvbnRlbnRUeXBlKHJlc291cmNlLmNoYXJ0ID8gJ2NoYXJ0JyA6ICdkYXNoYm9hcmQnKTtcbiAgICAgICAgICAgIHNldFJlcG9ydEZvcm1hdChyZXNvdXJjZS5jaGFydFxuICAgICAgICAgICAgICAgID8gcmVzb3VyY2UucmVwb3J0X2Zvcm1hdCB8fCBERUZBVUxUX05PVElGSUNBVElPTl9GT1JNQVRcbiAgICAgICAgICAgICAgICA6IERFRkFVTFRfTk9USUZJQ0FUSU9OX0ZPUk1BVCk7XG4gICAgICAgICAgICBjb25zdCB2YWxpZGF0b3JDb25maWcgPSB0eXBlb2YgcmVzb3VyY2UudmFsaWRhdG9yX2NvbmZpZ19qc29uID09PSAnc3RyaW5nJ1xuICAgICAgICAgICAgICAgID8gSlNPTi5wYXJzZShyZXNvdXJjZS52YWxpZGF0b3JfY29uZmlnX2pzb24pXG4gICAgICAgICAgICAgICAgOiByZXNvdXJjZS52YWxpZGF0b3JfY29uZmlnX2pzb247XG4gICAgICAgICAgICBzZXRDb25kaXRpb25Ob3ROdWxsKHJlc291cmNlLnZhbGlkYXRvcl90eXBlID09PSAnbm90IG51bGwnKTtcbiAgICAgICAgICAgIGlmIChyZXNvdXJjZS5jaGFydCkge1xuICAgICAgICAgICAgICAgIHNldENoYXJ0Vml6VHlwZShyZXNvdXJjZS5jaGFydC52aXpfdHlwZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzZXRDdXJyZW50QWxlcnQoe1xuICAgICAgICAgICAgICAgIC4uLnJlc291cmNlLFxuICAgICAgICAgICAgICAgIGNoYXJ0OiByZXNvdXJjZS5jaGFydFxuICAgICAgICAgICAgICAgICAgICA/IGdldENoYXJ0RGF0YShyZXNvdXJjZS5jaGFydCkgfHwge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHJlc291cmNlLmNoYXJ0LmlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6IHJlc291cmNlLmNoYXJ0LnNsaWNlX25hbWUsXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgZGFzaGJvYXJkOiByZXNvdXJjZS5kYXNoYm9hcmRcbiAgICAgICAgICAgICAgICAgICAgPyBnZXREYXNoYm9hcmREYXRhKHJlc291cmNlLmRhc2hib2FyZCkgfHwge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHJlc291cmNlLmRhc2hib2FyZC5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiByZXNvdXJjZS5kYXNoYm9hcmQuZGFzaGJvYXJkX3RpdGxlLFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIGRhdGFiYXNlOiByZXNvdXJjZS5kYXRhYmFzZVxuICAgICAgICAgICAgICAgICAgICA/IGdldFNvdXJjZURhdGEocmVzb3VyY2UuZGF0YWJhc2UpIHx8IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiByZXNvdXJjZS5kYXRhYmFzZS5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiByZXNvdXJjZS5kYXRhYmFzZS5kYXRhYmFzZV9uYW1lLFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIG93bmVyczogKHJlc291cmNlLm93bmVycyB8fCBbXSkubWFwKG93bmVyID0+ICh7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBvd25lci5pZCxcbiAgICAgICAgICAgICAgICAgICAgbGFiZWw6IGAke293bmVyLmZpcnN0X25hbWV9ICR7b3duZXIubGFzdF9uYW1lfWAsXG4gICAgICAgICAgICAgICAgfSkpLFxuICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmU6IFR5cGUgbm90IGFzc2lnbmFibGVcbiAgICAgICAgICAgICAgICB2YWxpZGF0b3JfY29uZmlnX2pzb246IHJlc291cmNlLnZhbGlkYXRvcl90eXBlID09PSAnbm90IG51bGwnXG4gICAgICAgICAgICAgICAgICAgID8ge1xuICAgICAgICAgICAgICAgICAgICAgICAgb3A6ICdub3QgbnVsbCcsXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgOiB2YWxpZGF0b3JDb25maWcsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0sIFtyZXNvdXJjZV0pO1xuICAgIC8vIFZhbGlkYXRpb25cbiAgICBjb25zdCBjdXJyZW50QWxlcnRTYWZlID0gY3VycmVudEFsZXJ0IHx8IHt9O1xuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIHZhbGlkYXRlKCk7XG4gICAgfSwgW1xuICAgICAgICBjdXJyZW50QWxlcnRTYWZlLm5hbWUsXG4gICAgICAgIGN1cnJlbnRBbGVydFNhZmUub3duZXJzLFxuICAgICAgICBjdXJyZW50QWxlcnRTYWZlLmRhdGFiYXNlLFxuICAgICAgICBjdXJyZW50QWxlcnRTYWZlLnNxbCxcbiAgICAgICAgY3VycmVudEFsZXJ0U2FmZS52YWxpZGF0b3JfY29uZmlnX2pzb24sXG4gICAgICAgIGN1cnJlbnRBbGVydFNhZmUuY3JvbnRhYixcbiAgICAgICAgY3VycmVudEFsZXJ0U2FmZS53b3JraW5nX3RpbWVvdXQsXG4gICAgICAgIGN1cnJlbnRBbGVydFNhZmUuZGFzaGJvYXJkLFxuICAgICAgICBjdXJyZW50QWxlcnRTYWZlLmNoYXJ0LFxuICAgICAgICBjb250ZW50VHlwZSxcbiAgICAgICAgbm90aWZpY2F0aW9uU2V0dGluZ3MsXG4gICAgICAgIGNvbmRpdGlvbk5vdE51bGwsXG4gICAgXSk7XG4gICAgLy8gU2hvdy9oaWRlXG4gICAgaWYgKGlzSGlkZGVuICYmIHNob3cpIHtcbiAgICAgICAgc2V0SXNIaWRkZW4oZmFsc2UpO1xuICAgIH1cbiAgICByZXR1cm4gKDxTdHlsZWRNb2RhbCBjbGFzc05hbWU9XCJuby1jb250ZW50LXBhZGRpbmdcIiByZXNwb25zaXZlIGRpc2FibGVQcmltYXJ5QnV0dG9uPXtkaXNhYmxlU2F2ZX0gb25IYW5kbGVkUHJpbWFyeUFjdGlvbj17b25TYXZlfSBvbkhpZGU9e2hpZGV9IHByaW1hcnlCdXR0b25OYW1lPXtpc0VkaXRNb2RlID8gdCgnU2F2ZScpIDogdCgnQWRkJyl9IHNob3c9e3Nob3d9IHdpZHRoPVwiMTAwJVwiIG1heFdpZHRoPVwiMTQ1MHB4XCIgdGl0bGU9ezxoNCBkYXRhLXRlc3Q9XCJhbGVydC1yZXBvcnQtbW9kYWwtdGl0bGVcIj5cbiAgICAgICAgICB7aXNFZGl0TW9kZSA/ICg8SWNvbnMuRWRpdEFsdCBjc3M9e1N0eWxlZEljb259Lz4pIDogKDxJY29ucy5QbHVzTGFyZ2UgY3NzPXtTdHlsZWRJY29ufS8+KX1cbiAgICAgICAgICB7aXNFZGl0TW9kZVxuICAgICAgICAgICAgICAgID8gdChgRWRpdCAke2lzUmVwb3J0ID8gJ1JlcG9ydCcgOiAnQWxlcnQnfWApXG4gICAgICAgICAgICAgICAgOiB0KGBBZGQgJHtpc1JlcG9ydCA/ICdSZXBvcnQnIDogJ0FsZXJ0J31gKX1cbiAgICAgICAgPC9oND59PlxuICAgICAgPFN0eWxlZFNlY3Rpb25Db250YWluZXI+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaGVhZGVyLXNlY3Rpb25cIj5cbiAgICAgICAgICA8U3R5bGVkSW5wdXRDb250YWluZXI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbnRyb2wtbGFiZWxcIj5cbiAgICAgICAgICAgICAge2lzUmVwb3J0ID8gdCgnUmVwb3J0IG5hbWUnKSA6IHQoJ0FsZXJ0IG5hbWUnKX1cbiAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwicmVxdWlyZWRcIj4qPC9zcGFuPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImlucHV0LWNvbnRhaW5lclwiPlxuICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cInRleHRcIiBuYW1lPVwibmFtZVwiIHZhbHVlPXtjdXJyZW50QWxlcnQgPyBjdXJyZW50QWxlcnQubmFtZSA6ICcnfSBwbGFjZWhvbGRlcj17aXNSZXBvcnQgPyB0KCdSZXBvcnQgbmFtZScpIDogdCgnQWxlcnQgbmFtZScpfSBvbkNoYW5nZT17b25UZXh0Q2hhbmdlfS8+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L1N0eWxlZElucHV0Q29udGFpbmVyPlxuICAgICAgICAgIDxTdHlsZWRJbnB1dENvbnRhaW5lcj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29udHJvbC1sYWJlbFwiPlxuICAgICAgICAgICAgICB7dCgnT3duZXJzJyl9XG4gICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInJlcXVpcmVkXCI+Kjwvc3Bhbj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGRpdiBkYXRhLXRlc3Q9XCJvd25lcnMtc2VsZWN0XCIgY2xhc3NOYW1lPVwiaW5wdXQtY29udGFpbmVyXCI+XG4gICAgICAgICAgICAgIDxTZWxlY3QgYXJpYUxhYmVsPXt0KCdPd25lcnMnKX0gYWxsb3dDbGVhciBuYW1lPVwib3duZXJzXCIgbW9kZT1cIm11bHRpcGxlXCIgdmFsdWU9e2N1cnJlbnRBbGVydD8ub3duZXJzIHx8IFtdfSBvcHRpb25zPXtsb2FkT3duZXJPcHRpb25zfSBvbkNoYW5nZT17b25Pd25lcnNDaGFuZ2V9Lz5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvU3R5bGVkSW5wdXRDb250YWluZXI+XG4gICAgICAgICAgPFN0eWxlZElucHV0Q29udGFpbmVyPlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb250cm9sLWxhYmVsXCI+e3QoJ0Rlc2NyaXB0aW9uJyl9PC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImlucHV0LWNvbnRhaW5lclwiPlxuICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cInRleHRcIiBuYW1lPVwiZGVzY3JpcHRpb25cIiB2YWx1ZT17Y3VycmVudEFsZXJ0ID8gY3VycmVudEFsZXJ0LmRlc2NyaXB0aW9uIHx8ICcnIDogJyd9IHBsYWNlaG9sZGVyPXt0KCdEZXNjcmlwdGlvbicpfSBvbkNoYW5nZT17b25UZXh0Q2hhbmdlfS8+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L1N0eWxlZElucHV0Q29udGFpbmVyPlxuICAgICAgICAgIDxTdHlsZWRTd2l0Y2hDb250YWluZXI+XG4gICAgICAgICAgICA8U3dpdGNoIG9uQ2hhbmdlPXtvbkFjdGl2ZVN3aXRjaH0gY2hlY2tlZD17Y3VycmVudEFsZXJ0ID8gY3VycmVudEFsZXJ0LmFjdGl2ZSA6IHRydWV9Lz5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3dpdGNoLWxhYmVsXCI+QWN0aXZlPC9kaXY+XG4gICAgICAgICAgPC9TdHlsZWRTd2l0Y2hDb250YWluZXI+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbHVtbi1zZWN0aW9uXCI+XG4gICAgICAgICAgeyFpc1JlcG9ydCAmJiAoPGRpdiBjbGFzc05hbWU9XCJjb2x1bW4gY29uZGl0aW9uXCI+XG4gICAgICAgICAgICAgIDxTdHlsZWRTZWN0aW9uVGl0bGU+XG4gICAgICAgICAgICAgICAgPGg0Pnt0KCdBbGVydCBjb25kaXRpb24nKX08L2g0PlxuICAgICAgICAgICAgICA8L1N0eWxlZFNlY3Rpb25UaXRsZT5cbiAgICAgICAgICAgICAgPFN0eWxlZElucHV0Q29udGFpbmVyPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29udHJvbC1sYWJlbFwiPlxuICAgICAgICAgICAgICAgICAge3QoJ0RhdGFiYXNlJyl9XG4gICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJyZXF1aXJlZFwiPio8L3NwYW4+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJpbnB1dC1jb250YWluZXJcIj5cbiAgICAgICAgICAgICAgICAgIDxTZWxlY3QgYXJpYUxhYmVsPXt0KCdEYXRhYmFzZScpfSBuYW1lPVwic291cmNlXCIgdmFsdWU9e2N1cnJlbnRBbGVydD8uZGF0YWJhc2U/LmxhYmVsICYmXG4gICAgICAgICAgICAgICAgY3VycmVudEFsZXJ0Py5kYXRhYmFzZT8udmFsdWVcbiAgICAgICAgICAgICAgICA/IHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGN1cnJlbnRBbGVydC5kYXRhYmFzZS52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgbGFiZWw6IGN1cnJlbnRBbGVydC5kYXRhYmFzZS5sYWJlbCxcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgOiB1bmRlZmluZWR9IG9wdGlvbnM9e2xvYWRTb3VyY2VPcHRpb25zfSBvbkNoYW5nZT17b25Tb3VyY2VDaGFuZ2V9Lz5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPC9TdHlsZWRJbnB1dENvbnRhaW5lcj5cbiAgICAgICAgICAgICAgPFN0eWxlZElucHV0Q29udGFpbmVyPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29udHJvbC1sYWJlbFwiPlxuICAgICAgICAgICAgICAgICAge3QoJ1NRTCBRdWVyeScpfVxuICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwicmVxdWlyZWRcIj4qPC9zcGFuPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDxUZXh0QXJlYUNvbnRyb2wgbmFtZT1cInNxbFwiIGxhbmd1YWdlPVwic3FsXCIgb2ZmZXJFZGl0SW5Nb2RhbD17ZmFsc2V9IG1pbkxpbmVzPXsxNX0gbWF4TGluZXM9ezE1fSBvbkNoYW5nZT17b25TUUxDaGFuZ2V9IHJlYWRPbmx5PXtmYWxzZX0gaW5pdGlhbFZhbHVlPXtyZXNvdXJjZT8uc3FsfSBrZXk9e2N1cnJlbnRBbGVydD8uaWR9Lz5cbiAgICAgICAgICAgICAgPC9TdHlsZWRJbnB1dENvbnRhaW5lcj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJpbmxpbmUtY29udGFpbmVyIHdyYXBcIj5cbiAgICAgICAgICAgICAgICA8U3R5bGVkSW5wdXRDb250YWluZXI+XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbnRyb2wtbGFiZWxcIj5cbiAgICAgICAgICAgICAgICAgICAge3QoJ1RyaWdnZXIgQWxlcnQgSWYuLi4nKX1cbiAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwicmVxdWlyZWRcIj4qPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImlucHV0LWNvbnRhaW5lclwiPlxuICAgICAgICAgICAgICAgICAgICA8U2VsZWN0IGFyaWFMYWJlbD17dCgnQ29uZGl0aW9uJyl9IG9uQ2hhbmdlPXtvbkNvbmRpdGlvbkNoYW5nZX0gcGxhY2Vob2xkZXI9XCJDb25kaXRpb25cIiB2YWx1ZT17Y3VycmVudEFsZXJ0Py52YWxpZGF0b3JfY29uZmlnX2pzb24/Lm9wIHx8IHVuZGVmaW5lZH0gb3B0aW9ucz17Q09ORElUSU9OU30vPlxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPC9TdHlsZWRJbnB1dENvbnRhaW5lcj5cbiAgICAgICAgICAgICAgICA8U3R5bGVkSW5wdXRDb250YWluZXI+XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbnRyb2wtbGFiZWxcIj5cbiAgICAgICAgICAgICAgICAgICAge3QoJ1ZhbHVlJyl9XG4gICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInJlcXVpcmVkXCI+Kjwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJpbnB1dC1jb250YWluZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJudW1iZXJcIiBuYW1lPVwidGhyZXNob2xkXCIgZGlzYWJsZWQ9e2NvbmRpdGlvbk5vdE51bGx9IHZhbHVlPXtjdXJyZW50QWxlcnQgJiZcbiAgICAgICAgICAgICAgICBjdXJyZW50QWxlcnQudmFsaWRhdG9yX2NvbmZpZ19qc29uICYmXG4gICAgICAgICAgICAgICAgY3VycmVudEFsZXJ0LnZhbGlkYXRvcl9jb25maWdfanNvbi50aHJlc2hvbGQgIT09XG4gICAgICAgICAgICAgICAgICAgIHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgID8gY3VycmVudEFsZXJ0LnZhbGlkYXRvcl9jb25maWdfanNvbi50aHJlc2hvbGRcbiAgICAgICAgICAgICAgICA6ICcnfSBwbGFjZWhvbGRlcj17dCgnVmFsdWUnKX0gb25DaGFuZ2U9e29uVGhyZXNob2xkQ2hhbmdlfS8+XG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8L1N0eWxlZElucHV0Q29udGFpbmVyPlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2Pil9XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb2x1bW4gc2NoZWR1bGVcIj5cbiAgICAgICAgICAgIDxTdHlsZWRTZWN0aW9uVGl0bGU+XG4gICAgICAgICAgICAgIDxoND5cbiAgICAgICAgICAgICAgICB7aXNSZXBvcnRcbiAgICAgICAgICAgID8gdCgnUmVwb3J0IHNjaGVkdWxlJylcbiAgICAgICAgICAgIDogdCgnQWxlcnQgY29uZGl0aW9uIHNjaGVkdWxlJyl9XG4gICAgICAgICAgICAgIDwvaDQ+XG4gICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInJlcXVpcmVkXCI+Kjwvc3Bhbj5cbiAgICAgICAgICAgIDwvU3R5bGVkU2VjdGlvblRpdGxlPlxuICAgICAgICAgICAgPEFsZXJ0UmVwb3J0Q3JvblNjaGVkdWxlciB2YWx1ZT17Y3VycmVudEFsZXJ0Py5jcm9udGFiIHx8IERFRkFVTFRfQ1JPTl9WQUxVRX0gb25DaGFuZ2U9e25ld1ZhbCA9PiB1cGRhdGVBbGVydFN0YXRlKCdjcm9udGFiJywgbmV3VmFsKX0vPlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb250cm9sLWxhYmVsXCI+e3QoJ1RpbWV6b25lJyl9PC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImlucHV0LWNvbnRhaW5lclwiIGNzcz17KHRoZW1lKSA9PiB0aW1lem9uZUhlYWRlclN0eWxlKHRoZW1lKX0+XG4gICAgICAgICAgICAgIDxUaW1lem9uZVNlbGVjdG9yIG9uVGltZXpvbmVDaGFuZ2U9e29uVGltZXpvbmVDaGFuZ2V9IHRpbWV6b25lPXtjdXJyZW50QWxlcnQ/LnRpbWV6b25lfS8+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDxTdHlsZWRTZWN0aW9uVGl0bGU+XG4gICAgICAgICAgICAgIDxoND57dCgnU2NoZWR1bGUgc2V0dGluZ3MnKX08L2g0PlxuICAgICAgICAgICAgPC9TdHlsZWRTZWN0aW9uVGl0bGU+XG4gICAgICAgICAgICA8U3R5bGVkSW5wdXRDb250YWluZXI+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29udHJvbC1sYWJlbFwiPlxuICAgICAgICAgICAgICAgIHt0KCdMb2cgcmV0ZW50aW9uJyl9XG4gICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwicmVxdWlyZWRcIj4qPC9zcGFuPlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJpbnB1dC1jb250YWluZXJcIj5cbiAgICAgICAgICAgICAgICA8U2VsZWN0IGFyaWFMYWJlbD17dCgnTG9nIHJldGVudGlvbicpfSBwbGFjZWhvbGRlcj17dCgnTG9nIHJldGVudGlvbicpfSBvbkNoYW5nZT17b25Mb2dSZXRlbnRpb25DaGFuZ2V9IHZhbHVlPXtjdXJyZW50QWxlcnQ/LmxvZ19yZXRlbnRpb24gfHwgREVGQVVMVF9SRVRFTlRJT059IG9wdGlvbnM9e1JFVEVOVElPTl9PUFRJT05TfS8+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9TdHlsZWRJbnB1dENvbnRhaW5lcj5cbiAgICAgICAgICAgIDxTdHlsZWRJbnB1dENvbnRhaW5lcj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb250cm9sLWxhYmVsXCI+XG4gICAgICAgICAgICAgICAge3QoJ1dvcmtpbmcgdGltZW91dCcpfVxuICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInJlcXVpcmVkXCI+Kjwvc3Bhbj5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaW5wdXQtY29udGFpbmVyXCI+XG4gICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJudW1iZXJcIiBtaW49XCIxXCIgbmFtZT1cIndvcmtpbmdfdGltZW91dFwiIHZhbHVlPXtjdXJyZW50QWxlcnQ/LndvcmtpbmdfdGltZW91dCB8fCAnJ30gcGxhY2Vob2xkZXI9e3QoJ1RpbWUgaW4gc2Vjb25kcycpfSBvbkNoYW5nZT17b25UaW1lb3V0VmVyaWZ5Q2hhbmdlfS8+XG4gICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwiaW5wdXQtbGFiZWxcIj5zZWNvbmRzPC9zcGFuPlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvU3R5bGVkSW5wdXRDb250YWluZXI+XG4gICAgICAgICAgICB7IWlzUmVwb3J0ICYmICg8U3R5bGVkSW5wdXRDb250YWluZXI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb250cm9sLWxhYmVsXCI+e3QoJ0dyYWNlIHBlcmlvZCcpfTwvZGl2PlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaW5wdXQtY29udGFpbmVyXCI+XG4gICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cIm51bWJlclwiIG1pbj1cIjFcIiBuYW1lPVwiZ3JhY2VfcGVyaW9kXCIgdmFsdWU9e2N1cnJlbnRBbGVydD8uZ3JhY2VfcGVyaW9kIHx8ICcnfSBwbGFjZWhvbGRlcj17dCgnVGltZSBpbiBzZWNvbmRzJyl9IG9uQ2hhbmdlPXtvblRpbWVvdXRWZXJpZnlDaGFuZ2V9Lz5cbiAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cImlucHV0LWxhYmVsXCI+c2Vjb25kczwvc3Bhbj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPC9TdHlsZWRJbnB1dENvbnRhaW5lcj4pfVxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29sdW1uIG1lc3NhZ2VcIj5cbiAgICAgICAgICAgIDxTdHlsZWRTZWN0aW9uVGl0bGU+XG4gICAgICAgICAgICAgIDxoND57dCgnTWVzc2FnZSBjb250ZW50Jyl9PC9oND5cbiAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwicmVxdWlyZWRcIj4qPC9zcGFuPlxuICAgICAgICAgICAgPC9TdHlsZWRTZWN0aW9uVGl0bGU+XG4gICAgICAgICAgICA8UmFkaW8uR3JvdXAgb25DaGFuZ2U9e29uQ29udGVudFR5cGVDaGFuZ2V9IHZhbHVlPXtjb250ZW50VHlwZX0+XG4gICAgICAgICAgICAgIDxTdHlsZWRSYWRpbyB2YWx1ZT1cImRhc2hib2FyZFwiPnt0KCdEYXNoYm9hcmQnKX08L1N0eWxlZFJhZGlvPlxuICAgICAgICAgICAgICA8U3R5bGVkUmFkaW8gdmFsdWU9XCJjaGFydFwiPnt0KCdDaGFydCcpfTwvU3R5bGVkUmFkaW8+XG4gICAgICAgICAgICA8L1JhZGlvLkdyb3VwPlxuICAgICAgICAgICAgPFNlbGVjdCBhcmlhTGFiZWw9e3QoJ0NoYXJ0Jyl9IGNzcz17e1xuICAgICAgICAgICAgZGlzcGxheTogY29udGVudFR5cGUgPT09ICdjaGFydCcgPyAnaW5saW5lJyA6ICdub25lJyxcbiAgICAgICAgfX0gbmFtZT1cImNoYXJ0XCIgdmFsdWU9e2N1cnJlbnRBbGVydD8uY2hhcnQ/LmxhYmVsICYmIGN1cnJlbnRBbGVydD8uY2hhcnQ/LnZhbHVlXG4gICAgICAgICAgICA/IHtcbiAgICAgICAgICAgICAgICB2YWx1ZTogY3VycmVudEFsZXJ0LmNoYXJ0LnZhbHVlLFxuICAgICAgICAgICAgICAgIGxhYmVsOiBjdXJyZW50QWxlcnQuY2hhcnQubGFiZWwsXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICA6IHVuZGVmaW5lZH0gb3B0aW9ucz17bG9hZENoYXJ0T3B0aW9uc30gb25DaGFuZ2U9e29uQ2hhcnRDaGFuZ2V9Lz5cbiAgICAgICAgICAgIDxTZWxlY3QgYXJpYUxhYmVsPXt0KCdEYXNoYm9hcmQnKX0gY3NzPXt7XG4gICAgICAgICAgICBkaXNwbGF5OiBjb250ZW50VHlwZSA9PT0gJ2Rhc2hib2FyZCcgPyAnaW5saW5lJyA6ICdub25lJyxcbiAgICAgICAgfX0gbmFtZT1cImRhc2hib2FyZFwiIHZhbHVlPXtjdXJyZW50QWxlcnQ/LmRhc2hib2FyZD8ubGFiZWwgJiYgY3VycmVudEFsZXJ0Py5kYXNoYm9hcmQ/LnZhbHVlXG4gICAgICAgICAgICA/IHtcbiAgICAgICAgICAgICAgICB2YWx1ZTogY3VycmVudEFsZXJ0LmRhc2hib2FyZC52YWx1ZSxcbiAgICAgICAgICAgICAgICBsYWJlbDogY3VycmVudEFsZXJ0LmRhc2hib2FyZC5sYWJlbCxcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIDogdW5kZWZpbmVkfSBvcHRpb25zPXtsb2FkRGFzaGJvYXJkT3B0aW9uc30gb25DaGFuZ2U9e29uRGFzaGJvYXJkQ2hhbmdlfS8+XG4gICAgICAgICAgICB7Zm9ybWF0T3B0aW9uRW5hYmxlZCAmJiAoPGRpdiBjbGFzc05hbWU9XCJpbmxpbmUtY29udGFpbmVyXCI+XG4gICAgICAgICAgICAgICAgPFN0eWxlZFJhZGlvR3JvdXAgb25DaGFuZ2U9e29uRm9ybWF0Q2hhbmdlfSB2YWx1ZT17cmVwb3J0Rm9ybWF0fT5cbiAgICAgICAgICAgICAgICAgIDxTdHlsZWRSYWRpbyB2YWx1ZT1cIlBOR1wiPnt0KCdTZW5kIGFzIFBORycpfTwvU3R5bGVkUmFkaW8+XG4gICAgICAgICAgICAgICAgICA8U3R5bGVkUmFkaW8gdmFsdWU9XCJDU1ZcIj57dCgnU2VuZCBhcyBDU1YnKX08L1N0eWxlZFJhZGlvPlxuICAgICAgICAgICAgICAgICAge1RFWFRfQkFTRURfVklTVUFMSVpBVElPTl9UWVBFUy5pbmNsdWRlcyhjaGFydFZpelR5cGUpICYmICg8U3R5bGVkUmFkaW8gdmFsdWU9XCJURVhUXCI+e3QoJ1NlbmQgYXMgdGV4dCcpfTwvU3R5bGVkUmFkaW8+KX1cbiAgICAgICAgICAgICAgICA8L1N0eWxlZFJhZGlvR3JvdXA+XG4gICAgICAgICAgICAgIDwvZGl2Pil9XG4gICAgICAgICAgICA8U3R5bGVkU2VjdGlvblRpdGxlPlxuICAgICAgICAgICAgICA8aDQ+e3QoJ05vdGlmaWNhdGlvbiBtZXRob2QnKX08L2g0PlxuICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJyZXF1aXJlZFwiPio8L3NwYW4+XG4gICAgICAgICAgICA8L1N0eWxlZFNlY3Rpb25UaXRsZT5cbiAgICAgICAgICAgIHtub3RpZmljYXRpb25TZXR0aW5ncy5tYXAoKG5vdGlmaWNhdGlvblNldHRpbmcsIGkpID0+ICg8Tm90aWZpY2F0aW9uTWV0aG9kIHNldHRpbmc9e25vdGlmaWNhdGlvblNldHRpbmd9IGluZGV4PXtpfSBrZXk9e2BOb3RpZmljYXRpb25NZXRob2QtJHtpfWB9IG9uVXBkYXRlPXt1cGRhdGVOb3RpZmljYXRpb25TZXR0aW5nfSBvblJlbW92ZT17cmVtb3ZlTm90aWZpY2F0aW9uU2V0dGluZ30vPikpfVxuICAgICAgICAgICAgPE5vdGlmaWNhdGlvbk1ldGhvZEFkZCBkYXRhLXRlc3Q9XCJub3RpZmljYXRpb24tYWRkXCIgc3RhdHVzPXtub3RpZmljYXRpb25BZGRTdGF0ZX0gb25DbGljaz17b25Ob3RpZmljYXRpb25BZGR9Lz5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L1N0eWxlZFNlY3Rpb25Db250YWluZXI+XG4gICAgPC9TdHlsZWRNb2RhbD4pO1xufTtcbmV4cG9ydCBkZWZhdWx0IHdpdGhUb2FzdHMoQWxlcnRSZXBvcnRNb2RhbCk7XG4iXX0= */\"),\n    name: \"chart\", value: currentAlert != null && (_currentAlert$chart2 = currentAlert.chart) != null && _currentAlert$chart2.label && currentAlert != null && (_currentAlert$chart3 = currentAlert.chart) != null && _currentAlert$chart3.value ?\n    {\n      value: currentAlert.chart.value,\n      label: currentAlert.chart.label } :\n\n    undefined, options: loadChartOptions, onChange: onChartChange }),\n  ___EmotionJSX(Select, { ariaLabel: t('Dashboard'), css: /*#__PURE__*/_css({\n      display: contentType === 'dashboard' ? 'inline' : 'none' }, process.env.NODE_ENV === \"production\" ? \"\" : \";label:AlertReportModal;\", process.env.NODE_ENV === \"production\" ? \"\" : \"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9zdXBlcnNldC1mcm9udGVuZC9zcmMvdmlld3MvQ1JVRC9hbGVydC9BbGVydFJlcG9ydE1vZGFsLnRzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFzNUIrQyIsImZpbGUiOiIvc3VwZXJzZXQtZnJvbnRlbmQvc3JjL3ZpZXdzL0NSVUQvYWxlcnQvQWxlcnRSZXBvcnRNb2RhbC50c3giLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRhdGlvbiAoQVNGKSB1bmRlciBvbmVcbiAqIG9yIG1vcmUgY29udHJpYnV0b3IgbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZVxuICogZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3JtYXRpb25cbiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGVcbiAqIHRvIHlvdSB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGVcbiAqIFwiTGljZW5zZVwiKTsgeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZVxuICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLFxuICogc29mdHdhcmUgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW5cbiAqIFwiQVMgSVNcIiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZXG4gKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZvciB0aGVcbiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnNcbiAqIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5pbXBvcnQgUmVhY3QsIHsgdXNlU3RhdGUsIHVzZUVmZmVjdCwgdXNlTWVtbywgdXNlQ2FsbGJhY2ssIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgc3R5bGVkLCB0LCBTdXBlcnNldENsaWVudCwgY3NzLCB9IGZyb20gJ0BzdXBlcnNldC11aS9jb3JlJztcbmltcG9ydCByaXNvbiBmcm9tICdyaXNvbic7XG5pbXBvcnQgeyB1c2VTaW5nbGVWaWV3UmVzb3VyY2UgfSBmcm9tICdzcmMvdmlld3MvQ1JVRC9ob29rcyc7XG5pbXBvcnQgSWNvbnMgZnJvbSAnc3JjL2NvbXBvbmVudHMvSWNvbnMnO1xuaW1wb3J0IHsgU3dpdGNoIH0gZnJvbSAnc3JjL2NvbXBvbmVudHMvU3dpdGNoJztcbmltcG9ydCBNb2RhbCBmcm9tICdzcmMvY29tcG9uZW50cy9Nb2RhbCc7XG5pbXBvcnQgVGltZXpvbmVTZWxlY3RvciBmcm9tICdzcmMvY29tcG9uZW50cy9UaW1lem9uZVNlbGVjdG9yJztcbmltcG9ydCB7IFJhZGlvIH0gZnJvbSAnc3JjL2NvbXBvbmVudHMvUmFkaW8nO1xuaW1wb3J0IHsgU2VsZWN0IH0gZnJvbSAnc3JjL2NvbXBvbmVudHMnO1xuaW1wb3J0IHsgRmVhdHVyZUZsYWcsIGlzRmVhdHVyZUVuYWJsZWQgfSBmcm9tICdzcmMvZmVhdHVyZUZsYWdzJztcbmltcG9ydCB3aXRoVG9hc3RzIGZyb20gJ3NyYy9jb21wb25lbnRzL01lc3NhZ2VUb2FzdHMvd2l0aFRvYXN0cyc7XG5pbXBvcnQgVGV4dEFyZWFDb250cm9sIGZyb20gJ3NyYy9leHBsb3JlL2NvbXBvbmVudHMvY29udHJvbHMvVGV4dEFyZWFDb250cm9sJztcbmltcG9ydCB7IHVzZUNvbW1vbkNvbmYgfSBmcm9tICdzcmMvdmlld3MvQ1JVRC9kYXRhL2RhdGFiYXNlL3N0YXRlJztcbmltcG9ydCB7IEFsZXJ0UmVwb3J0Q3JvblNjaGVkdWxlciB9IGZyb20gJy4vY29tcG9uZW50cy9BbGVydFJlcG9ydENyb25TY2hlZHVsZXInO1xuaW1wb3J0IHsgTm90aWZpY2F0aW9uTWV0aG9kIH0gZnJvbSAnLi9jb21wb25lbnRzL05vdGlmaWNhdGlvbk1ldGhvZCc7XG5jb25zdCBUSU1FT1VUX01JTiA9IDE7XG5jb25zdCBURVhUX0JBU0VEX1ZJU1VBTElaQVRJT05fVFlQRVMgPSBbXG4gICAgJ3Bpdm90X3RhYmxlJyxcbiAgICAncGl2b3RfdGFibGVfdjInLFxuICAgICd0YWJsZScsXG4gICAgJ3BhaXJlZF90dGVzdCcsXG5dO1xuY29uc3QgREVGQVVMVF9OT1RJRklDQVRJT05fTUVUSE9EUyA9IFsnRW1haWwnXTtcbmNvbnN0IERFRkFVTFRfTk9USUZJQ0FUSU9OX0ZPUk1BVCA9ICdQTkcnO1xuY29uc3QgQ09ORElUSU9OUyA9IFtcbiAgICB7XG4gICAgICAgIGxhYmVsOiB0KCc8IChTbWFsbGVyIHRoYW4pJyksXG4gICAgICAgIHZhbHVlOiAnPCcsXG4gICAgfSxcbiAgICB7XG4gICAgICAgIGxhYmVsOiB0KCc+IChMYXJnZXIgdGhhbiknKSxcbiAgICAgICAgdmFsdWU6ICc+JyxcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbGFiZWw6IHQoJzw9IChTbWFsbGVyIG9yIGVxdWFsKScpLFxuICAgICAgICB2YWx1ZTogJzw9JyxcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbGFiZWw6IHQoJz49IChMYXJnZXIgb3IgZXF1YWwpJyksXG4gICAgICAgIHZhbHVlOiAnPj0nLFxuICAgIH0sXG4gICAge1xuICAgICAgICBsYWJlbDogdCgnPT0gKElzIGVxdWFsKScpLFxuICAgICAgICB2YWx1ZTogJz09JyxcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbGFiZWw6IHQoJyE9IChJcyBub3QgZXF1YWwpJyksXG4gICAgICAgIHZhbHVlOiAnIT0nLFxuICAgIH0sXG4gICAge1xuICAgICAgICBsYWJlbDogdCgnTm90IG51bGwnKSxcbiAgICAgICAgdmFsdWU6ICdub3QgbnVsbCcsXG4gICAgfSxcbl07XG5jb25zdCBSRVRFTlRJT05fT1BUSU9OUyA9IFtcbiAgICB7XG4gICAgICAgIGxhYmVsOiB0KCdOb25lJyksXG4gICAgICAgIHZhbHVlOiAwLFxuICAgIH0sXG4gICAge1xuICAgICAgICBsYWJlbDogdCgnMzAgZGF5cycpLFxuICAgICAgICB2YWx1ZTogMzAsXG4gICAgfSxcbiAgICB7XG4gICAgICAgIGxhYmVsOiB0KCc2MCBkYXlzJyksXG4gICAgICAgIHZhbHVlOiA2MCxcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbGFiZWw6IHQoJzkwIGRheXMnKSxcbiAgICAgICAgdmFsdWU6IDkwLFxuICAgIH0sXG5dO1xuY29uc3QgREVGQVVMVF9SRVRFTlRJT04gPSA5MDtcbmNvbnN0IERFRkFVTFRfV09SS0lOR19USU1FT1VUID0gMzYwMDtcbmNvbnN0IERFRkFVTFRfQ1JPTl9WQUxVRSA9ICcwICogKiAqIConOyAvLyBldmVyeSBob3VyXG5jb25zdCBERUZBVUxUX0FMRVJUID0ge1xuICAgIGFjdGl2ZTogdHJ1ZSxcbiAgICBjcmVhdGlvbl9tZXRob2Q6ICdhbGVydHNfcmVwb3J0cycsXG4gICAgY3JvbnRhYjogREVGQVVMVF9DUk9OX1ZBTFVFLFxuICAgIGxvZ19yZXRlbnRpb246IERFRkFVTFRfUkVURU5USU9OLFxuICAgIHdvcmtpbmdfdGltZW91dDogREVGQVVMVF9XT1JLSU5HX1RJTUVPVVQsXG4gICAgbmFtZTogJycsXG4gICAgb3duZXJzOiBbXSxcbiAgICByZWNpcGllbnRzOiBbXSxcbiAgICBzcWw6ICcnLFxuICAgIHZhbGlkYXRvcl9jb25maWdfanNvbjoge30sXG4gICAgdmFsaWRhdG9yX3R5cGU6ICcnLFxuICAgIGdyYWNlX3BlcmlvZDogdW5kZWZpbmVkLFxufTtcbmNvbnN0IFN0eWxlZE1vZGFsID0gc3R5bGVkKE1vZGFsKSBgXG4gIC5hbnQtbW9kYWwtYm9keSB7XG4gICAgb3ZlcmZsb3c6IGluaXRpYWw7XG4gIH1cbmA7XG5jb25zdCBTdHlsZWRJY29uID0gKHRoZW1lKSA9PiBjc3MgYFxuICBtYXJnaW46IGF1dG8gJHt0aGVtZS5ncmlkVW5pdCAqIDJ9cHggYXV0byAwO1xuICBjb2xvcjogJHt0aGVtZS5jb2xvcnMuZ3JheXNjYWxlLmJhc2V9O1xuYDtcbmNvbnN0IFN0eWxlZFNlY3Rpb25Db250YWluZXIgPSBzdHlsZWQuZGl2IGBcbiAgZGlzcGxheTogZmxleDtcbiAgbWluLXdpZHRoOiAxMDAwcHg7XG4gIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG5cbiAgLmhlYWRlci1zZWN0aW9uIHtcbiAgICBkaXNwbGF5OiBmbGV4O1xuICAgIGZsZXg6IDAgMCBhdXRvO1xuICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgd2lkdGg6IDEwMCU7XG4gICAgcGFkZGluZzogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5ncmlkVW5pdCAqIDR9cHg7XG4gICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuY29sb3JzLmdyYXlzY2FsZS5saWdodDJ9O1xuICB9XG5cbiAgLmNvbHVtbi1zZWN0aW9uIHtcbiAgICBkaXNwbGF5OiBmbGV4O1xuICAgIGZsZXg6IDEgMSBhdXRvO1xuXG4gICAgLmNvbHVtbiB7XG4gICAgICBmbGV4OiAxIDEgYXV0bztcbiAgICAgIG1pbi13aWR0aDogY2FsYygzMy4zMyUgLSAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0ICogOH1weCk7XG4gICAgICBwYWRkaW5nOiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0ICogNH1weDtcblxuICAgICAgLmFzeW5jLXNlbGVjdCB7XG4gICAgICAgIG1hcmdpbjogMTBweCAwIDIwcHg7XG4gICAgICB9XG5cbiAgICAgICYuY29uZGl0aW9uIHtcbiAgICAgICAgYm9yZGVyLXJpZ2h0OiAxcHggc29saWQgJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5jb2xvcnMuZ3JheXNjYWxlLmxpZ2h0Mn07XG4gICAgICB9XG5cbiAgICAgICYubWVzc2FnZSB7XG4gICAgICAgIGJvcmRlci1sZWZ0OiAxcHggc29saWQgJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5jb2xvcnMuZ3JheXNjYWxlLmxpZ2h0Mn07XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLmlubGluZS1jb250YWluZXIge1xuICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgZmxleC1kaXJlY3Rpb246IHJvdztcbiAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgICYud3JhcCB7XG4gICAgICBmbGV4LXdyYXA6IHdyYXA7XG4gICAgfVxuXG4gICAgPiBkaXYge1xuICAgICAgZmxleDogMSAxIGF1dG87XG4gICAgfVxuXG4gICAgJi5hZGQtbWFyZ2luIHtcbiAgICAgIG1hcmdpbi1ib3R0b206IDVweDtcbiAgICB9XG5cbiAgICAuc3R5bGVkLWlucHV0IHtcbiAgICAgIG1hcmdpbjogMCAwIDAgMTBweDtcblxuICAgICAgaW5wdXQge1xuICAgICAgICBmbGV4OiAwIDAgYXV0bztcbiAgICAgIH1cbiAgICB9XG4gIH1cbmA7XG5jb25zdCBTdHlsZWRTZWN0aW9uVGl0bGUgPSBzdHlsZWQuZGl2IGBcbiAgZGlzcGxheTogZmxleDtcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgbWFyZ2luOiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0ICogMn1weCBhdXRvXG4gICAgJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5ncmlkVW5pdCAqIDR9cHggYXV0bztcblxuICBoNCB7XG4gICAgbWFyZ2luOiAwO1xuICB9XG5cbiAgLnJlcXVpcmVkIHtcbiAgICBtYXJnaW4tbGVmdDogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5ncmlkVW5pdH1weDtcbiAgICBjb2xvcjogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5jb2xvcnMuZXJyb3IuYmFzZX07XG4gIH1cbmA7XG5jb25zdCBTdHlsZWRTd2l0Y2hDb250YWluZXIgPSBzdHlsZWQuZGl2IGBcbiAgZGlzcGxheTogZmxleDtcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgbWFyZ2luLXRvcDogMTBweDtcblxuICAuc3dpdGNoLWxhYmVsIHtcbiAgICBtYXJnaW4tbGVmdDogMTBweDtcbiAgfVxuYDtcbmV4cG9ydCBjb25zdCBTdHlsZWRJbnB1dENvbnRhaW5lciA9IHN0eWxlZC5kaXYgYFxuICBmbGV4OiAxO1xuICBtYXJnaW46ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuZ3JpZFVuaXQgKiAyfXB4O1xuICBtYXJnaW4tdG9wOiAwO1xuXG4gIC5oZWxwZXIge1xuICAgIGRpc3BsYXk6IGJsb2NrO1xuICAgIGNvbG9yOiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmNvbG9ycy5ncmF5c2NhbGUuYmFzZX07XG4gICAgZm9udC1zaXplOiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLnR5cG9ncmFwaHkuc2l6ZXMucyAtIDF9cHg7XG4gICAgcGFkZGluZzogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5ncmlkVW5pdH1weCAwO1xuICAgIHRleHQtYWxpZ246IGxlZnQ7XG4gIH1cblxuICAucmVxdWlyZWQge1xuICAgIG1hcmdpbi1sZWZ0OiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0IC8gMn1weDtcbiAgICBjb2xvcjogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5jb2xvcnMuZXJyb3IuYmFzZX07XG4gIH1cblxuICAuaW5wdXQtY29udGFpbmVyIHtcbiAgICBkaXNwbGF5OiBmbGV4O1xuICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cbiAgICA+IGRpdiB7XG4gICAgICB3aWR0aDogMTAwJTtcbiAgICB9XG5cbiAgICBsYWJlbCB7XG4gICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgbWFyZ2luLXJpZ2h0OiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0ICogMn1weDtcbiAgICB9XG5cbiAgICBpIHtcbiAgICAgIG1hcmdpbjogMCAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0fXB4O1xuICAgIH1cbiAgfVxuXG4gIGlucHV0LFxuICB0ZXh0YXJlYSB7XG4gICAgZmxleDogMSAxIGF1dG87XG4gIH1cblxuICBpbnB1dFtkaXNhYmxlZF0ge1xuICAgIGNvbG9yOiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmNvbG9ycy5ncmF5c2NhbGUuYmFzZX07XG4gIH1cblxuICB0ZXh0YXJlYSB7XG4gICAgaGVpZ2h0OiAzMDBweDtcbiAgICByZXNpemU6IG5vbmU7XG4gIH1cblxuICBpbnB1dDo6cGxhY2Vob2xkZXIsXG4gIHRleHRhcmVhOjpwbGFjZWhvbGRlciB7XG4gICAgY29sb3I6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuY29sb3JzLmdyYXlzY2FsZS5saWdodDF9O1xuICB9XG5cbiAgdGV4dGFyZWEsXG4gIGlucHV0W3R5cGU9J3RleHQnXSxcbiAgaW5wdXRbdHlwZT0nbnVtYmVyJ10ge1xuICAgIHBhZGRpbmc6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuZ3JpZFVuaXR9cHhcbiAgICAgICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuZ3JpZFVuaXQgKiAyfXB4O1xuICAgIGJvcmRlci1zdHlsZTogbm9uZTtcbiAgICBib3JkZXI6IDFweCBzb2xpZCAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmNvbG9ycy5ncmF5c2NhbGUubGlnaHQyfTtcbiAgICBib3JkZXItcmFkaXVzOiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0fXB4O1xuXG4gICAgJltuYW1lPSdkZXNjcmlwdGlvbiddIHtcbiAgICAgIGZsZXg6IDEgMSBhdXRvO1xuICAgIH1cbiAgfVxuXG4gIC5pbnB1dC1sYWJlbCB7XG4gICAgbWFyZ2luLWxlZnQ6IDEwcHg7XG4gIH1cbmA7XG5jb25zdCBTdHlsZWRSYWRpbyA9IHN0eWxlZChSYWRpbykgYFxuICBkaXNwbGF5OiBibG9jaztcbiAgbGluZS1oZWlnaHQ6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuZ3JpZFVuaXQgKiA3fXB4O1xuYDtcbmNvbnN0IFN0eWxlZFJhZGlvR3JvdXAgPSBzdHlsZWQoUmFkaW8uR3JvdXApIGBcbiAgbWFyZ2luLWxlZnQ6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuZ3JpZFVuaXQgKiA1LjV9cHg7XG5gO1xuLy8gTm90aWZpY2F0aW9uIE1ldGhvZCBjb21wb25lbnRzXG5jb25zdCBTdHlsZWROb3RpZmljYXRpb25BZGRCdXR0b24gPSBzdHlsZWQuZGl2IGBcbiAgY29sb3I6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuY29sb3JzLnByaW1hcnkuZGFyazF9O1xuICBjdXJzb3I6IHBvaW50ZXI7XG5cbiAgaSB7XG4gICAgbWFyZ2luLXJpZ2h0OiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0ICogMn1weDtcbiAgfVxuXG4gICYuZGlzYWJsZWQge1xuICAgIGNvbG9yOiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmNvbG9ycy5ncmF5c2NhbGUubGlnaHQxfTtcbiAgICBjdXJzb3I6IGRlZmF1bHQ7XG4gIH1cbmA7XG5jb25zdCB0aW1lem9uZUhlYWRlclN0eWxlID0gKHRoZW1lKSA9PiBjc3MgYFxuICBtYXJnaW46ICR7dGhlbWUuZ3JpZFVuaXQgKiAzfXB4IDA7XG5gO1xuY29uc3QgTm90aWZpY2F0aW9uTWV0aG9kQWRkID0gKHsgc3RhdHVzID0gJ2FjdGl2ZScsIG9uQ2xpY2ssIH0pID0+IHtcbiAgICBpZiAoc3RhdHVzID09PSAnaGlkZGVuJykge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgY29uc3QgY2hlY2tTdGF0dXMgPSAoKSA9PiB7XG4gICAgICAgIGlmIChzdGF0dXMgIT09ICdkaXNhYmxlZCcpIHtcbiAgICAgICAgICAgIG9uQ2xpY2soKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuICg8U3R5bGVkTm90aWZpY2F0aW9uQWRkQnV0dG9uIGNsYXNzTmFtZT17c3RhdHVzfSBvbkNsaWNrPXtjaGVja1N0YXR1c30+XG4gICAgICA8aSBjbGFzc05hbWU9XCJmYSBmYS1wbHVzXCIvPnsnICd9XG4gICAgICB7c3RhdHVzID09PSAnYWN0aXZlJ1xuICAgICAgICAgICAgPyB0KCdBZGQgbm90aWZpY2F0aW9uIG1ldGhvZCcpXG4gICAgICAgICAgICA6IHQoJ0FkZCBkZWxpdmVyeSBtZXRob2QnKX1cbiAgICA8L1N0eWxlZE5vdGlmaWNhdGlvbkFkZEJ1dHRvbj4pO1xufTtcbmNvbnN0IEFsZXJ0UmVwb3J0TW9kYWwgPSAoeyBhZGREYW5nZXJUb2FzdCwgb25BZGQsIG9uSGlkZSwgc2hvdywgYWxlcnQgPSBudWxsLCBpc1JlcG9ydCA9IGZhbHNlLCB9KSA9PiB7XG4gICAgY29uc3QgY29uZiA9IHVzZUNvbW1vbkNvbmYoKTtcbiAgICBjb25zdCBhbGxvd2VkTm90aWZpY2F0aW9uTWV0aG9kcyA9IGNvbmY/LkFMRVJUX1JFUE9SVFNfTk9USUZJQ0FUSU9OX01FVEhPRFMgfHwgREVGQVVMVF9OT1RJRklDQVRJT05fTUVUSE9EUztcbiAgICBjb25zdCBbZGlzYWJsZVNhdmUsIHNldERpc2FibGVTYXZlXSA9IHVzZVN0YXRlKHRydWUpO1xuICAgIGNvbnN0IFtjdXJyZW50QWxlcnQsIHNldEN1cnJlbnRBbGVydCxdID0gdXNlU3RhdGUoKTtcbiAgICBjb25zdCBbaXNIaWRkZW4sIHNldElzSGlkZGVuXSA9IHVzZVN0YXRlKHRydWUpO1xuICAgIGNvbnN0IFtjb250ZW50VHlwZSwgc2V0Q29udGVudFR5cGVdID0gdXNlU3RhdGUoJ2Rhc2hib2FyZCcpO1xuICAgIGNvbnN0IFtyZXBvcnRGb3JtYXQsIHNldFJlcG9ydEZvcm1hdF0gPSB1c2VTdGF0ZShERUZBVUxUX05PVElGSUNBVElPTl9GT1JNQVQpO1xuICAgIC8vIERyb3Bkb3duIG9wdGlvbnNcbiAgICBjb25zdCBbY29uZGl0aW9uTm90TnVsbCwgc2V0Q29uZGl0aW9uTm90TnVsbF0gPSB1c2VTdGF0ZShmYWxzZSk7XG4gICAgY29uc3QgW3NvdXJjZU9wdGlvbnMsIHNldFNvdXJjZU9wdGlvbnNdID0gdXNlU3RhdGUoW10pO1xuICAgIGNvbnN0IFtkYXNoYm9hcmRPcHRpb25zLCBzZXREYXNoYm9hcmRPcHRpb25zXSA9IHVzZVN0YXRlKFtdKTtcbiAgICBjb25zdCBbY2hhcnRPcHRpb25zLCBzZXRDaGFydE9wdGlvbnNdID0gdXNlU3RhdGUoW10pO1xuICAgIC8vIENoYXJ0IG1ldGFkYXRhXG4gICAgY29uc3QgW2NoYXJ0Vml6VHlwZSwgc2V0Q2hhcnRWaXpUeXBlXSA9IHVzZVN0YXRlKCcnKTtcbiAgICBjb25zdCBpc0VkaXRNb2RlID0gYWxlcnQgIT09IG51bGw7XG4gICAgY29uc3QgZm9ybWF0T3B0aW9uRW5hYmxlZCA9IGNvbnRlbnRUeXBlID09PSAnY2hhcnQnICYmXG4gICAgICAgIChpc0ZlYXR1cmVFbmFibGVkKEZlYXR1cmVGbGFnLkFMRVJUU19BVFRBQ0hfUkVQT1JUUykgfHwgaXNSZXBvcnQpO1xuICAgIGNvbnN0IFtub3RpZmljYXRpb25BZGRTdGF0ZSwgc2V0Tm90aWZpY2F0aW9uQWRkU3RhdGUsXSA9IHVzZVN0YXRlKCdhY3RpdmUnKTtcbiAgICBjb25zdCBbbm90aWZpY2F0aW9uU2V0dGluZ3MsIHNldE5vdGlmaWNhdGlvblNldHRpbmdzXSA9IHVzZVN0YXRlKFtdKTtcbiAgICBjb25zdCBvbk5vdGlmaWNhdGlvbkFkZCA9ICgpID0+IHtcbiAgICAgICAgY29uc3Qgc2V0dGluZ3MgPSBub3RpZmljYXRpb25TZXR0aW5ncy5zbGljZSgpO1xuICAgICAgICBzZXR0aW5ncy5wdXNoKHtcbiAgICAgICAgICAgIHJlY2lwaWVudHM6ICcnLFxuICAgICAgICAgICAgb3B0aW9uczogYWxsb3dlZE5vdGlmaWNhdGlvbk1ldGhvZHMsXG4gICAgICAgIH0pO1xuICAgICAgICBzZXROb3RpZmljYXRpb25TZXR0aW5ncyhzZXR0aW5ncyk7XG4gICAgICAgIHNldE5vdGlmaWNhdGlvbkFkZFN0YXRlKHNldHRpbmdzLmxlbmd0aCA9PT0gYWxsb3dlZE5vdGlmaWNhdGlvbk1ldGhvZHMubGVuZ3RoXG4gICAgICAgICAgICA/ICdoaWRkZW4nXG4gICAgICAgICAgICA6ICdkaXNhYmxlZCcpO1xuICAgIH07XG4gICAgY29uc3QgdXBkYXRlTm90aWZpY2F0aW9uU2V0dGluZyA9IChpbmRleCwgc2V0dGluZykgPT4ge1xuICAgICAgICBjb25zdCBzZXR0aW5ncyA9IG5vdGlmaWNhdGlvblNldHRpbmdzLnNsaWNlKCk7XG4gICAgICAgIHNldHRpbmdzW2luZGV4XSA9IHNldHRpbmc7XG4gICAgICAgIHNldE5vdGlmaWNhdGlvblNldHRpbmdzKHNldHRpbmdzKTtcbiAgICAgICAgaWYgKHNldHRpbmcubWV0aG9kICE9PSB1bmRlZmluZWQgJiYgbm90aWZpY2F0aW9uQWRkU3RhdGUgIT09ICdoaWRkZW4nKSB7XG4gICAgICAgICAgICBzZXROb3RpZmljYXRpb25BZGRTdGF0ZSgnYWN0aXZlJyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNvbnN0IHJlbW92ZU5vdGlmaWNhdGlvblNldHRpbmcgPSAoaW5kZXgpID0+IHtcbiAgICAgICAgY29uc3Qgc2V0dGluZ3MgPSBub3RpZmljYXRpb25TZXR0aW5ncy5zbGljZSgpO1xuICAgICAgICBzZXR0aW5ncy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICBzZXROb3RpZmljYXRpb25TZXR0aW5ncyhzZXR0aW5ncyk7XG4gICAgICAgIHNldE5vdGlmaWNhdGlvbkFkZFN0YXRlKCdhY3RpdmUnKTtcbiAgICB9O1xuICAgIC8vIEFsZXJ0IGZldGNoIGxvZ2ljXG4gICAgY29uc3QgeyBzdGF0ZTogeyBsb2FkaW5nLCByZXNvdXJjZSwgZXJyb3I6IGZldGNoRXJyb3IgfSwgZmV0Y2hSZXNvdXJjZSwgY3JlYXRlUmVzb3VyY2UsIHVwZGF0ZVJlc291cmNlLCBjbGVhckVycm9yLCB9ID0gdXNlU2luZ2xlVmlld1Jlc291cmNlKCdyZXBvcnQnLCB0KCdyZXBvcnQnKSwgYWRkRGFuZ2VyVG9hc3QpO1xuICAgIC8vIEZ1bmN0aW9uc1xuICAgIGNvbnN0IGhpZGUgPSAoKSA9PiB7XG4gICAgICAgIGNsZWFyRXJyb3IoKTtcbiAgICAgICAgc2V0SXNIaWRkZW4odHJ1ZSk7XG4gICAgICAgIG9uSGlkZSgpO1xuICAgICAgICBzZXROb3RpZmljYXRpb25TZXR0aW5ncyhbXSk7XG4gICAgICAgIHNldEN1cnJlbnRBbGVydCh7IC4uLkRFRkFVTFRfQUxFUlQgfSk7XG4gICAgICAgIHNldE5vdGlmaWNhdGlvbkFkZFN0YXRlKCdhY3RpdmUnKTtcbiAgICB9O1xuICAgIGNvbnN0IG9uU2F2ZSA9ICgpID0+IHtcbiAgICAgICAgLy8gTm90aWZpY2F0aW9uIFNldHRpbmdzXG4gICAgICAgIGNvbnN0IHJlY2lwaWVudHMgPSBbXTtcbiAgICAgICAgbm90aWZpY2F0aW9uU2V0dGluZ3MuZm9yRWFjaChzZXR0aW5nID0+IHtcbiAgICAgICAgICAgIGlmIChzZXR0aW5nLm1ldGhvZCAmJiBzZXR0aW5nLnJlY2lwaWVudHMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcmVjaXBpZW50cy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50X2NvbmZpZ19qc29uOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6IHNldHRpbmcucmVjaXBpZW50cyxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogc2V0dGluZy5tZXRob2QsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBkYXRhID0ge1xuICAgICAgICAgICAgLi4uY3VycmVudEFsZXJ0LFxuICAgICAgICAgICAgdHlwZTogaXNSZXBvcnQgPyAnUmVwb3J0JyA6ICdBbGVydCcsXG4gICAgICAgICAgICB2YWxpZGF0b3JfdHlwZTogY29uZGl0aW9uTm90TnVsbCA/ICdub3QgbnVsbCcgOiAnb3BlcmF0b3InLFxuICAgICAgICAgICAgdmFsaWRhdG9yX2NvbmZpZ19qc29uOiBjb25kaXRpb25Ob3ROdWxsXG4gICAgICAgICAgICAgICAgPyB7fVxuICAgICAgICAgICAgICAgIDogY3VycmVudEFsZXJ0Py52YWxpZGF0b3JfY29uZmlnX2pzb24sXG4gICAgICAgICAgICBjaGFydDogY29udGVudFR5cGUgPT09ICdjaGFydCcgPyBjdXJyZW50QWxlcnQ/LmNoYXJ0Py52YWx1ZSA6IG51bGwsXG4gICAgICAgICAgICBkYXNoYm9hcmQ6IGNvbnRlbnRUeXBlID09PSAnZGFzaGJvYXJkJyA/IGN1cnJlbnRBbGVydD8uZGFzaGJvYXJkPy52YWx1ZSA6IG51bGwsXG4gICAgICAgICAgICBkYXRhYmFzZTogY3VycmVudEFsZXJ0Py5kYXRhYmFzZT8udmFsdWUsXG4gICAgICAgICAgICBvd25lcnM6IChjdXJyZW50QWxlcnQ/Lm93bmVycyB8fCBbXSkubWFwKG93bmVyID0+IG93bmVyLnZhbHVlKSxcbiAgICAgICAgICAgIHJlY2lwaWVudHMsXG4gICAgICAgICAgICByZXBvcnRfZm9ybWF0OiBjb250ZW50VHlwZSA9PT0gJ2Rhc2hib2FyZCdcbiAgICAgICAgICAgICAgICA/IERFRkFVTFRfTk9USUZJQ0FUSU9OX0ZPUk1BVFxuICAgICAgICAgICAgICAgIDogcmVwb3J0Rm9ybWF0IHx8IERFRkFVTFRfTk9USUZJQ0FUSU9OX0ZPUk1BVCxcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKGRhdGEucmVjaXBpZW50cyAmJiAhZGF0YS5yZWNpcGllbnRzLmxlbmd0aCkge1xuICAgICAgICAgICAgZGVsZXRlIGRhdGEucmVjaXBpZW50cztcbiAgICAgICAgfVxuICAgICAgICBkYXRhLmNvbnRleHRfbWFya2Rvd24gPSAnc3RyaW5nJztcbiAgICAgICAgaWYgKGlzRWRpdE1vZGUpIHtcbiAgICAgICAgICAgIC8vIEVkaXRcbiAgICAgICAgICAgIGlmIChjdXJyZW50QWxlcnQgJiYgY3VycmVudEFsZXJ0LmlkKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdXBkYXRlX2lkID0gY3VycmVudEFsZXJ0LmlkO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSBkYXRhLmlkO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSBkYXRhLmNyZWF0ZWRfYnk7XG4gICAgICAgICAgICAgICAgZGVsZXRlIGRhdGEubGFzdF9ldmFsX2R0dG07XG4gICAgICAgICAgICAgICAgZGVsZXRlIGRhdGEubGFzdF9zdGF0ZTtcbiAgICAgICAgICAgICAgICBkZWxldGUgZGF0YS5sYXN0X3ZhbHVlO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSBkYXRhLmxhc3RfdmFsdWVfcm93X2pzb247XG4gICAgICAgICAgICAgICAgdXBkYXRlUmVzb3VyY2UodXBkYXRlX2lkLCBkYXRhKS50aGVuKHJlc3BvbnNlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChvbkFkZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgb25BZGQoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBoaWRlKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoY3VycmVudEFsZXJ0KSB7XG4gICAgICAgICAgICAvLyBDcmVhdGVcbiAgICAgICAgICAgIGNyZWF0ZVJlc291cmNlKGRhdGEpLnRoZW4ocmVzcG9uc2UgPT4ge1xuICAgICAgICAgICAgICAgIGlmICghcmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAob25BZGQpIHtcbiAgICAgICAgICAgICAgICAgICAgb25BZGQocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBoaWRlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLy8gRmV0Y2ggZGF0YSB0byBwb3B1bGF0ZSBmb3JtIGRyb3Bkb3duc1xuICAgIGNvbnN0IGxvYWRPd25lck9wdGlvbnMgPSB1c2VNZW1vKCgpID0+IChpbnB1dCA9ICcnLCBwYWdlLCBwYWdlU2l6ZSkgPT4ge1xuICAgICAgICBjb25zdCBxdWVyeSA9IHJpc29uLmVuY29kZSh7IGZpbHRlcjogaW5wdXQsIHBhZ2UsIHBhZ2Vfc2l6ZTogcGFnZVNpemUgfSk7XG4gICAgICAgIHJldHVybiBTdXBlcnNldENsaWVudC5nZXQoe1xuICAgICAgICAgICAgZW5kcG9pbnQ6IGAvYXBpL3YxL3JlcG9ydC9yZWxhdGVkL293bmVycz9xPSR7cXVlcnl9YCxcbiAgICAgICAgfSkudGhlbihyZXNwb25zZSA9PiAoe1xuICAgICAgICAgICAgZGF0YTogcmVzcG9uc2UuanNvbi5yZXN1bHQubWFwKChpdGVtKSA9PiAoe1xuICAgICAgICAgICAgICAgIHZhbHVlOiBpdGVtLnZhbHVlLFxuICAgICAgICAgICAgICAgIGxhYmVsOiBpdGVtLnRleHQsXG4gICAgICAgICAgICB9KSksXG4gICAgICAgICAgICB0b3RhbENvdW50OiByZXNwb25zZS5qc29uLmNvdW50LFxuICAgICAgICB9KSk7XG4gICAgfSwgW10pO1xuICAgIGNvbnN0IGdldFNvdXJjZURhdGEgPSB1c2VDYWxsYmFjaygoZGIpID0+IHtcbiAgICAgICAgY29uc3QgZGF0YWJhc2UgPSBkYiB8fCBjdXJyZW50QWxlcnQ/LmRhdGFiYXNlO1xuICAgICAgICBpZiAoIWRhdGFiYXNlIHx8IGRhdGFiYXNlLmxhYmVsKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBsZXQgcmVzdWx0O1xuICAgICAgICAvLyBDeWNsZSB0aHJvdWdoIHNvdXJjZSBvcHRpb25zIHRvIGZpbmQgdGhlIHNlbGVjdGVkIG9wdGlvblxuICAgICAgICBzb3VyY2VPcHRpb25zLmZvckVhY2goc291cmNlID0+IHtcbiAgICAgICAgICAgIGlmIChzb3VyY2UudmFsdWUgPT09IGRhdGFiYXNlLnZhbHVlIHx8IHNvdXJjZS52YWx1ZSA9PT0gZGF0YWJhc2UuaWQpIHtcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBzb3VyY2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0sIFtjdXJyZW50QWxlcnQ/LmRhdGFiYXNlLCBzb3VyY2VPcHRpb25zXSk7XG4gICAgLy8gVXBkYXRpbmcgYWxlcnQvcmVwb3J0IHN0YXRlXG4gICAgY29uc3QgdXBkYXRlQWxlcnRTdGF0ZSA9IChuYW1lLCB2YWx1ZSkgPT4ge1xuICAgICAgICBzZXRDdXJyZW50QWxlcnQoY3VycmVudEFsZXJ0RGF0YSA9PiAoe1xuICAgICAgICAgICAgLi4uY3VycmVudEFsZXJ0RGF0YSxcbiAgICAgICAgICAgIFtuYW1lXTogdmFsdWUsXG4gICAgICAgIH0pKTtcbiAgICB9O1xuICAgIGNvbnN0IGxvYWRTb3VyY2VPcHRpb25zID0gdXNlTWVtbygoKSA9PiAoaW5wdXQgPSAnJywgcGFnZSwgcGFnZVNpemUpID0+IHtcbiAgICAgICAgY29uc3QgcXVlcnkgPSByaXNvbi5lbmNvZGUoeyBmaWx0ZXI6IGlucHV0LCBwYWdlLCBwYWdlX3NpemU6IHBhZ2VTaXplIH0pO1xuICAgICAgICByZXR1cm4gU3VwZXJzZXRDbGllbnQuZ2V0KHtcbiAgICAgICAgICAgIGVuZHBvaW50OiBgL2FwaS92MS9yZXBvcnQvcmVsYXRlZC9kYXRhYmFzZT9xPSR7cXVlcnl9YCxcbiAgICAgICAgfSkudGhlbihyZXNwb25zZSA9PiB7XG4gICAgICAgICAgICBjb25zdCBsaXN0ID0gcmVzcG9uc2UuanNvbi5yZXN1bHQubWFwKChpdGVtKSA9PiAoe1xuICAgICAgICAgICAgICAgIHZhbHVlOiBpdGVtLnZhbHVlLFxuICAgICAgICAgICAgICAgIGxhYmVsOiBpdGVtLnRleHQsXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICBzZXRTb3VyY2VPcHRpb25zKGxpc3QpO1xuICAgICAgICAgICAgcmV0dXJuIHsgZGF0YTogbGlzdCwgdG90YWxDb3VudDogcmVzcG9uc2UuanNvbi5jb3VudCB9O1xuICAgICAgICB9KTtcbiAgICB9LCBbXSk7XG4gICAgY29uc3QgZGF0YWJhc2VMYWJlbCA9IGN1cnJlbnRBbGVydCAmJiBjdXJyZW50QWxlcnQuZGF0YWJhc2UgJiYgIWN1cnJlbnRBbGVydC5kYXRhYmFzZS5sYWJlbDtcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICAvLyBGaW5kIHNvdXJjZSBpZiBjdXJyZW50IGFsZXJ0IGhhcyBvbmUgc2V0XG4gICAgICAgIGlmIChkYXRhYmFzZUxhYmVsKSB7XG4gICAgICAgICAgICB1cGRhdGVBbGVydFN0YXRlKCdkYXRhYmFzZScsIGdldFNvdXJjZURhdGEoKSk7XG4gICAgICAgIH1cbiAgICB9LCBbZGF0YWJhc2VMYWJlbCwgZ2V0U291cmNlRGF0YV0pO1xuICAgIGNvbnN0IGxvYWREYXNoYm9hcmRPcHRpb25zID0gdXNlTWVtbygoKSA9PiAoaW5wdXQgPSAnJywgcGFnZSwgcGFnZVNpemUpID0+IHtcbiAgICAgICAgY29uc3QgcXVlcnkgPSByaXNvbi5lbmNvZGUoeyBmaWx0ZXI6IGlucHV0LCBwYWdlLCBwYWdlX3NpemU6IHBhZ2VTaXplIH0pO1xuICAgICAgICByZXR1cm4gU3VwZXJzZXRDbGllbnQuZ2V0KHtcbiAgICAgICAgICAgIGVuZHBvaW50OiBgL2FwaS92MS9yZXBvcnQvcmVsYXRlZC9kYXNoYm9hcmQ/cT0ke3F1ZXJ5fWAsXG4gICAgICAgIH0pLnRoZW4ocmVzcG9uc2UgPT4ge1xuICAgICAgICAgICAgY29uc3QgbGlzdCA9IHJlc3BvbnNlLmpzb24ucmVzdWx0Lm1hcCgoaXRlbSkgPT4gKHtcbiAgICAgICAgICAgICAgICB2YWx1ZTogaXRlbS52YWx1ZSxcbiAgICAgICAgICAgICAgICBsYWJlbDogaXRlbS50ZXh0LFxuICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgc2V0RGFzaGJvYXJkT3B0aW9ucyhsaXN0KTtcbiAgICAgICAgICAgIHJldHVybiB7IGRhdGE6IGxpc3QsIHRvdGFsQ291bnQ6IHJlc3BvbnNlLmpzb24uY291bnQgfTtcbiAgICAgICAgfSk7XG4gICAgfSwgW10pO1xuICAgIGNvbnN0IGdldERhc2hib2FyZERhdGEgPSAoZGIpID0+IHtcbiAgICAgICAgY29uc3QgZGFzaGJvYXJkID0gZGIgfHwgY3VycmVudEFsZXJ0Py5kYXNoYm9hcmQ7XG4gICAgICAgIGlmICghZGFzaGJvYXJkIHx8IGRhc2hib2FyZC5sYWJlbCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IHJlc3VsdDtcbiAgICAgICAgLy8gQ3ljbGUgdGhyb3VnaCBkYXNoYm9hcmQgb3B0aW9ucyB0byBmaW5kIHRoZSBzZWxlY3RlZCBvcHRpb25cbiAgICAgICAgZGFzaGJvYXJkT3B0aW9ucy5mb3JFYWNoKGRhc2ggPT4ge1xuICAgICAgICAgICAgaWYgKGRhc2gudmFsdWUgPT09IGRhc2hib2FyZC52YWx1ZSB8fCBkYXNoLnZhbHVlID09PSBkYXNoYm9hcmQuaWQpIHtcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBkYXNoO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIGNvbnN0IGdldENoYXJ0RGF0YSA9IHVzZUNhbGxiYWNrKChjaGFydERhdGEpID0+IHtcbiAgICAgICAgY29uc3QgY2hhcnQgPSBjaGFydERhdGEgfHwgY3VycmVudEFsZXJ0Py5jaGFydDtcbiAgICAgICAgaWYgKCFjaGFydCB8fCBjaGFydC5sYWJlbCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IHJlc3VsdDtcbiAgICAgICAgLy8gQ3ljbGUgdGhyb3VnaCBjaGFydCBvcHRpb25zIHRvIGZpbmQgdGhlIHNlbGVjdGVkIG9wdGlvblxuICAgICAgICBjaGFydE9wdGlvbnMuZm9yRWFjaChzbGljZSA9PiB7XG4gICAgICAgICAgICBpZiAoc2xpY2UudmFsdWUgPT09IGNoYXJ0LnZhbHVlIHx8IHNsaWNlLnZhbHVlID09PSBjaGFydC5pZCkge1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHNsaWNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9LCBbY2hhcnRPcHRpb25zLCBjdXJyZW50QWxlcnQ/LmNoYXJ0XSk7XG4gICAgY29uc3Qgbm9DaGFydExhYmVsID0gY3VycmVudEFsZXJ0ICYmIGN1cnJlbnRBbGVydC5jaGFydCAmJiAhY3VycmVudEFsZXJ0LmNoYXJ0LmxhYmVsO1xuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIC8vIEZpbmQgc291cmNlIGlmIGN1cnJlbnQgYWxlcnQgaGFzIG9uZSBzZXRcbiAgICAgICAgaWYgKG5vQ2hhcnRMYWJlbCkge1xuICAgICAgICAgICAgdXBkYXRlQWxlcnRTdGF0ZSgnY2hhcnQnLCBnZXRDaGFydERhdGEoKSk7XG4gICAgICAgIH1cbiAgICB9LCBbZ2V0Q2hhcnREYXRhLCBub0NoYXJ0TGFiZWxdKTtcbiAgICBjb25zdCBsb2FkQ2hhcnRPcHRpb25zID0gdXNlTWVtbygoKSA9PiAoaW5wdXQgPSAnJywgcGFnZSwgcGFnZVNpemUpID0+IHtcbiAgICAgICAgY29uc3QgcXVlcnkgPSByaXNvbi5lbmNvZGUoeyBmaWx0ZXI6IGlucHV0LCBwYWdlLCBwYWdlX3NpemU6IHBhZ2VTaXplIH0pO1xuICAgICAgICByZXR1cm4gU3VwZXJzZXRDbGllbnQuZ2V0KHtcbiAgICAgICAgICAgIGVuZHBvaW50OiBgL2FwaS92MS9yZXBvcnQvcmVsYXRlZC9jaGFydD9xPSR7cXVlcnl9YCxcbiAgICAgICAgfSkudGhlbihyZXNwb25zZSA9PiB7XG4gICAgICAgICAgICBjb25zdCBsaXN0ID0gcmVzcG9uc2UuanNvbi5yZXN1bHQubWFwKChpdGVtKSA9PiAoe1xuICAgICAgICAgICAgICAgIHZhbHVlOiBpdGVtLnZhbHVlLFxuICAgICAgICAgICAgICAgIGxhYmVsOiBpdGVtLnRleHQsXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICBzZXRDaGFydE9wdGlvbnMobGlzdCk7XG4gICAgICAgICAgICByZXR1cm4geyBkYXRhOiBsaXN0LCB0b3RhbENvdW50OiByZXNwb25zZS5qc29uLmNvdW50IH07XG4gICAgICAgIH0pO1xuICAgIH0sIFtdKTtcbiAgICBjb25zdCBnZXRDaGFydFZpc3VhbGl6YXRpb25UeXBlID0gKGNoYXJ0KSA9PiBTdXBlcnNldENsaWVudC5nZXQoe1xuICAgICAgICBlbmRwb2ludDogYC9hcGkvdjEvY2hhcnQvJHtjaGFydC52YWx1ZX1gLFxuICAgIH0pLnRoZW4ocmVzcG9uc2UgPT4gc2V0Q2hhcnRWaXpUeXBlKHJlc3BvbnNlLmpzb24ucmVzdWx0LnZpel90eXBlKSk7XG4gICAgLy8gSGFuZGxlIGlucHV0L3RleHRhcmVhIHVwZGF0ZXNcbiAgICBjb25zdCBvblRleHRDaGFuZ2UgPSAoZXZlbnQpID0+IHtcbiAgICAgICAgY29uc3QgeyB0YXJnZXQgfSA9IGV2ZW50O1xuICAgICAgICB1cGRhdGVBbGVydFN0YXRlKHRhcmdldC5uYW1lLCB0YXJnZXQudmFsdWUpO1xuICAgIH07XG4gICAgY29uc3Qgb25UaW1lb3V0VmVyaWZ5Q2hhbmdlID0gKGV2ZW50KSA9PiB7XG4gICAgICAgIGNvbnN0IHsgdGFyZ2V0IH0gPSBldmVudDtcbiAgICAgICAgY29uc3QgdmFsdWUgPSArdGFyZ2V0LnZhbHVlO1xuICAgICAgICAvLyBOZWVkIHRvIG1ha2Ugc3VyZSBncmFjZSBwZXJpb2QgaXMgbm90IGxvd2VyIHRoYW4gVElNRU9VVF9NSU5cbiAgICAgICAgaWYgKHZhbHVlID09PSAwKSB7XG4gICAgICAgICAgICB1cGRhdGVBbGVydFN0YXRlKHRhcmdldC5uYW1lLCBudWxsKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHVwZGF0ZUFsZXJ0U3RhdGUodGFyZ2V0Lm5hbWUsIHZhbHVlID8gTWF0aC5tYXgodmFsdWUsIFRJTUVPVVRfTUlOKSA6IHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgY29uc3Qgb25TUUxDaGFuZ2UgPSAodmFsdWUpID0+IHtcbiAgICAgICAgdXBkYXRlQWxlcnRTdGF0ZSgnc3FsJywgdmFsdWUgfHwgJycpO1xuICAgIH07XG4gICAgY29uc3Qgb25Pd25lcnNDaGFuZ2UgPSAodmFsdWUpID0+IHtcbiAgICAgICAgdXBkYXRlQWxlcnRTdGF0ZSgnb3duZXJzJywgdmFsdWUgfHwgW10pO1xuICAgIH07XG4gICAgY29uc3Qgb25Tb3VyY2VDaGFuZ2UgPSAodmFsdWUpID0+IHtcbiAgICAgICAgdXBkYXRlQWxlcnRTdGF0ZSgnZGF0YWJhc2UnLCB2YWx1ZSB8fCBbXSk7XG4gICAgfTtcbiAgICBjb25zdCBvbkRhc2hib2FyZENoYW5nZSA9IChkYXNoYm9hcmQpID0+IHtcbiAgICAgICAgdXBkYXRlQWxlcnRTdGF0ZSgnZGFzaGJvYXJkJywgZGFzaGJvYXJkIHx8IHVuZGVmaW5lZCk7XG4gICAgICAgIHVwZGF0ZUFsZXJ0U3RhdGUoJ2NoYXJ0JywgbnVsbCk7XG4gICAgfTtcbiAgICBjb25zdCBvbkNoYXJ0Q2hhbmdlID0gKGNoYXJ0KSA9PiB7XG4gICAgICAgIGdldENoYXJ0VmlzdWFsaXphdGlvblR5cGUoY2hhcnQpO1xuICAgICAgICB1cGRhdGVBbGVydFN0YXRlKCdjaGFydCcsIGNoYXJ0IHx8IHVuZGVmaW5lZCk7XG4gICAgICAgIHVwZGF0ZUFsZXJ0U3RhdGUoJ2Rhc2hib2FyZCcsIG51bGwpO1xuICAgIH07XG4gICAgY29uc3Qgb25BY3RpdmVTd2l0Y2ggPSAoY2hlY2tlZCkgPT4ge1xuICAgICAgICB1cGRhdGVBbGVydFN0YXRlKCdhY3RpdmUnLCBjaGVja2VkKTtcbiAgICB9O1xuICAgIGNvbnN0IG9uQ29uZGl0aW9uQ2hhbmdlID0gKG9wKSA9PiB7XG4gICAgICAgIHNldENvbmRpdGlvbk5vdE51bGwob3AgPT09ICdub3QgbnVsbCcpO1xuICAgICAgICBjb25zdCBjb25maWcgPSB7XG4gICAgICAgICAgICBvcCxcbiAgICAgICAgICAgIHRocmVzaG9sZDogY3VycmVudEFsZXJ0XG4gICAgICAgICAgICAgICAgPyBjdXJyZW50QWxlcnQudmFsaWRhdG9yX2NvbmZpZ19qc29uPy50aHJlc2hvbGRcbiAgICAgICAgICAgICAgICA6IHVuZGVmaW5lZCxcbiAgICAgICAgfTtcbiAgICAgICAgdXBkYXRlQWxlcnRTdGF0ZSgndmFsaWRhdG9yX2NvbmZpZ19qc29uJywgY29uZmlnKTtcbiAgICB9O1xuICAgIGNvbnN0IG9uVGhyZXNob2xkQ2hhbmdlID0gKGV2ZW50KSA9PiB7XG4gICAgICAgIGNvbnN0IHsgdGFyZ2V0IH0gPSBldmVudDtcbiAgICAgICAgY29uc3QgY29uZmlnID0ge1xuICAgICAgICAgICAgb3A6IGN1cnJlbnRBbGVydCA/IGN1cnJlbnRBbGVydC52YWxpZGF0b3JfY29uZmlnX2pzb24/Lm9wIDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgdGhyZXNob2xkOiB0YXJnZXQudmFsdWUsXG4gICAgICAgIH07XG4gICAgICAgIHVwZGF0ZUFsZXJ0U3RhdGUoJ3ZhbGlkYXRvcl9jb25maWdfanNvbicsIGNvbmZpZyk7XG4gICAgfTtcbiAgICBjb25zdCBvbkxvZ1JldGVudGlvbkNoYW5nZSA9IChyZXRlbnRpb24pID0+IHtcbiAgICAgICAgdXBkYXRlQWxlcnRTdGF0ZSgnbG9nX3JldGVudGlvbicsIHJldGVudGlvbik7XG4gICAgfTtcbiAgICBjb25zdCBvblRpbWV6b25lQ2hhbmdlID0gKHRpbWV6b25lKSA9PiB7XG4gICAgICAgIHVwZGF0ZUFsZXJ0U3RhdGUoJ3RpbWV6b25lJywgdGltZXpvbmUpO1xuICAgIH07XG4gICAgY29uc3Qgb25Db250ZW50VHlwZUNoYW5nZSA9IChldmVudCkgPT4ge1xuICAgICAgICBjb25zdCB7IHRhcmdldCB9ID0gZXZlbnQ7XG4gICAgICAgIC8vIEdpdmVzIHRpbWUgdG8gY2xvc2UgdGhlIHNlbGVjdCBiZWZvcmUgY2hhbmdpbmcgdGhlIHR5cGVcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiBzZXRDb250ZW50VHlwZSh0YXJnZXQudmFsdWUpLCAyMDApO1xuICAgIH07XG4gICAgY29uc3Qgb25Gb3JtYXRDaGFuZ2UgPSAoZXZlbnQpID0+IHtcbiAgICAgICAgY29uc3QgeyB0YXJnZXQgfSA9IGV2ZW50O1xuICAgICAgICBzZXRSZXBvcnRGb3JtYXQodGFyZ2V0LnZhbHVlKTtcbiAgICB9O1xuICAgIC8vIE1ha2Ugc3VyZSBub3RpZmljYXRpb24gc2V0dGluZ3MgaGFzIHRoZSByZXF1aXJlZCBpbmZvXG4gICAgY29uc3QgY2hlY2tOb3RpZmljYXRpb25TZXR0aW5ncyA9ICgpID0+IHtcbiAgICAgICAgaWYgKCFub3RpZmljYXRpb25TZXR0aW5ncy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBsZXQgaGFzSW5mbyA9IGZhbHNlO1xuICAgICAgICBub3RpZmljYXRpb25TZXR0aW5ncy5mb3JFYWNoKHNldHRpbmcgPT4ge1xuICAgICAgICAgICAgaWYgKCEhc2V0dGluZy5tZXRob2QgJiYgc2V0dGluZy5yZWNpcGllbnRzPy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBoYXNJbmZvID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBoYXNJbmZvO1xuICAgIH07XG4gICAgY29uc3QgdmFsaWRhdGUgPSAoKSA9PiB7XG4gICAgICAgIGlmIChjdXJyZW50QWxlcnQgJiZcbiAgICAgICAgICAgIGN1cnJlbnRBbGVydC5uYW1lPy5sZW5ndGggJiZcbiAgICAgICAgICAgIGN1cnJlbnRBbGVydC5vd25lcnM/Lmxlbmd0aCAmJlxuICAgICAgICAgICAgY3VycmVudEFsZXJ0LmNyb250YWI/Lmxlbmd0aCAmJlxuICAgICAgICAgICAgY3VycmVudEFsZXJ0LndvcmtpbmdfdGltZW91dCAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICAoKGNvbnRlbnRUeXBlID09PSAnZGFzaGJvYXJkJyAmJiAhIWN1cnJlbnRBbGVydC5kYXNoYm9hcmQpIHx8XG4gICAgICAgICAgICAgICAgKGNvbnRlbnRUeXBlID09PSAnY2hhcnQnICYmICEhY3VycmVudEFsZXJ0LmNoYXJ0KSkgJiZcbiAgICAgICAgICAgIGNoZWNrTm90aWZpY2F0aW9uU2V0dGluZ3MoKSkge1xuICAgICAgICAgICAgaWYgKGlzUmVwb3J0KSB7XG4gICAgICAgICAgICAgICAgc2V0RGlzYWJsZVNhdmUoZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoISFjdXJyZW50QWxlcnQuZGF0YWJhc2UgJiZcbiAgICAgICAgICAgICAgICBjdXJyZW50QWxlcnQuc3FsPy5sZW5ndGggJiZcbiAgICAgICAgICAgICAgICAoY29uZGl0aW9uTm90TnVsbCB8fCAhIWN1cnJlbnRBbGVydC52YWxpZGF0b3JfY29uZmlnX2pzb24/Lm9wKSAmJlxuICAgICAgICAgICAgICAgIChjb25kaXRpb25Ob3ROdWxsIHx8XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRBbGVydC52YWxpZGF0b3JfY29uZmlnX2pzb24/LnRocmVzaG9sZCAhPT0gdW5kZWZpbmVkKSkge1xuICAgICAgICAgICAgICAgIHNldERpc2FibGVTYXZlKGZhbHNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHNldERpc2FibGVTYXZlKHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgc2V0RGlzYWJsZVNhdmUodHJ1ZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8vIEluaXRpYWxpemVcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBpZiAoaXNFZGl0TW9kZSAmJlxuICAgICAgICAgICAgKCFjdXJyZW50QWxlcnQ/LmlkIHx8IGFsZXJ0Py5pZCAhPT0gY3VycmVudEFsZXJ0LmlkIHx8IChpc0hpZGRlbiAmJiBzaG93KSkpIHtcbiAgICAgICAgICAgIGlmIChhbGVydCAmJiBhbGVydC5pZCAhPT0gbnVsbCAmJiAhbG9hZGluZyAmJiAhZmV0Y2hFcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnN0IGlkID0gYWxlcnQuaWQgfHwgMDtcbiAgICAgICAgICAgICAgICBmZXRjaFJlc291cmNlKGlkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICghaXNFZGl0TW9kZSAmJlxuICAgICAgICAgICAgKCFjdXJyZW50QWxlcnQgfHwgY3VycmVudEFsZXJ0LmlkIHx8IChpc0hpZGRlbiAmJiBzaG93KSkpIHtcbiAgICAgICAgICAgIHNldEN1cnJlbnRBbGVydCh7IC4uLkRFRkFVTFRfQUxFUlQgfSk7XG4gICAgICAgICAgICBzZXROb3RpZmljYXRpb25TZXR0aW5ncyhbXSk7XG4gICAgICAgICAgICBzZXROb3RpZmljYXRpb25BZGRTdGF0ZSgnYWN0aXZlJyk7XG4gICAgICAgIH1cbiAgICB9LCBbYWxlcnRdKTtcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBpZiAocmVzb3VyY2UpIHtcbiAgICAgICAgICAgIC8vIEFkZCBub3RpZmljYXRpb24gc2V0dGluZ3NcbiAgICAgICAgICAgIGNvbnN0IHNldHRpbmdzID0gKHJlc291cmNlLnJlY2lwaWVudHMgfHwgW10pLm1hcChzZXR0aW5nID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBjb25maWcgPSB0eXBlb2Ygc2V0dGluZy5yZWNpcGllbnRfY29uZmlnX2pzb24gPT09ICdzdHJpbmcnXG4gICAgICAgICAgICAgICAgICAgID8gSlNPTi5wYXJzZShzZXR0aW5nLnJlY2lwaWVudF9jb25maWdfanNvbilcbiAgICAgICAgICAgICAgICAgICAgOiB7fTtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6IHNldHRpbmcudHlwZSxcbiAgICAgICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZTogVHlwZSBub3QgYXNzaWduYWJsZVxuICAgICAgICAgICAgICAgICAgICByZWNpcGllbnRzOiBjb25maWcudGFyZ2V0IHx8IHNldHRpbmcucmVjaXBpZW50X2NvbmZpZ19qc29uLFxuICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiBhbGxvd2VkTm90aWZpY2F0aW9uTWV0aG9kcyxcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBzZXROb3RpZmljYXRpb25TZXR0aW5ncyhzZXR0aW5ncyk7XG4gICAgICAgICAgICBzZXROb3RpZmljYXRpb25BZGRTdGF0ZShzZXR0aW5ncy5sZW5ndGggPT09IGFsbG93ZWROb3RpZmljYXRpb25NZXRob2RzLmxlbmd0aFxuICAgICAgICAgICAgICAgID8gJ2hpZGRlbidcbiAgICAgICAgICAgICAgICA6ICdhY3RpdmUnKTtcbiAgICAgICAgICAgIHNldENvbnRlbnRUeXBlKHJlc291cmNlLmNoYXJ0ID8gJ2NoYXJ0JyA6ICdkYXNoYm9hcmQnKTtcbiAgICAgICAgICAgIHNldFJlcG9ydEZvcm1hdChyZXNvdXJjZS5jaGFydFxuICAgICAgICAgICAgICAgID8gcmVzb3VyY2UucmVwb3J0X2Zvcm1hdCB8fCBERUZBVUxUX05PVElGSUNBVElPTl9GT1JNQVRcbiAgICAgICAgICAgICAgICA6IERFRkFVTFRfTk9USUZJQ0FUSU9OX0ZPUk1BVCk7XG4gICAgICAgICAgICBjb25zdCB2YWxpZGF0b3JDb25maWcgPSB0eXBlb2YgcmVzb3VyY2UudmFsaWRhdG9yX2NvbmZpZ19qc29uID09PSAnc3RyaW5nJ1xuICAgICAgICAgICAgICAgID8gSlNPTi5wYXJzZShyZXNvdXJjZS52YWxpZGF0b3JfY29uZmlnX2pzb24pXG4gICAgICAgICAgICAgICAgOiByZXNvdXJjZS52YWxpZGF0b3JfY29uZmlnX2pzb247XG4gICAgICAgICAgICBzZXRDb25kaXRpb25Ob3ROdWxsKHJlc291cmNlLnZhbGlkYXRvcl90eXBlID09PSAnbm90IG51bGwnKTtcbiAgICAgICAgICAgIGlmIChyZXNvdXJjZS5jaGFydCkge1xuICAgICAgICAgICAgICAgIHNldENoYXJ0Vml6VHlwZShyZXNvdXJjZS5jaGFydC52aXpfdHlwZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzZXRDdXJyZW50QWxlcnQoe1xuICAgICAgICAgICAgICAgIC4uLnJlc291cmNlLFxuICAgICAgICAgICAgICAgIGNoYXJ0OiByZXNvdXJjZS5jaGFydFxuICAgICAgICAgICAgICAgICAgICA/IGdldENoYXJ0RGF0YShyZXNvdXJjZS5jaGFydCkgfHwge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHJlc291cmNlLmNoYXJ0LmlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6IHJlc291cmNlLmNoYXJ0LnNsaWNlX25hbWUsXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgZGFzaGJvYXJkOiByZXNvdXJjZS5kYXNoYm9hcmRcbiAgICAgICAgICAgICAgICAgICAgPyBnZXREYXNoYm9hcmREYXRhKHJlc291cmNlLmRhc2hib2FyZCkgfHwge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHJlc291cmNlLmRhc2hib2FyZC5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiByZXNvdXJjZS5kYXNoYm9hcmQuZGFzaGJvYXJkX3RpdGxlLFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIGRhdGFiYXNlOiByZXNvdXJjZS5kYXRhYmFzZVxuICAgICAgICAgICAgICAgICAgICA/IGdldFNvdXJjZURhdGEocmVzb3VyY2UuZGF0YWJhc2UpIHx8IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiByZXNvdXJjZS5kYXRhYmFzZS5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiByZXNvdXJjZS5kYXRhYmFzZS5kYXRhYmFzZV9uYW1lLFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIG93bmVyczogKHJlc291cmNlLm93bmVycyB8fCBbXSkubWFwKG93bmVyID0+ICh7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBvd25lci5pZCxcbiAgICAgICAgICAgICAgICAgICAgbGFiZWw6IGAke293bmVyLmZpcnN0X25hbWV9ICR7b3duZXIubGFzdF9uYW1lfWAsXG4gICAgICAgICAgICAgICAgfSkpLFxuICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmU6IFR5cGUgbm90IGFzc2lnbmFibGVcbiAgICAgICAgICAgICAgICB2YWxpZGF0b3JfY29uZmlnX2pzb246IHJlc291cmNlLnZhbGlkYXRvcl90eXBlID09PSAnbm90IG51bGwnXG4gICAgICAgICAgICAgICAgICAgID8ge1xuICAgICAgICAgICAgICAgICAgICAgICAgb3A6ICdub3QgbnVsbCcsXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgOiB2YWxpZGF0b3JDb25maWcsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0sIFtyZXNvdXJjZV0pO1xuICAgIC8vIFZhbGlkYXRpb25cbiAgICBjb25zdCBjdXJyZW50QWxlcnRTYWZlID0gY3VycmVudEFsZXJ0IHx8IHt9O1xuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIHZhbGlkYXRlKCk7XG4gICAgfSwgW1xuICAgICAgICBjdXJyZW50QWxlcnRTYWZlLm5hbWUsXG4gICAgICAgIGN1cnJlbnRBbGVydFNhZmUub3duZXJzLFxuICAgICAgICBjdXJyZW50QWxlcnRTYWZlLmRhdGFiYXNlLFxuICAgICAgICBjdXJyZW50QWxlcnRTYWZlLnNxbCxcbiAgICAgICAgY3VycmVudEFsZXJ0U2FmZS52YWxpZGF0b3JfY29uZmlnX2pzb24sXG4gICAgICAgIGN1cnJlbnRBbGVydFNhZmUuY3JvbnRhYixcbiAgICAgICAgY3VycmVudEFsZXJ0U2FmZS53b3JraW5nX3RpbWVvdXQsXG4gICAgICAgIGN1cnJlbnRBbGVydFNhZmUuZGFzaGJvYXJkLFxuICAgICAgICBjdXJyZW50QWxlcnRTYWZlLmNoYXJ0LFxuICAgICAgICBjb250ZW50VHlwZSxcbiAgICAgICAgbm90aWZpY2F0aW9uU2V0dGluZ3MsXG4gICAgICAgIGNvbmRpdGlvbk5vdE51bGwsXG4gICAgXSk7XG4gICAgLy8gU2hvdy9oaWRlXG4gICAgaWYgKGlzSGlkZGVuICYmIHNob3cpIHtcbiAgICAgICAgc2V0SXNIaWRkZW4oZmFsc2UpO1xuICAgIH1cbiAgICByZXR1cm4gKDxTdHlsZWRNb2RhbCBjbGFzc05hbWU9XCJuby1jb250ZW50LXBhZGRpbmdcIiByZXNwb25zaXZlIGRpc2FibGVQcmltYXJ5QnV0dG9uPXtkaXNhYmxlU2F2ZX0gb25IYW5kbGVkUHJpbWFyeUFjdGlvbj17b25TYXZlfSBvbkhpZGU9e2hpZGV9IHByaW1hcnlCdXR0b25OYW1lPXtpc0VkaXRNb2RlID8gdCgnU2F2ZScpIDogdCgnQWRkJyl9IHNob3c9e3Nob3d9IHdpZHRoPVwiMTAwJVwiIG1heFdpZHRoPVwiMTQ1MHB4XCIgdGl0bGU9ezxoNCBkYXRhLXRlc3Q9XCJhbGVydC1yZXBvcnQtbW9kYWwtdGl0bGVcIj5cbiAgICAgICAgICB7aXNFZGl0TW9kZSA/ICg8SWNvbnMuRWRpdEFsdCBjc3M9e1N0eWxlZEljb259Lz4pIDogKDxJY29ucy5QbHVzTGFyZ2UgY3NzPXtTdHlsZWRJY29ufS8+KX1cbiAgICAgICAgICB7aXNFZGl0TW9kZVxuICAgICAgICAgICAgICAgID8gdChgRWRpdCAke2lzUmVwb3J0ID8gJ1JlcG9ydCcgOiAnQWxlcnQnfWApXG4gICAgICAgICAgICAgICAgOiB0KGBBZGQgJHtpc1JlcG9ydCA/ICdSZXBvcnQnIDogJ0FsZXJ0J31gKX1cbiAgICAgICAgPC9oND59PlxuICAgICAgPFN0eWxlZFNlY3Rpb25Db250YWluZXI+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaGVhZGVyLXNlY3Rpb25cIj5cbiAgICAgICAgICA8U3R5bGVkSW5wdXRDb250YWluZXI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbnRyb2wtbGFiZWxcIj5cbiAgICAgICAgICAgICAge2lzUmVwb3J0ID8gdCgnUmVwb3J0IG5hbWUnKSA6IHQoJ0FsZXJ0IG5hbWUnKX1cbiAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwicmVxdWlyZWRcIj4qPC9zcGFuPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImlucHV0LWNvbnRhaW5lclwiPlxuICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cInRleHRcIiBuYW1lPVwibmFtZVwiIHZhbHVlPXtjdXJyZW50QWxlcnQgPyBjdXJyZW50QWxlcnQubmFtZSA6ICcnfSBwbGFjZWhvbGRlcj17aXNSZXBvcnQgPyB0KCdSZXBvcnQgbmFtZScpIDogdCgnQWxlcnQgbmFtZScpfSBvbkNoYW5nZT17b25UZXh0Q2hhbmdlfS8+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L1N0eWxlZElucHV0Q29udGFpbmVyPlxuICAgICAgICAgIDxTdHlsZWRJbnB1dENvbnRhaW5lcj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29udHJvbC1sYWJlbFwiPlxuICAgICAgICAgICAgICB7dCgnT3duZXJzJyl9XG4gICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInJlcXVpcmVkXCI+Kjwvc3Bhbj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGRpdiBkYXRhLXRlc3Q9XCJvd25lcnMtc2VsZWN0XCIgY2xhc3NOYW1lPVwiaW5wdXQtY29udGFpbmVyXCI+XG4gICAgICAgICAgICAgIDxTZWxlY3QgYXJpYUxhYmVsPXt0KCdPd25lcnMnKX0gYWxsb3dDbGVhciBuYW1lPVwib3duZXJzXCIgbW9kZT1cIm11bHRpcGxlXCIgdmFsdWU9e2N1cnJlbnRBbGVydD8ub3duZXJzIHx8IFtdfSBvcHRpb25zPXtsb2FkT3duZXJPcHRpb25zfSBvbkNoYW5nZT17b25Pd25lcnNDaGFuZ2V9Lz5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvU3R5bGVkSW5wdXRDb250YWluZXI+XG4gICAgICAgICAgPFN0eWxlZElucHV0Q29udGFpbmVyPlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb250cm9sLWxhYmVsXCI+e3QoJ0Rlc2NyaXB0aW9uJyl9PC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImlucHV0LWNvbnRhaW5lclwiPlxuICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cInRleHRcIiBuYW1lPVwiZGVzY3JpcHRpb25cIiB2YWx1ZT17Y3VycmVudEFsZXJ0ID8gY3VycmVudEFsZXJ0LmRlc2NyaXB0aW9uIHx8ICcnIDogJyd9IHBsYWNlaG9sZGVyPXt0KCdEZXNjcmlwdGlvbicpfSBvbkNoYW5nZT17b25UZXh0Q2hhbmdlfS8+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L1N0eWxlZElucHV0Q29udGFpbmVyPlxuICAgICAgICAgIDxTdHlsZWRTd2l0Y2hDb250YWluZXI+XG4gICAgICAgICAgICA8U3dpdGNoIG9uQ2hhbmdlPXtvbkFjdGl2ZVN3aXRjaH0gY2hlY2tlZD17Y3VycmVudEFsZXJ0ID8gY3VycmVudEFsZXJ0LmFjdGl2ZSA6IHRydWV9Lz5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3dpdGNoLWxhYmVsXCI+QWN0aXZlPC9kaXY+XG4gICAgICAgICAgPC9TdHlsZWRTd2l0Y2hDb250YWluZXI+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbHVtbi1zZWN0aW9uXCI+XG4gICAgICAgICAgeyFpc1JlcG9ydCAmJiAoPGRpdiBjbGFzc05hbWU9XCJjb2x1bW4gY29uZGl0aW9uXCI+XG4gICAgICAgICAgICAgIDxTdHlsZWRTZWN0aW9uVGl0bGU+XG4gICAgICAgICAgICAgICAgPGg0Pnt0KCdBbGVydCBjb25kaXRpb24nKX08L2g0PlxuICAgICAgICAgICAgICA8L1N0eWxlZFNlY3Rpb25UaXRsZT5cbiAgICAgICAgICAgICAgPFN0eWxlZElucHV0Q29udGFpbmVyPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29udHJvbC1sYWJlbFwiPlxuICAgICAgICAgICAgICAgICAge3QoJ0RhdGFiYXNlJyl9XG4gICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJyZXF1aXJlZFwiPio8L3NwYW4+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJpbnB1dC1jb250YWluZXJcIj5cbiAgICAgICAgICAgICAgICAgIDxTZWxlY3QgYXJpYUxhYmVsPXt0KCdEYXRhYmFzZScpfSBuYW1lPVwic291cmNlXCIgdmFsdWU9e2N1cnJlbnRBbGVydD8uZGF0YWJhc2U/LmxhYmVsICYmXG4gICAgICAgICAgICAgICAgY3VycmVudEFsZXJ0Py5kYXRhYmFzZT8udmFsdWVcbiAgICAgICAgICAgICAgICA/IHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGN1cnJlbnRBbGVydC5kYXRhYmFzZS52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgbGFiZWw6IGN1cnJlbnRBbGVydC5kYXRhYmFzZS5sYWJlbCxcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgOiB1bmRlZmluZWR9IG9wdGlvbnM9e2xvYWRTb3VyY2VPcHRpb25zfSBvbkNoYW5nZT17b25Tb3VyY2VDaGFuZ2V9Lz5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPC9TdHlsZWRJbnB1dENvbnRhaW5lcj5cbiAgICAgICAgICAgICAgPFN0eWxlZElucHV0Q29udGFpbmVyPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29udHJvbC1sYWJlbFwiPlxuICAgICAgICAgICAgICAgICAge3QoJ1NRTCBRdWVyeScpfVxuICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwicmVxdWlyZWRcIj4qPC9zcGFuPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDxUZXh0QXJlYUNvbnRyb2wgbmFtZT1cInNxbFwiIGxhbmd1YWdlPVwic3FsXCIgb2ZmZXJFZGl0SW5Nb2RhbD17ZmFsc2V9IG1pbkxpbmVzPXsxNX0gbWF4TGluZXM9ezE1fSBvbkNoYW5nZT17b25TUUxDaGFuZ2V9IHJlYWRPbmx5PXtmYWxzZX0gaW5pdGlhbFZhbHVlPXtyZXNvdXJjZT8uc3FsfSBrZXk9e2N1cnJlbnRBbGVydD8uaWR9Lz5cbiAgICAgICAgICAgICAgPC9TdHlsZWRJbnB1dENvbnRhaW5lcj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJpbmxpbmUtY29udGFpbmVyIHdyYXBcIj5cbiAgICAgICAgICAgICAgICA8U3R5bGVkSW5wdXRDb250YWluZXI+XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbnRyb2wtbGFiZWxcIj5cbiAgICAgICAgICAgICAgICAgICAge3QoJ1RyaWdnZXIgQWxlcnQgSWYuLi4nKX1cbiAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwicmVxdWlyZWRcIj4qPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImlucHV0LWNvbnRhaW5lclwiPlxuICAgICAgICAgICAgICAgICAgICA8U2VsZWN0IGFyaWFMYWJlbD17dCgnQ29uZGl0aW9uJyl9IG9uQ2hhbmdlPXtvbkNvbmRpdGlvbkNoYW5nZX0gcGxhY2Vob2xkZXI9XCJDb25kaXRpb25cIiB2YWx1ZT17Y3VycmVudEFsZXJ0Py52YWxpZGF0b3JfY29uZmlnX2pzb24/Lm9wIHx8IHVuZGVmaW5lZH0gb3B0aW9ucz17Q09ORElUSU9OU30vPlxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPC9TdHlsZWRJbnB1dENvbnRhaW5lcj5cbiAgICAgICAgICAgICAgICA8U3R5bGVkSW5wdXRDb250YWluZXI+XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbnRyb2wtbGFiZWxcIj5cbiAgICAgICAgICAgICAgICAgICAge3QoJ1ZhbHVlJyl9XG4gICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInJlcXVpcmVkXCI+Kjwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJpbnB1dC1jb250YWluZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJudW1iZXJcIiBuYW1lPVwidGhyZXNob2xkXCIgZGlzYWJsZWQ9e2NvbmRpdGlvbk5vdE51bGx9IHZhbHVlPXtjdXJyZW50QWxlcnQgJiZcbiAgICAgICAgICAgICAgICBjdXJyZW50QWxlcnQudmFsaWRhdG9yX2NvbmZpZ19qc29uICYmXG4gICAgICAgICAgICAgICAgY3VycmVudEFsZXJ0LnZhbGlkYXRvcl9jb25maWdfanNvbi50aHJlc2hvbGQgIT09XG4gICAgICAgICAgICAgICAgICAgIHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgID8gY3VycmVudEFsZXJ0LnZhbGlkYXRvcl9jb25maWdfanNvbi50aHJlc2hvbGRcbiAgICAgICAgICAgICAgICA6ICcnfSBwbGFjZWhvbGRlcj17dCgnVmFsdWUnKX0gb25DaGFuZ2U9e29uVGhyZXNob2xkQ2hhbmdlfS8+XG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8L1N0eWxlZElucHV0Q29udGFpbmVyPlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2Pil9XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb2x1bW4gc2NoZWR1bGVcIj5cbiAgICAgICAgICAgIDxTdHlsZWRTZWN0aW9uVGl0bGU+XG4gICAgICAgICAgICAgIDxoND5cbiAgICAgICAgICAgICAgICB7aXNSZXBvcnRcbiAgICAgICAgICAgID8gdCgnUmVwb3J0IHNjaGVkdWxlJylcbiAgICAgICAgICAgIDogdCgnQWxlcnQgY29uZGl0aW9uIHNjaGVkdWxlJyl9XG4gICAgICAgICAgICAgIDwvaDQ+XG4gICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInJlcXVpcmVkXCI+Kjwvc3Bhbj5cbiAgICAgICAgICAgIDwvU3R5bGVkU2VjdGlvblRpdGxlPlxuICAgICAgICAgICAgPEFsZXJ0UmVwb3J0Q3JvblNjaGVkdWxlciB2YWx1ZT17Y3VycmVudEFsZXJ0Py5jcm9udGFiIHx8IERFRkFVTFRfQ1JPTl9WQUxVRX0gb25DaGFuZ2U9e25ld1ZhbCA9PiB1cGRhdGVBbGVydFN0YXRlKCdjcm9udGFiJywgbmV3VmFsKX0vPlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb250cm9sLWxhYmVsXCI+e3QoJ1RpbWV6b25lJyl9PC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImlucHV0LWNvbnRhaW5lclwiIGNzcz17KHRoZW1lKSA9PiB0aW1lem9uZUhlYWRlclN0eWxlKHRoZW1lKX0+XG4gICAgICAgICAgICAgIDxUaW1lem9uZVNlbGVjdG9yIG9uVGltZXpvbmVDaGFuZ2U9e29uVGltZXpvbmVDaGFuZ2V9IHRpbWV6b25lPXtjdXJyZW50QWxlcnQ/LnRpbWV6b25lfS8+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDxTdHlsZWRTZWN0aW9uVGl0bGU+XG4gICAgICAgICAgICAgIDxoND57dCgnU2NoZWR1bGUgc2V0dGluZ3MnKX08L2g0PlxuICAgICAgICAgICAgPC9TdHlsZWRTZWN0aW9uVGl0bGU+XG4gICAgICAgICAgICA8U3R5bGVkSW5wdXRDb250YWluZXI+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29udHJvbC1sYWJlbFwiPlxuICAgICAgICAgICAgICAgIHt0KCdMb2cgcmV0ZW50aW9uJyl9XG4gICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwicmVxdWlyZWRcIj4qPC9zcGFuPlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJpbnB1dC1jb250YWluZXJcIj5cbiAgICAgICAgICAgICAgICA8U2VsZWN0IGFyaWFMYWJlbD17dCgnTG9nIHJldGVudGlvbicpfSBwbGFjZWhvbGRlcj17dCgnTG9nIHJldGVudGlvbicpfSBvbkNoYW5nZT17b25Mb2dSZXRlbnRpb25DaGFuZ2V9IHZhbHVlPXtjdXJyZW50QWxlcnQ/LmxvZ19yZXRlbnRpb24gfHwgREVGQVVMVF9SRVRFTlRJT059IG9wdGlvbnM9e1JFVEVOVElPTl9PUFRJT05TfS8+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9TdHlsZWRJbnB1dENvbnRhaW5lcj5cbiAgICAgICAgICAgIDxTdHlsZWRJbnB1dENvbnRhaW5lcj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb250cm9sLWxhYmVsXCI+XG4gICAgICAgICAgICAgICAge3QoJ1dvcmtpbmcgdGltZW91dCcpfVxuICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInJlcXVpcmVkXCI+Kjwvc3Bhbj5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaW5wdXQtY29udGFpbmVyXCI+XG4gICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJudW1iZXJcIiBtaW49XCIxXCIgbmFtZT1cIndvcmtpbmdfdGltZW91dFwiIHZhbHVlPXtjdXJyZW50QWxlcnQ/LndvcmtpbmdfdGltZW91dCB8fCAnJ30gcGxhY2Vob2xkZXI9e3QoJ1RpbWUgaW4gc2Vjb25kcycpfSBvbkNoYW5nZT17b25UaW1lb3V0VmVyaWZ5Q2hhbmdlfS8+XG4gICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwiaW5wdXQtbGFiZWxcIj5zZWNvbmRzPC9zcGFuPlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvU3R5bGVkSW5wdXRDb250YWluZXI+XG4gICAgICAgICAgICB7IWlzUmVwb3J0ICYmICg8U3R5bGVkSW5wdXRDb250YWluZXI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb250cm9sLWxhYmVsXCI+e3QoJ0dyYWNlIHBlcmlvZCcpfTwvZGl2PlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaW5wdXQtY29udGFpbmVyXCI+XG4gICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cIm51bWJlclwiIG1pbj1cIjFcIiBuYW1lPVwiZ3JhY2VfcGVyaW9kXCIgdmFsdWU9e2N1cnJlbnRBbGVydD8uZ3JhY2VfcGVyaW9kIHx8ICcnfSBwbGFjZWhvbGRlcj17dCgnVGltZSBpbiBzZWNvbmRzJyl9IG9uQ2hhbmdlPXtvblRpbWVvdXRWZXJpZnlDaGFuZ2V9Lz5cbiAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cImlucHV0LWxhYmVsXCI+c2Vjb25kczwvc3Bhbj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPC9TdHlsZWRJbnB1dENvbnRhaW5lcj4pfVxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29sdW1uIG1lc3NhZ2VcIj5cbiAgICAgICAgICAgIDxTdHlsZWRTZWN0aW9uVGl0bGU+XG4gICAgICAgICAgICAgIDxoND57dCgnTWVzc2FnZSBjb250ZW50Jyl9PC9oND5cbiAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwicmVxdWlyZWRcIj4qPC9zcGFuPlxuICAgICAgICAgICAgPC9TdHlsZWRTZWN0aW9uVGl0bGU+XG4gICAgICAgICAgICA8UmFkaW8uR3JvdXAgb25DaGFuZ2U9e29uQ29udGVudFR5cGVDaGFuZ2V9IHZhbHVlPXtjb250ZW50VHlwZX0+XG4gICAgICAgICAgICAgIDxTdHlsZWRSYWRpbyB2YWx1ZT1cImRhc2hib2FyZFwiPnt0KCdEYXNoYm9hcmQnKX08L1N0eWxlZFJhZGlvPlxuICAgICAgICAgICAgICA8U3R5bGVkUmFkaW8gdmFsdWU9XCJjaGFydFwiPnt0KCdDaGFydCcpfTwvU3R5bGVkUmFkaW8+XG4gICAgICAgICAgICA8L1JhZGlvLkdyb3VwPlxuICAgICAgICAgICAgPFNlbGVjdCBhcmlhTGFiZWw9e3QoJ0NoYXJ0Jyl9IGNzcz17e1xuICAgICAgICAgICAgZGlzcGxheTogY29udGVudFR5cGUgPT09ICdjaGFydCcgPyAnaW5saW5lJyA6ICdub25lJyxcbiAgICAgICAgfX0gbmFtZT1cImNoYXJ0XCIgdmFsdWU9e2N1cnJlbnRBbGVydD8uY2hhcnQ/LmxhYmVsICYmIGN1cnJlbnRBbGVydD8uY2hhcnQ/LnZhbHVlXG4gICAgICAgICAgICA/IHtcbiAgICAgICAgICAgICAgICB2YWx1ZTogY3VycmVudEFsZXJ0LmNoYXJ0LnZhbHVlLFxuICAgICAgICAgICAgICAgIGxhYmVsOiBjdXJyZW50QWxlcnQuY2hhcnQubGFiZWwsXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICA6IHVuZGVmaW5lZH0gb3B0aW9ucz17bG9hZENoYXJ0T3B0aW9uc30gb25DaGFuZ2U9e29uQ2hhcnRDaGFuZ2V9Lz5cbiAgICAgICAgICAgIDxTZWxlY3QgYXJpYUxhYmVsPXt0KCdEYXNoYm9hcmQnKX0gY3NzPXt7XG4gICAgICAgICAgICBkaXNwbGF5OiBjb250ZW50VHlwZSA9PT0gJ2Rhc2hib2FyZCcgPyAnaW5saW5lJyA6ICdub25lJyxcbiAgICAgICAgfX0gbmFtZT1cImRhc2hib2FyZFwiIHZhbHVlPXtjdXJyZW50QWxlcnQ/LmRhc2hib2FyZD8ubGFiZWwgJiYgY3VycmVudEFsZXJ0Py5kYXNoYm9hcmQ/LnZhbHVlXG4gICAgICAgICAgICA/IHtcbiAgICAgICAgICAgICAgICB2YWx1ZTogY3VycmVudEFsZXJ0LmRhc2hib2FyZC52YWx1ZSxcbiAgICAgICAgICAgICAgICBsYWJlbDogY3VycmVudEFsZXJ0LmRhc2hib2FyZC5sYWJlbCxcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIDogdW5kZWZpbmVkfSBvcHRpb25zPXtsb2FkRGFzaGJvYXJkT3B0aW9uc30gb25DaGFuZ2U9e29uRGFzaGJvYXJkQ2hhbmdlfS8+XG4gICAgICAgICAgICB7Zm9ybWF0T3B0aW9uRW5hYmxlZCAmJiAoPGRpdiBjbGFzc05hbWU9XCJpbmxpbmUtY29udGFpbmVyXCI+XG4gICAgICAgICAgICAgICAgPFN0eWxlZFJhZGlvR3JvdXAgb25DaGFuZ2U9e29uRm9ybWF0Q2hhbmdlfSB2YWx1ZT17cmVwb3J0Rm9ybWF0fT5cbiAgICAgICAgICAgICAgICAgIDxTdHlsZWRSYWRpbyB2YWx1ZT1cIlBOR1wiPnt0KCdTZW5kIGFzIFBORycpfTwvU3R5bGVkUmFkaW8+XG4gICAgICAgICAgICAgICAgICA8U3R5bGVkUmFkaW8gdmFsdWU9XCJDU1ZcIj57dCgnU2VuZCBhcyBDU1YnKX08L1N0eWxlZFJhZGlvPlxuICAgICAgICAgICAgICAgICAge1RFWFRfQkFTRURfVklTVUFMSVpBVElPTl9UWVBFUy5pbmNsdWRlcyhjaGFydFZpelR5cGUpICYmICg8U3R5bGVkUmFkaW8gdmFsdWU9XCJURVhUXCI+e3QoJ1NlbmQgYXMgdGV4dCcpfTwvU3R5bGVkUmFkaW8+KX1cbiAgICAgICAgICAgICAgICA8L1N0eWxlZFJhZGlvR3JvdXA+XG4gICAgICAgICAgICAgIDwvZGl2Pil9XG4gICAgICAgICAgICA8U3R5bGVkU2VjdGlvblRpdGxlPlxuICAgICAgICAgICAgICA8aDQ+e3QoJ05vdGlmaWNhdGlvbiBtZXRob2QnKX08L2g0PlxuICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJyZXF1aXJlZFwiPio8L3NwYW4+XG4gICAgICAgICAgICA8L1N0eWxlZFNlY3Rpb25UaXRsZT5cbiAgICAgICAgICAgIHtub3RpZmljYXRpb25TZXR0aW5ncy5tYXAoKG5vdGlmaWNhdGlvblNldHRpbmcsIGkpID0+ICg8Tm90aWZpY2F0aW9uTWV0aG9kIHNldHRpbmc9e25vdGlmaWNhdGlvblNldHRpbmd9IGluZGV4PXtpfSBrZXk9e2BOb3RpZmljYXRpb25NZXRob2QtJHtpfWB9IG9uVXBkYXRlPXt1cGRhdGVOb3RpZmljYXRpb25TZXR0aW5nfSBvblJlbW92ZT17cmVtb3ZlTm90aWZpY2F0aW9uU2V0dGluZ30vPikpfVxuICAgICAgICAgICAgPE5vdGlmaWNhdGlvbk1ldGhvZEFkZCBkYXRhLXRlc3Q9XCJub3RpZmljYXRpb24tYWRkXCIgc3RhdHVzPXtub3RpZmljYXRpb25BZGRTdGF0ZX0gb25DbGljaz17b25Ob3RpZmljYXRpb25BZGR9Lz5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L1N0eWxlZFNlY3Rpb25Db250YWluZXI+XG4gICAgPC9TdHlsZWRNb2RhbD4pO1xufTtcbmV4cG9ydCBkZWZhdWx0IHdpdGhUb2FzdHMoQWxlcnRSZXBvcnRNb2RhbCk7XG4iXX0= */\"),\n    name: \"dashboard\", value: currentAlert != null && (_currentAlert$dashboa2 = currentAlert.dashboard) != null && _currentAlert$dashboa2.label && currentAlert != null && (_currentAlert$dashboa3 = currentAlert.dashboard) != null && _currentAlert$dashboa3.value ?\n    {\n      value: currentAlert.dashboard.value,\n      label: currentAlert.dashboard.label } :\n\n    undefined, options: loadDashboardOptions, onChange: onDashboardChange }),\n  formatOptionEnabled && ___EmotionJSX(\"div\", { className: \"inline-container\" },\n  ___EmotionJSX(StyledRadioGroup, { onChange: onFormatChange, value: reportFormat },\n  ___EmotionJSX(StyledRadio, { value: \"PNG\" }, t('Send as PNG')),\n  ___EmotionJSX(StyledRadio, { value: \"CSV\" }, t('Send as CSV')),\n  TEXT_BASED_VISUALIZATION_TYPES.includes(chartVizType) && ___EmotionJSX(StyledRadio, { value: \"TEXT\" }, t('Send as text')))),\n\n\n  ___EmotionJSX(StyledSectionTitle, null,\n  ___EmotionJSX(\"h4\", null, t('Notification method')),\n  ___EmotionJSX(\"span\", { className: \"required\" }, \"*\")),\n\n  notificationSettings.map((notificationSetting, i) => ___EmotionJSX(NotificationMethod, { setting: notificationSetting, index: i, key: `NotificationMethod-${i}`, onUpdate: updateNotificationSetting, onRemove: removeNotificationSetting })),\n  ___EmotionJSX(NotificationMethodAdd, { status: notificationAddState, onClick: onNotificationAdd })))));\n\n\n\n\n};\nexport default withToasts(AlertReportModal);","map":null,"metadata":{},"sourceType":"module"}